import{r as d,c as Ue,G as de,o as vl,b as f,C as _l,d as V,e as u,i as l,F as h,h as n,x as Ne,w as a,j as s,k as x,H as Oe,I as yl,J as gl,K as je,A as Ee,f as T,g as z,m as ee,B as bl,t as _,L as Vl,n as Se,M as Ge,N as kl,O as wl,P as xl,Q as Cl,E as r,p as Re}from"./index-CbWVtMyN.js";import{_ as Ul,a as $}from"./_plugin-vue_export-helper-D3ac76j0.js";const Sl={class:"standards-view"},$l={class:"page-header"},Tl={class:"header-actions"},zl={class:"filter-row"},Fl={class:"collections-list"},Ll=["onClick"],hl={class:"collection-icon"},Il={class:"collection-info"},Dl={class:"collection-name"},ql={class:"collection-desc"},Bl={class:"collection-meta"},Al={class:"collection-actions"},Ml={class:"detail-header"},Nl={class:"info-row"},Ol={class:"info-item"},jl={class:"info-value"},El={class:"info-item"},Gl={class:"info-value"},Rl={class:"info-item"},Kl={class:"info-value"},Hl={class:"filter-row"},Jl={key:0},Pl={class:"table-footer"},Ql={key:0},Wl={key:1},Xl={key:0,class:"create-step-content"},Yl={class:"form-section"},Zl={class:"focus-area-selector"},et={class:"form-section"},lt={class:"industry-selector"},tt={key:1,class:"create-step-content"},at={class:"collection-name-edit"},ot={class:"expand-edit-form"},nt={class:"expand-actions"},st={class:"step2-tip"},it={key:2,class:"create-step-content"},dt={class:"usage-instruction-list"},ut={class:"usage-item-header"},rt={class:"usage-item-title"},mt={class:"create-dialog-footer"},pt={__name:"StandardsView",setup(ct){const ue=d(!1),$e=d([]),le=d(""),te=d(""),y=d(null),Te=Ue(()=>{let o=$e.value;if(le.value){const e=le.value.toLowerCase();o=o.filter(p=>p.name.toLowerCase().includes(e)||p.description&&p.description.toLowerCase().includes(e))}return te.value&&(o=o.filter(e=>e.material_type===te.value||e.material_type==="both")),o});async function G(){ue.value=!0;try{const o=await $.getCollections();$e.value=o.data}catch(o){r.error("加载标准集失败: "+o.message)}finally{ue.value=!1}}async function ze(o){y.value=o,await A(),await ce()}function Ke(){y.value=null,B.value=[],H.value="",J.value="",K.value=""}const R=d(!1),re=d(!1),me=d(null),k=de({name:"",description:"",material_type:"both"});function Fe(o){me.value=o,k.name=o.name,k.description=o.description,k.material_type=o.material_type,R.value=!0}async function He(){if(!k.name.trim()){r.warning("集合名称不能为空");return}re.value=!0;try{await $.updateCollection(me.value.id,{name:k.name,description:k.description,material_type:k.material_type}),r.success("更新成功"),R.value=!1,y.value&&y.value.id===me.value.id&&(y.value.name=k.name,y.value.description=k.description,y.value.material_type=k.material_type),G()}catch(o){r.error("更新失败: "+o.message)}finally{re.value=!1}}async function Je(o){if(o.is_preset){r.warning("系统预设集合不可删除");return}try{await Re.confirm(`确定要删除标准集「${o.name}」吗？该集合内的所有风险点将一并删除。`,"确认删除",{type:"warning"}),await $.deleteCollection(o.id),r.success("删除成功"),G()}catch(e){e!=="cancel"&&r.error("删除失败: "+e.message)}}const pe=d(!1),B=d([]),Le=d([]),K=d(""),H=d(""),J=d(""),ae=d([]);async function A(){if(y.value){pe.value=!0;try{const o={};H.value&&(o.category=H.value),J.value&&(o.risk_level=J.value),K.value&&(o.keyword=K.value);const e=await $.getCollectionStandards(y.value.id,o);B.value=e.data}catch(o){r.error("加载风险点失败: "+o.message)}finally{pe.value=!1}}}async function ce(){if(y.value)try{const o=await $.getCollectionCategories(y.value.id);Le.value=o.data}catch(o){console.error("加载分类失败:",o)}}let he=null;function Pe(){clearTimeout(he),he=setTimeout(()=>{A()},300)}const M=d(!1),N=d(!1),O=d(null),g=de({category:"",item:"",description:"",risk_level:"medium",applicable_to:["contract","marketing"],usage_instruction:""});function Qe(o){O.value=o,Object.assign(g,{category:o.category,item:o.item,description:o.description,risk_level:o.risk_level,applicable_to:o.applicable_to||["contract","marketing"],usage_instruction:o.usage_instruction||""}),M.value=!0}async function We(){if(!g.category||!g.item||!g.description){r.warning("请填写必填字段");return}N.value=!0;try{O.value?(await $.updateLibraryStandard(O.value.id,g),r.success("更新成功")):(await $.addStandardToCollection(y.value.id,g),r.success("添加成功")),M.value=!1,Ie(),A(),ce(),y.value.standard_count=B.value.length+(O.value?0:1)}catch(o){r.error("保存失败: "+o.message)}finally{N.value=!1}}async function Xe(o){try{await Re.confirm(`确定要删除风险点「${o.item}」吗？`,"确认删除",{type:"warning"}),await $.deleteLibraryStandard(o.id),r.success("删除成功"),A(),ce(),y.value.standard_count--}catch(e){e!=="cancel"&&r.error("删除失败: "+e.message)}}function Ie(){O.value=null,Object.assign(g,{category:"",item:"",description:"",risk_level:"medium",applicable_to:["contract","marketing"],usage_instruction:""})}async function Ye(o){ae.value.push(o.id);try{const e=await $.generateUsageInstruction({standard_ids:[o.id]});e.data.success_count>0?(o.usage_instruction=e.data.results[0].usage_instruction,r.success("生成成功")):r.error("生成失败: "+e.data.errors[0])}catch(e){r.error("生成失败: "+e.message)}finally{ae.value=ae.value.filter(e=>e!==o.id)}}const P=d(!1),j=d(1),Q=d(null),E=d([]),fe=d(!1),C=de({name:"",description:"",material_type:"both"});function Ze(o){Q.value=o.raw}async function el(){if(Q.value){if(!C.name.trim()){r.warning("请先输入集合名称");return}fe.value=!0;try{const o=await $.previewStandards(Q.value);E.value=o.data.standards,j.value=2,r.success(`解析成功，共 ${o.data.total_count} 条标准`)}catch(o){r.error("解析失败: "+o.message)}finally{fe.value=!1}}}async function ll(){if(E.value.length){N.value=!0;try{const o=await $.saveToLibrary({collection_name:C.name,collection_description:C.description,material_type:C.material_type,standards:E.value});r.success(o.data.message),P.value=!1,De(),G()}catch(o){r.error("保存失败: "+o.message)}finally{N.value=!1}}}function De(){j.value=1,Q.value=null,E.value=[],Object.assign(C,{name:"",description:"",material_type:"both"})}const W=d(!1),S=d(1),ve=d(!1),_e=d(!1),L=d([]),I=d(""),oe=d(""),i=de({document_type:"contract",business_scenario:"",focus_areas:[],our_role:"",industry:"",special_risks:"",reference_material:"",custom_focus:"",custom_industry:""}),tl=["合同主体资格","权利义务条款","费用与支付","违约责任","知识产权","保密条款","争议解决","合规性要求"],al=["信息技术/互联网","金融/保险","制造业","房地产/建筑","医疗/生物","零售/消费"],ol=Ue(()=>["制作审核标准","预览编辑标准","确认入库"][S.value-1]),qe=Ue(()=>i.business_scenario.trim()&&(i.focus_areas.length>0||i.custom_focus.trim()));async function nl(){var o,e;if(!qe.value){r.warning("请填写业务场景和至少一个关注点");return}ve.value=!0;try{const p=[...i.focus_areas];if(i.custom_focus.trim()){const ge=i.custom_focus.split(/[,，、]/).map(be=>be.trim()).filter(Boolean);p.push(...ge)}const m=i.custom_industry.trim()||i.industry,q=await $.createStandardsFromBusiness({document_type:i.document_type,business_scenario:i.business_scenario,focus_areas:p,our_role:i.our_role||null,industry:m||null,special_risks:i.special_risks||null,reference_material:i.reference_material||null});L.value=q.data.standards,I.value=q.data.collection_name||"",oe.value=q.data.generation_summary||`成功生成 ${q.data.standards.length} 条标准`,S.value=2,r.success("标准生成成功")}catch(p){r.error("生成标准失败: "+(((e=(o=p.response)==null?void 0:o.data)==null?void 0:e.detail)||p.message))}finally{ve.value=!1}}function sl(o){L.value.splice(o,1)}async function il(){if(!L.value.length){r.warning("没有可保存的标准");return}if(!I.value.trim()){r.warning("请输入标准集名称");return}_e.value=!0;try{const o=await $.saveToLibrary({collection_name:I.value,collection_description:i.business_scenario,material_type:i.document_type==="both"?"both":i.document_type,standards:L.value});r.success(o.data.message||"标准保存成功"),W.value=!1,Be(),G()}catch(o){r.error("保存失败: "+o.message)}finally{_e.value=!1}}function Be(){S.value=1,Object.assign(i,{document_type:"contract",business_scenario:"",focus_areas:[],our_role:"",industry:"",special_risks:"",reference_material:"",custom_focus:"",custom_industry:""}),L.value=[],I.value="",oe.value=""}function ye(o){return{high:"danger",medium:"warning",low:"success"}[o]||"info"}function ne(o){return{high:"高",medium:"中",low:"低"}[o]||o}function dl(o){return o?o.map(e=>e==="contract"?"合同":"营销").join("、"):""}function Ae(o){return{contract:"合同",marketing:"营销材料",both:"合同/营销"}[o]||o}function ul(o){o==="upload"?P.value=!0:o==="ai"&&(W.value=!0)}return vl(()=>{G()}),(o,e)=>{const p=f("el-icon"),m=f("el-button"),q=f("el-dropdown-item"),ge=f("el-dropdown-menu"),be=f("el-dropdown"),v=f("el-input"),b=f("el-option"),D=f("el-select"),se=f("el-card"),rl=f("el-empty"),X=f("el-tag"),w=f("el-table-column"),Ve=f("el-table"),c=f("el-form-item"),Y=f("el-checkbox"),ke=f("el-checkbox-group"),Z=f("el-form"),ie=f("el-dialog"),ml=f("el-divider"),pl=f("el-upload"),we=f("el-alert"),xe=f("el-step"),cl=f("el-steps"),Ce=f("el-radio"),fl=f("el-radio-group"),Me=_l("loading");return u(),V("div",Sl,[y.value?(u(),V(h,{key:1},[n("div",Ml,[l(m,{text:"",onClick:Ke},{default:a(()=>[l(p,null,{default:a(()=>[l(x(wl))]),_:1}),e[50]||(e[50]=s(" 返回列表 ",-1))]),_:1}),n("h2",null,_(y.value.name),1),y.value.is_preset?(u(),T(X,{key:0,size:"small",type:"info"},{default:a(()=>[...e[51]||(e[51]=[s("系统预设",-1)])]),_:1})):z("",!0)]),l(se,{class:"collection-info-card"},{default:a(()=>[n("div",Nl,[n("div",Ol,[e[52]||(e[52]=n("span",{class:"info-label"},"适用场景：",-1)),n("span",jl,_(y.value.description||"暂无描述"),1)]),n("div",El,[e[53]||(e[53]=n("span",{class:"info-label"},"材料类型：",-1)),n("span",Gl,_(Ae(y.value.material_type)),1)]),n("div",Rl,[e[54]||(e[54]=n("span",{class:"info-label"},"风险点数量：",-1)),n("span",Kl,_(B.value.length)+" 条",1)])]),l(m,{type:"primary",text:"",size:"small",onClick:e[2]||(e[2]=t=>Fe(y.value))},{default:a(()=>[l(p,null,{default:a(()=>[l(x(Ge))]),_:1}),e[55]||(e[55]=s(" 编辑集合信息 ",-1))]),_:1})]),_:1}),l(se,{class:"filter-card"},{default:a(()=>[n("div",Hl,[l(v,{modelValue:K.value,"onUpdate:modelValue":e[3]||(e[3]=t=>K.value=t),placeholder:"搜索风险点...",clearable:"",style:{width:"300px"},onInput:Pe},{prefix:a(()=>[l(p,null,{default:a(()=>[l(x(Ee))]),_:1})]),_:1},8,["modelValue"]),l(D,{modelValue:H.value,"onUpdate:modelValue":e[4]||(e[4]=t=>H.value=t),placeholder:"选择分类",clearable:"",style:{width:"200px"},onChange:A},{default:a(()=>[(u(!0),V(h,null,ee(Le.value,t=>(u(),T(b,{key:t,label:t,value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),l(D,{modelValue:J.value,"onUpdate:modelValue":e[5]||(e[5]=t=>J.value=t),placeholder:"风险等级",clearable:"",style:{width:"150px"},onChange:A},{default:a(()=>[l(b,{label:"高",value:"high"}),l(b,{label:"中",value:"medium"}),l(b,{label:"低",value:"low"})]),_:1},8,["modelValue"]),l(m,{type:"primary",onClick:e[6]||(e[6]=t=>M.value=!0)},{default:a(()=>[l(p,null,{default:a(()=>[l(x(Oe))]),_:1}),e[56]||(e[56]=s(" 添加风险点 ",-1))]),_:1})])]),_:1}),l(se,{class:"table-card"},{default:a(()=>[Ne((u(),T(Ve,{data:B.value,stripe:"",style:{width:"100%"}},{default:a(()=>[l(w,{prop:"category",label:"分类",width:"120"}),l(w,{prop:"item",label:"审核要点","min-width":"180"}),l(w,{prop:"description",label:"说明","min-width":"250","show-overflow-tooltip":""}),l(w,{label:"风险等级",width:"100",align:"center"},{default:a(({row:t})=>[l(X,{type:ye(t.risk_level),size:"small"},{default:a(()=>[s(_(ne(t.risk_level)),1)]),_:2},1032,["type"])]),_:1}),l(w,{label:"适用类型",width:"120"},{default:a(({row:t})=>[n("span",null,_(dl(t.applicable_to)),1)]),_:1}),l(w,{prop:"usage_instruction",label:"适用说明","min-width":"200","show-overflow-tooltip":""},{default:a(({row:t})=>[t.usage_instruction?(u(),V("span",Jl,_(t.usage_instruction),1)):(u(),T(m,{key:1,type:"primary",text:"",size:"small",onClick:F=>Ye(t),loading:ae.value.includes(t.id)},{default:a(()=>[...e[57]||(e[57]=[s(" 生成 ",-1)])]),_:1},8,["onClick","loading"]))]),_:1}),l(w,{label:"操作",width:"150",fixed:"right"},{default:a(({row:t})=>[l(m,{type:"primary",text:"",size:"small",onClick:F=>Qe(t)},{default:a(()=>[...e[58]||(e[58]=[s(" 编辑 ",-1)])]),_:1},8,["onClick"]),l(m,{type:"danger",text:"",size:"small",onClick:F=>Xe(t)},{default:a(()=>[...e[59]||(e[59]=[s(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[Me,pe.value]]),n("div",Pl,[n("span",null,"共 "+_(B.value.length)+" 条风险点",1)])]),_:1})],64)):(u(),V(h,{key:0},[n("div",$l,[e[44]||(e[44]=n("div",{class:"header-left"},[n("h1",null,"审核标准管理"),n("p",{class:"subtitle"},"管理审核标准集，每套标准包含若干风险点")],-1)),n("div",Tl,[l(be,{trigger:"click",onCommand:ul},{dropdown:a(()=>[l(ge,null,{default:a(()=>[l(q,{command:"upload"},{default:a(()=>[l(p,null,{default:a(()=>[l(x(gl))]),_:1}),e[42]||(e[42]=s(" 上传新标准（批量） ",-1))]),_:1}),l(q,{command:"ai"},{default:a(()=>[l(p,null,{default:a(()=>[l(x(je))]),_:1}),e[43]||(e[43]=s(" AI辅助制作（批量） ",-1))]),_:1})]),_:1})]),default:a(()=>[l(m,{type:"primary"},{default:a(()=>[l(p,null,{default:a(()=>[l(x(Oe))]),_:1}),e[41]||(e[41]=s(" 新建标准集 ",-1)),l(p,{class:"el-icon--right"},{default:a(()=>[l(x(yl))]),_:1})]),_:1})]),_:1})])]),l(se,{class:"filter-card"},{default:a(()=>[n("div",zl,[l(v,{modelValue:le.value,"onUpdate:modelValue":e[0]||(e[0]=t=>le.value=t),placeholder:"搜索标准集...",clearable:"",style:{width:"300px"}},{prefix:a(()=>[l(p,null,{default:a(()=>[l(x(Ee))]),_:1})]),_:1},8,["modelValue"]),l(D,{modelValue:te.value,"onUpdate:modelValue":e[1]||(e[1]=t=>te.value=t),placeholder:"材料类型",clearable:"",style:{width:"150px"}},{default:a(()=>[l(b,{label:"合同",value:"contract"}),l(b,{label:"营销材料",value:"marketing"})]),_:1},8,["modelValue"])])]),_:1}),Ne((u(),V("div",Fl,[Te.value.length===0?(u(),T(rl,{key:0,description:"暂无标准集"})):z("",!0),(u(!0),V(h,null,ee(Te.value,t=>(u(),V("div",{key:t.id,class:"collection-card"},[n("div",{class:"collection-card-main",onClick:F=>ze(t)},[n("div",hl,[l(p,{size:24},{default:a(()=>[l(x(bl))]),_:1})]),n("div",Il,[n("div",Dl,[s(_(t.name)+" ",1),t.is_preset?(u(),T(X,{key:0,size:"small",type:"info"},{default:a(()=>[...e[45]||(e[45]=[s("系统预设",-1)])]),_:1})):z("",!0)]),n("div",ql,_(t.description||"暂无描述"),1),n("div",Bl,[n("span",null,_(t.standard_count)+" 条风险点",1),e[46]||(e[46]=n("span",{class:"meta-sep"},"|",-1)),n("span",null,_(Ae(t.material_type)),1)])])],8,Ll),n("div",Al,[l(m,{text:"",type:"primary",onClick:Se(F=>ze(t),["stop"])},{default:a(()=>[l(p,null,{default:a(()=>[l(x(Vl))]),_:1}),e[47]||(e[47]=s(" 查看 ",-1))]),_:1},8,["onClick"]),l(m,{text:"",type:"primary",onClick:Se(F=>Fe(t),["stop"])},{default:a(()=>[l(p,null,{default:a(()=>[l(x(Ge))]),_:1}),e[48]||(e[48]=s(" 编辑 ",-1))]),_:1},8,["onClick"]),l(m,{text:"",type:"danger",onClick:Se(F=>Je(t),["stop"]),disabled:t.is_preset},{default:a(()=>[l(p,null,{default:a(()=>[l(x(kl))]),_:1}),e[49]||(e[49]=s(" 删除 ",-1))]),_:1},8,["onClick","disabled"])])]))),128))])),[[Me,ue.value]])],64)),l(ie,{modelValue:M.value,"onUpdate:modelValue":e[14]||(e[14]=t=>M.value=t),title:O.value?"编辑风险点":"添加风险点",width:"600px",onClose:Ie},{footer:a(()=>[l(m,{onClick:e[13]||(e[13]=t=>M.value=!1)},{default:a(()=>[...e[62]||(e[62]=[s("取消",-1)])]),_:1}),l(m,{type:"primary",onClick:We,loading:N.value},{default:a(()=>[...e[63]||(e[63]=[s(" 保存 ",-1)])]),_:1},8,["loading"])]),default:a(()=>[l(Z,{model:g,"label-width":"100px"},{default:a(()=>[l(c,{label:"分类",required:""},{default:a(()=>[l(v,{modelValue:g.category,"onUpdate:modelValue":e[7]||(e[7]=t=>g.category=t),placeholder:"如：主体资格、权利义务"},null,8,["modelValue"])]),_:1}),l(c,{label:"审核要点",required:""},{default:a(()=>[l(v,{modelValue:g.item,"onUpdate:modelValue":e[8]||(e[8]=t=>g.item=t),placeholder:"简要描述审核要点"},null,8,["modelValue"])]),_:1}),l(c,{label:"详细说明",required:""},{default:a(()=>[l(v,{modelValue:g.description,"onUpdate:modelValue":e[9]||(e[9]=t=>g.description=t),type:"textarea",rows:3,placeholder:"详细的审核说明"},null,8,["modelValue"])]),_:1}),l(c,{label:"风险等级"},{default:a(()=>[l(D,{modelValue:g.risk_level,"onUpdate:modelValue":e[10]||(e[10]=t=>g.risk_level=t),style:{width:"100%"}},{default:a(()=>[l(b,{label:"高",value:"high"}),l(b,{label:"中",value:"medium"}),l(b,{label:"低",value:"low"})]),_:1},8,["modelValue"])]),_:1}),l(c,{label:"适用类型"},{default:a(()=>[l(ke,{modelValue:g.applicable_to,"onUpdate:modelValue":e[11]||(e[11]=t=>g.applicable_to=t)},{default:a(()=>[l(Y,{label:"contract"},{default:a(()=>[...e[60]||(e[60]=[s("合同",-1)])]),_:1}),l(Y,{label:"marketing"},{default:a(()=>[...e[61]||(e[61]=[s("营销材料",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(c,{label:"适用说明"},{default:a(()=>[l(v,{modelValue:g.usage_instruction,"onUpdate:modelValue":e[12]||(e[12]=t=>g.usage_instruction=t),type:"textarea",rows:2,placeholder:"可选，说明何时使用该标准"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),l(ie,{modelValue:R.value,"onUpdate:modelValue":e[19]||(e[19]=t=>R.value=t),title:"编辑集合信息",width:"500px"},{footer:a(()=>[l(m,{onClick:e[18]||(e[18]=t=>R.value=!1)},{default:a(()=>[...e[64]||(e[64]=[s("取消",-1)])]),_:1}),l(m,{type:"primary",onClick:He,loading:re.value},{default:a(()=>[...e[65]||(e[65]=[s(" 保存 ",-1)])]),_:1},8,["loading"])]),default:a(()=>[l(Z,{model:k,"label-width":"100px"},{default:a(()=>[l(c,{label:"集合名称",required:""},{default:a(()=>[l(v,{modelValue:k.name,"onUpdate:modelValue":e[15]||(e[15]=t=>k.name=t),placeholder:"如：电商平台合作协议审核标准"},null,8,["modelValue"])]),_:1}),l(c,{label:"适用场景"},{default:a(()=>[l(v,{modelValue:k.description,"onUpdate:modelValue":e[16]||(e[16]=t=>k.description=t),type:"textarea",rows:3,placeholder:"描述该标准集的适用场景"},null,8,["modelValue"])]),_:1}),l(c,{label:"材料类型"},{default:a(()=>[l(D,{modelValue:k.material_type,"onUpdate:modelValue":e[17]||(e[17]=t=>k.material_type=t),style:{width:"100%"}},{default:a(()=>[l(b,{label:"合同",value:"contract"}),l(b,{label:"营销材料",value:"marketing"}),l(b,{label:"两者都适用",value:"both"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(ie,{modelValue:P.value,"onUpdate:modelValue":e[25]||(e[25]=t=>P.value=t),title:"上传审核标准",width:"700px",onClose:De},{footer:a(()=>[l(m,{onClick:e[23]||(e[23]=t=>P.value=!1)},{default:a(()=>[...e[68]||(e[68]=[s("取消",-1)])]),_:1}),j.value===1?(u(),T(m,{key:0,type:"primary",onClick:el,loading:fe.value,disabled:!Q.value||!C.name},{default:a(()=>[...e[69]||(e[69]=[s(" 预览 ",-1)])]),_:1},8,["loading","disabled"])):(u(),T(m,{key:1,onClick:e[24]||(e[24]=t=>j.value=1)},{default:a(()=>[...e[70]||(e[70]=[s(" 上一步 ",-1)])]),_:1})),j.value===2?(u(),T(m,{key:2,type:"primary",onClick:ll,loading:N.value},{default:a(()=>[...e[71]||(e[71]=[s(" 确认入库 ",-1)])]),_:1},8,["loading"])):z("",!0)]),default:a(()=>[j.value===1?(u(),V("div",Ql,[l(Z,{model:C,"label-width":"100px"},{default:a(()=>[l(c,{label:"集合名称",required:""},{default:a(()=>[l(v,{modelValue:C.name,"onUpdate:modelValue":e[20]||(e[20]=t=>C.name=t),placeholder:"如：电商平台合作协议审核标准"},null,8,["modelValue"])]),_:1}),l(c,{label:"适用场景"},{default:a(()=>[l(v,{modelValue:C.description,"onUpdate:modelValue":e[21]||(e[21]=t=>C.description=t),type:"textarea",rows:2,placeholder:"描述该标准集的适用场景"},null,8,["modelValue"])]),_:1}),l(c,{label:"材料类型"},{default:a(()=>[l(D,{modelValue:C.material_type,"onUpdate:modelValue":e[22]||(e[22]=t=>C.material_type=t),style:{width:"100%"}},{default:a(()=>[l(b,{label:"合同",value:"contract"}),l(b,{label:"营销材料",value:"marketing"}),l(b,{label:"两者都适用",value:"both"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"]),l(ml),l(pl,{ref:"uploadRef",drag:"","auto-upload":!1,"on-change":Ze,accept:".xlsx,.xls,.csv,.docx,.md,.txt"},{tip:a(()=>[...e[66]||(e[66]=[n("div",{class:"el-upload__tip"}," 支持 Excel (.xlsx/.xls)、CSV、Word (.docx)、Markdown (.md)、文本 (.txt) 格式 ",-1)])]),default:a(()=>[l(p,{class:"el-icon--upload"},{default:a(()=>[l(x(xl))]),_:1}),e[67]||(e[67]=n("div",{class:"el-upload__text"},[s(" 拖拽文件到此处，或 "),n("em",null,"点击上传")],-1))]),_:1},512)])):(u(),V("div",Wl,[l(we,{type:"success",closable:!1,style:{"margin-bottom":"16px"}},{default:a(()=>[s(" 解析成功，将创建标准集「"+_(C.name)+"」，共 "+_(E.value.length)+" 条风险点 ",1)]),_:1}),l(Ve,{data:E.value,"max-height":"400",size:"small"},{default:a(()=>[l(w,{prop:"category",label:"分类",width:"100"}),l(w,{prop:"item",label:"审核要点",width:"150"}),l(w,{prop:"description",label:"说明","show-overflow-tooltip":""}),l(w,{label:"风险",width:"60"},{default:a(({row:t})=>[s(_(ne(t.risk_level)),1)]),_:1})]),_:1},8,["data"])]))]),_:1},8,["modelValue"]),l(ie,{modelValue:W.value,"onUpdate:modelValue":e[40]||(e[40]=t=>W.value=t),title:ol.value,width:"900px","close-on-click-modal":!1,onClose:Be},{footer:a(()=>[n("div",mt,[l(m,{onClick:e[36]||(e[36]=t=>W.value=!1)},{default:a(()=>[...e[81]||(e[81]=[s("取消",-1)])]),_:1}),S.value===1?(u(),T(m,{key:0,type:"primary",onClick:nl,loading:ve.value,disabled:!qe.value},{default:a(()=>[l(p,null,{default:a(()=>[l(x(je))]),_:1}),e[82]||(e[82]=s(" 生成标准 ",-1))]),_:1},8,["loading","disabled"])):z("",!0),S.value===2?(u(),V(h,{key:1},[l(m,{onClick:e[37]||(e[37]=t=>S.value=1)},{default:a(()=>[...e[83]||(e[83]=[s("上一步",-1)])]),_:1}),l(m,{type:"primary",onClick:e[38]||(e[38]=t=>S.value=3),disabled:!L.value.length||!I.value},{default:a(()=>[...e[84]||(e[84]=[s(" 下一步 ",-1)])]),_:1},8,["disabled"])],64)):z("",!0),S.value===3?(u(),V(h,{key:2},[l(m,{onClick:e[39]||(e[39]=t=>S.value=2)},{default:a(()=>[...e[85]||(e[85]=[s("上一步",-1)])]),_:1}),l(m,{type:"primary",onClick:il,loading:_e.value},{default:a(()=>[...e[86]||(e[86]=[s(" 确认入库 ",-1)])]),_:1},8,["loading"])],64)):z("",!0)])]),default:a(()=>[l(cl,{active:S.value-1,"align-center":"",style:{"margin-bottom":"24px"}},{default:a(()=>[l(xe,{title:"填写问卷",description:"提供业务信息"}),l(xe,{title:"预览编辑",description:"确认生成的标准"}),l(xe,{title:"确认入库",description:"保存到标准库"})]),_:1},8,["active"]),S.value===1?(u(),V("div",Xl,[l(Z,{model:i,"label-width":"120px","label-position":"top"},{default:a(()=>[n("div",Yl,[e[75]||(e[75]=n("div",{class:"form-section-title"},[n("span",{class:"required-badge"},"必答"),s(" 基本信息 ")],-1)),l(c,{label:"文档类型",required:""},{default:a(()=>[l(fl,{modelValue:i.document_type,"onUpdate:modelValue":e[26]||(e[26]=t=>i.document_type=t)},{default:a(()=>[l(Ce,{value:"contract"},{default:a(()=>[...e[72]||(e[72]=[s("合同",-1)])]),_:1}),l(Ce,{value:"marketing"},{default:a(()=>[...e[73]||(e[73]=[s("营销材料",-1)])]),_:1}),l(Ce,{value:"both"},{default:a(()=>[...e[74]||(e[74]=[s("两者都有",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(c,{label:"业务场景描述",required:""},{default:a(()=>[l(v,{modelValue:i.business_scenario,"onUpdate:modelValue":e[27]||(e[27]=t=>i.business_scenario=t),type:"textarea",rows:3,placeholder:"请详细描述您的业务场景，例如：我们是一家软件公司，需要审核与客户签订的SaaS服务协议，主要涉及订阅费用、服务级别承诺、数据安全等条款...",maxlength:"500","show-word-limit":""},null,8,["modelValue"])]),_:1}),l(c,{label:"核心关注点",required:""},{default:a(()=>[n("div",Zl,[l(ke,{modelValue:i.focus_areas,"onUpdate:modelValue":e[28]||(e[28]=t=>i.focus_areas=t)},{default:a(()=>[(u(),V(h,null,ee(tl,t=>l(Y,{key:t,value:t,label:t},null,8,["value","label"])),64))]),_:1},8,["modelValue"]),l(v,{modelValue:i.custom_focus,"onUpdate:modelValue":e[29]||(e[29]=t=>i.custom_focus=t),placeholder:"其他关注点（逗号分隔）",style:{"margin-top":"8px",width:"300px"}},null,8,["modelValue"])])]),_:1})]),n("div",et,[e[76]||(e[76]=n("div",{class:"form-section-title"},[n("span",{class:"optional-badge"},"选答"),s(" 补充信息（帮助生成更精准的标准） ")],-1)),l(c,{label:"我方角色"},{default:a(()=>[l(v,{modelValue:i.our_role,"onUpdate:modelValue":e[30]||(e[30]=t=>i.our_role=t),placeholder:"例如：甲方/采购方/服务提供方/委托方"},null,8,["modelValue"])]),_:1}),l(c,{label:"所属行业"},{default:a(()=>[n("div",lt,[l(D,{modelValue:i.industry,"onUpdate:modelValue":e[31]||(e[31]=t=>i.industry=t),placeholder:"选择行业",clearable:"",style:{width:"200px"}},{default:a(()=>[(u(),V(h,null,ee(al,t=>l(b,{key:t,label:t,value:t},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),l(v,{modelValue:i.custom_industry,"onUpdate:modelValue":e[32]||(e[32]=t=>i.custom_industry=t),placeholder:"或输入其他行业",style:{width:"200px","margin-left":"12px"}},null,8,["modelValue"])])]),_:1}),l(c,{label:"特殊风险关注"},{default:a(()=>[l(v,{modelValue:i.special_risks,"onUpdate:modelValue":e[33]||(e[33]=t=>i.special_risks=t),type:"textarea",rows:2,placeholder:"如有特殊的风险点需要关注，请在此说明"},null,8,["modelValue"])]),_:1}),l(c,{label:"参考材料"},{default:a(()=>[l(v,{modelValue:i.reference_material,"onUpdate:modelValue":e[34]||(e[34]=t=>i.reference_material=t),type:"textarea",rows:4,placeholder:"粘贴相关的法规条文、行业规范、已有合同模板等作为参考"},null,8,["modelValue"])]),_:1})])]),_:1},8,["model"])])):z("",!0),S.value===2?(u(),V("div",tt,[oe.value?(u(),T(we,{key:0,type:"success",closable:!1,style:{"margin-bottom":"16px"}},{default:a(()=>[s(_(oe.value),1)]),_:1})):z("",!0),n("div",at,[l(c,{label:"标准集名称","label-width":"100px"},{default:a(()=>[l(v,{modelValue:I.value,"onUpdate:modelValue":e[35]||(e[35]=t=>I.value=t),placeholder:"AI生成的名称，可修改"},null,8,["modelValue"])]),_:1})]),l(Ve,{data:L.value,border:"",size:"small","max-height":"350"},{default:a(()=>[l(w,{type:"expand"},{default:a(({row:t,$index:F})=>[n("div",ot,[l(Z,{"label-width":"80px",size:"small"},{default:a(()=>[l(c,{label:"分类"},{default:a(()=>[l(v,{modelValue:t.category,"onUpdate:modelValue":U=>t.category=U},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(c,{label:"审核要点"},{default:a(()=>[l(v,{modelValue:t.item,"onUpdate:modelValue":U=>t.item=U},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(c,{label:"详细说明"},{default:a(()=>[l(v,{modelValue:t.description,"onUpdate:modelValue":U=>t.description=U,type:"textarea",rows:2},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(c,{label:"风险等级"},{default:a(()=>[l(D,{modelValue:t.risk_level,"onUpdate:modelValue":U=>t.risk_level=U},{default:a(()=>[l(b,{label:"高",value:"high"}),l(b,{label:"中",value:"medium"}),l(b,{label:"低",value:"low"})]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(c,{label:"适用类型"},{default:a(()=>[l(ke,{modelValue:t.applicable_to,"onUpdate:modelValue":U=>t.applicable_to=U},{default:a(()=>[l(Y,{label:"contract",value:"contract"},{default:a(()=>[...e[77]||(e[77]=[s("合同",-1)])]),_:1}),l(Y,{label:"marketing",value:"marketing"},{default:a(()=>[...e[78]||(e[78]=[s("营销材料",-1)])]),_:1})]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(c,{label:"适用说明"},{default:a(()=>[l(v,{modelValue:t.usage_instruction,"onUpdate:modelValue":U=>t.usage_instruction=U,type:"textarea",rows:2},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),n("div",nt,[l(m,{type:"danger",size:"small",onClick:U=>sl(F)},{default:a(()=>[...e[79]||(e[79]=[s(" 删除此标准 ",-1)])]),_:1},8,["onClick"])])])]),_:1}),l(w,{prop:"category",label:"分类",width:"100"}),l(w,{prop:"item",label:"审核要点",width:"150"}),l(w,{prop:"description",label:"说明","show-overflow-tooltip":""}),l(w,{label:"风险",width:"60",align:"center"},{default:a(({row:t})=>[l(X,{type:ye(t.risk_level),size:"small"},{default:a(()=>[s(_(ne(t.risk_level)),1)]),_:2},1032,["type"])]),_:1})]),_:1},8,["data"]),n("div",st,[l(p,null,{default:a(()=>[l(x(Cl))]),_:1}),e[80]||(e[80]=s(" 点击行左侧展开按钮可编辑标准详情 ",-1))])])):z("",!0),S.value===3?(u(),V("div",it,[l(we,{type:"info",closable:!1,style:{"margin-bottom":"16px"}},{default:a(()=>[s(" 将创建标准集「"+_(I.value)+"」，包含 "+_(L.value.length)+" 条风险点 ",1)]),_:1}),n("div",dt,[(u(!0),V(h,null,ee(L.value,(t,F)=>(u(),V("div",{key:F,class:"usage-item"},[n("div",ut,[l(X,{type:ye(t.risk_level),size:"small"},{default:a(()=>[s(_(ne(t.risk_level)),1)]),_:2},1032,["type"]),n("span",rt,_(t.category)+" - "+_(t.item),1)]),l(v,{modelValue:t.usage_instruction,"onUpdate:modelValue":U=>t.usage_instruction=U,type:"textarea",rows:2,placeholder:"说明该标准适用的条件，例如：适用于涉及支付条款的合同"},null,8,["modelValue","onUpdate:modelValue"])]))),128))])])):z("",!0)]),_:1},8,["modelValue","title"])])}}},_t=Ul(pt,[["__scopeId","data-v-37d6bc04"]]);export{_t as default};
