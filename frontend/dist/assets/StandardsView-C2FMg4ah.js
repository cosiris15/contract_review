import{_ as yl,q as bl,r as i,c as ze,I as re,o as Vl,b as v,D as kl,d as V,e as d,i as l,F as q,h as n,y as Oe,w as t,j as s,k as x,J as je,K as wl,L as Cl,M as Re,B as Ge,f as $,g as L,m as le,C as xl,t as c,N as Ul,n as $e,O as Ke,P as Sl,Q as zl,R as $l,v as Ll,E as r,p as Je}from"./index-BNaM8M1n.js";import{a as z}from"./index-BOy5KFeg.js";const Nl={class:"standards-view"},Tl={class:"page-header"},Fl={class:"header-actions"},ql={class:"filter-row"},Il={class:"collections-list"},Dl=["onClick"],El={class:"collection-icon"},hl={class:"collection-info"},Bl={class:"collection-name"},Ml={class:"collection-desc"},Al={class:"collection-meta"},Ol={class:"collection-actions"},jl={class:"detail-header"},Rl={class:"info-row"},Gl={class:"info-item"},Kl={class:"info-value"},Jl={class:"info-item"},Pl={class:"info-value"},Ql={class:"info-item"},Wl={class:"info-value"},Hl={class:"filter-row"},Xl={key:0},Yl={class:"table-footer"},Zl={key:0},ea={key:1},la={key:0,class:"create-step-content"},aa={class:"form-section"},ta={class:"focus-area-selector"},oa={class:"form-section"},na={class:"industry-selector"},sa={key:1,class:"create-step-content"},ua={class:"collection-name-edit"},ia={class:"expand-edit-form"},da={class:"expand-actions"},ra={class:"step2-tip"},ma={key:2,class:"create-step-content"},pa={class:"usage-instruction-list"},fa={class:"usage-item-header"},va={class:"usage-item-title"},ca={class:"create-dialog-footer"},_a={__name:"StandardsView",setup(ga){const Pe=bl(),me=i(!1),Le=i([]),ae=i(""),te=i(""),oe=i(""),y=i(null),Ne=ze(()=>{let o=Le.value;if(ae.value){const e=ae.value.toLowerCase();o=o.filter(f=>f.name.toLowerCase().includes(e)||f.description&&f.description.toLowerCase().includes(e))}return te.value&&(o=o.filter(e=>e.material_type===te.value||e.material_type==="both")),o});async function h(){me.value=!0;try{const o={};oe.value&&(o.language=oe.value);const e=await z.getCollections(o);Le.value=e.data}catch(o){r.error("加载标准集失败: "+o.message)}finally{me.value=!1}}async function Te(o){y.value=o,await M(),await ce()}function Qe(){y.value=null,B.value=[],W.value="",H.value="",Q.value=""}const P=i(!1),pe=i(!1),fe=i(null),k=re({name:"",description:"",material_type:"both"});function Fe(o){fe.value=o,k.name=o.name,k.description=o.description,k.material_type=o.material_type,P.value=!0}async function We(){if(!k.name.trim()){r.warning("集合名称不能为空");return}pe.value=!0;try{await z.updateCollection(fe.value.id,{name:k.name,description:k.description,material_type:k.material_type}),r.success("更新成功"),P.value=!1,y.value&&y.value.id===fe.value.id&&(y.value.name=k.name,y.value.description=k.description,y.value.material_type=k.material_type),h()}catch(o){r.error("更新失败: "+o.message)}finally{pe.value=!1}}async function He(o){if(o.is_preset){r.warning("系统预设集合不可删除");return}try{await Je.confirm(`确定要删除标准集「${o.name}」吗？该集合内的所有风险点将一并删除。`,"确认删除",{type:"warning"}),await z.deleteCollection(o.id),r.success("删除成功"),h()}catch(e){e!=="cancel"&&r.error("删除失败: "+e.message)}}const ve=i(!1),B=i([]),qe=i([]),Q=i(""),W=i(""),H=i(""),ne=i([]);async function M(){if(y.value){ve.value=!0;try{const o={};W.value&&(o.category=W.value),H.value&&(o.risk_level=H.value),Q.value&&(o.keyword=Q.value);const e=await z.getCollectionStandards(y.value.id,o);B.value=e.data}catch(o){r.error("加载风险点失败: "+o.message)}finally{ve.value=!1}}}async function ce(){if(y.value)try{const o=await z.getCollectionCategories(y.value.id);qe.value=o.data}catch(o){console.error("加载分类失败:",o)}}let Ie=null;function Xe(){clearTimeout(Ie),Ie=setTimeout(()=>{M()},300)}const A=i(!1),O=i(!1),j=i(null),b=re({category:"",item:"",description:"",risk_level:"medium",applicable_to:["contract","marketing"],usage_instruction:""});function Ye(o){j.value=o,Object.assign(b,{category:o.category,item:o.item,description:o.description,risk_level:o.risk_level,applicable_to:o.applicable_to||["contract","marketing"],usage_instruction:o.usage_instruction||""}),A.value=!0}async function Ze(){if(!b.category||!b.item||!b.description){r.warning("请填写必填字段");return}O.value=!0;try{j.value?(await z.updateLibraryStandard(j.value.id,b),r.success("更新成功")):(await z.addStandardToCollection(y.value.id,b),r.success("添加成功")),A.value=!1,De(),M(),ce(),y.value.standard_count=B.value.length+(j.value?0:1)}catch(o){r.error("保存失败: "+o.message)}finally{O.value=!1}}async function el(o){try{await Je.confirm(`确定要删除风险点「${o.item}」吗？`,"确认删除",{type:"warning"}),await z.deleteLibraryStandard(o.id),r.success("删除成功"),M(),ce(),y.value.standard_count--}catch(e){e!=="cancel"&&r.error("删除失败: "+e.message)}}function De(){j.value=null,Object.assign(b,{category:"",item:"",description:"",risk_level:"medium",applicable_to:["contract","marketing"],usage_instruction:""})}async function ll(o){ne.value.push(o.id);try{const e=await z.generateUsageInstruction({standard_ids:[o.id]});e.data.success_count>0?(o.usage_instruction=e.data.results[0].usage_instruction,r.success("生成成功")):r.error("生成失败: "+e.data.errors[0])}catch(e){r.error("生成失败: "+e.message)}finally{ne.value=ne.value.filter(e=>e!==o.id)}}const X=i(!1),R=i(1),Y=i(null),G=i([]),_e=i(!1),w=re({name:"",description:"",material_type:"both",language:"zh-CN"});function al(o){Y.value=o.raw}async function tl(){if(Y.value){if(!w.name.trim()){r.warning("请先输入集合名称");return}_e.value=!0;try{const o=await z.previewStandards(Y.value);G.value=o.data.standards,R.value=2,r.success(`解析成功，共 ${o.data.total_count} 条标准`)}catch(o){r.error("解析失败: "+o.message)}finally{_e.value=!1}}}async function ol(){if(G.value.length){O.value=!0;try{const o=await z.saveToLibrary({collection_name:w.name,collection_description:w.description,material_type:w.material_type,language:w.language,standards:G.value});r.success(o.data.message),X.value=!1,Ee(),h()}catch(o){r.error("保存失败: "+o.message)}finally{O.value=!1}}}function Ee(){R.value=1,Y.value=null,G.value=[],Object.assign(w,{name:"",description:"",material_type:"both",language:"zh-CN"})}const K=i(!1),S=i(1),ge=i(!1),ye=i(!1),T=i([]),I=i(""),se=i(""),u=re({document_type:"contract",business_scenario:"",focus_areas:[],our_role:"",industry:"",special_risks:"",reference_material:"",custom_focus:"",custom_industry:"",language:"zh-CN"}),nl=["合同主体资格","权利义务条款","费用与支付","违约责任","知识产权","保密条款","争议解决","合规性要求"],sl=["信息技术/互联网","金融/保险","制造业","房地产/建筑","医疗/生物","零售/消费"],ul=ze(()=>["制作审核标准","预览编辑标准","确认入库"][S.value-1]),he=ze(()=>u.business_scenario.trim()&&(u.focus_areas.length>0||u.custom_focus.trim()));async function il(){var o,e;if(!he.value){r.warning("请填写业务场景和至少一个关注点");return}ge.value=!0;try{const f=[...u.focus_areas];if(u.custom_focus.trim()){const Ve=u.custom_focus.split(/[,，、]/).map(ke=>ke.trim()).filter(Boolean);f.push(...Ve)}const p=u.custom_industry.trim()||u.industry,D=await z.createStandardsFromBusiness({document_type:u.document_type,business_scenario:u.business_scenario,focus_areas:f,our_role:u.our_role||null,industry:p||null,special_risks:u.special_risks||null,reference_material:u.reference_material||null,language:u.language});T.value=D.data.standards,I.value=D.data.collection_name||"",se.value=D.data.generation_summary||`成功生成 ${D.data.standards.length} 条标准`,S.value=2,r.success("标准生成成功")}catch(f){r.error("生成标准失败: "+(((e=(o=f.response)==null?void 0:o.data)==null?void 0:e.detail)||f.message))}finally{ge.value=!1}}function dl(o){T.value.splice(o,1)}async function rl(){if(!T.value.length){r.warning("没有可保存的标准");return}if(!I.value.trim()){r.warning("请输入标准集名称");return}ye.value=!0;try{const o=await z.saveToLibrary({collection_name:I.value,collection_description:u.business_scenario,material_type:u.document_type==="both"?"both":u.document_type,language:u.language,standards:T.value});r.success(o.data.message||"标准保存成功"),K.value=!1,Be(),h()}catch(o){r.error("保存失败: "+o.message)}finally{ye.value=!1}}function Be(){S.value=1,Object.assign(u,{document_type:"contract",business_scenario:"",focus_areas:[],our_role:"",industry:"",special_risks:"",reference_material:"",custom_focus:"",custom_industry:"",language:"zh-CN"}),T.value=[],I.value="",se.value=""}function be(o){return{high:"danger",medium:"warning",low:"success"}[o]||"info"}function ue(o){return{high:"高",medium:"中",low:"低"}[o]||o}function ml(o){return o?o.map(e=>e==="contract"?"合同":"营销").join("、"):""}function Me(o){return{contract:"合同",marketing:"营销材料",both:"合同/营销"}[o]||o}function pl(o){return{"zh-CN":"中文",en:"English"}[o]||o||"中文"}function fl(o){o==="upload"?X.value=!0:o==="ai"&&(K.value=!0)}return Vl(async()=>{await h(),Pe.query.action==="ai-create"&&(K.value=!0)}),(o,e)=>{const f=v("el-icon"),p=v("el-button"),D=v("el-dropdown-item"),Ve=v("el-dropdown-menu"),ke=v("el-dropdown"),_=v("el-input"),g=v("el-option"),F=v("el-select"),ie=v("el-card"),vl=v("el-empty"),J=v("el-tag"),C=v("el-table-column"),we=v("el-table"),m=v("el-form-item"),Z=v("el-checkbox"),Ce=v("el-checkbox-group"),ee=v("el-form"),de=v("el-dialog"),E=v("el-radio"),xe=v("el-radio-group"),cl=v("el-divider"),_l=v("el-upload"),Ue=v("el-alert"),Se=v("el-step"),gl=v("el-steps"),Ae=kl("loading");return d(),V("div",Nl,[y.value?(d(),V(q,{key:1},[n("div",jl,[l(p,{text:"",onClick:Qe},{default:t(()=>[l(f,null,{default:t(()=>[l(x(zl))]),_:1}),e[55]||(e[55]=s(" 返回列表 ",-1))]),_:1}),n("h2",null,c(y.value.name),1),y.value.is_preset?(d(),$(J,{key:0,size:"small",type:"info"},{default:t(()=>[...e[56]||(e[56]=[s("系统预设",-1)])]),_:1})):L("",!0)]),l(ie,{class:"collection-info-card"},{default:t(()=>[n("div",Rl,[n("div",Gl,[e[57]||(e[57]=n("span",{class:"info-label"},"适用场景：",-1)),n("span",Kl,c(y.value.description||"暂无描述"),1)]),n("div",Jl,[e[58]||(e[58]=n("span",{class:"info-label"},"材料类型：",-1)),n("span",Pl,c(Me(y.value.material_type)),1)]),n("div",Ql,[e[59]||(e[59]=n("span",{class:"info-label"},"审核条目数量：",-1)),n("span",Wl,c(B.value.length)+" 条",1)])]),l(p,{type:"primary",text:"",size:"small",onClick:e[3]||(e[3]=a=>Fe(y.value))},{default:t(()=>[l(f,null,{default:t(()=>[l(x(Ke))]),_:1}),e[60]||(e[60]=s(" 编辑标准信息 ",-1))]),_:1})]),_:1}),l(ie,{class:"filter-card"},{default:t(()=>[n("div",Hl,[l(_,{modelValue:Q.value,"onUpdate:modelValue":e[4]||(e[4]=a=>Q.value=a),placeholder:"搜索审核条目...",clearable:"",style:{width:"300px"},onInput:Xe},{prefix:t(()=>[l(f,null,{default:t(()=>[l(x(Ge))]),_:1})]),_:1},8,["modelValue"]),l(F,{modelValue:W.value,"onUpdate:modelValue":e[5]||(e[5]=a=>W.value=a),placeholder:"选择分类",clearable:"",style:{width:"200px"},onChange:M},{default:t(()=>[(d(!0),V(q,null,le(qe.value,a=>(d(),$(g,{key:a,label:a,value:a},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),l(F,{modelValue:H.value,"onUpdate:modelValue":e[6]||(e[6]=a=>H.value=a),placeholder:"风险等级",clearable:"",style:{width:"150px"},onChange:M},{default:t(()=>[l(g,{label:"高",value:"high"}),l(g,{label:"中",value:"medium"}),l(g,{label:"低",value:"low"})]),_:1},8,["modelValue"]),l(p,{type:"primary",onClick:e[7]||(e[7]=a=>A.value=!0)},{default:t(()=>[l(f,null,{default:t(()=>[l(x(je))]),_:1}),e[61]||(e[61]=s(" 添加审核条目 ",-1))]),_:1})])]),_:1}),l(ie,{class:"table-card"},{default:t(()=>[Oe((d(),$(we,{data:B.value,stripe:"",style:{width:"100%"}},{default:t(()=>[l(C,{prop:"category",label:"分类",width:"120"}),l(C,{prop:"item",label:"审核要点","min-width":"180"}),l(C,{prop:"description",label:"说明","min-width":"250","show-overflow-tooltip":""}),l(C,{label:"风险等级",width:"100",align:"center"},{default:t(({row:a})=>[l(J,{type:be(a.risk_level),size:"small"},{default:t(()=>[s(c(ue(a.risk_level)),1)]),_:2},1032,["type"])]),_:1}),l(C,{label:"适用类型",width:"120"},{default:t(({row:a})=>[n("span",null,c(ml(a.applicable_to)),1)]),_:1}),l(C,{prop:"usage_instruction",label:"适用说明","min-width":"200","show-overflow-tooltip":""},{default:t(({row:a})=>[a.usage_instruction?(d(),V("span",Xl,c(a.usage_instruction),1)):(d(),$(p,{key:1,type:"primary",text:"",size:"small",onClick:N=>ll(a),loading:ne.value.includes(a.id)},{default:t(()=>[...e[62]||(e[62]=[s(" 生成 ",-1)])]),_:1},8,["onClick","loading"]))]),_:1}),l(C,{label:"操作",width:"150",fixed:"right"},{default:t(({row:a})=>[l(p,{type:"primary",text:"",size:"small",onClick:N=>Ye(a)},{default:t(()=>[...e[63]||(e[63]=[s(" 编辑 ",-1)])]),_:1},8,["onClick"]),l(p,{type:"danger",text:"",size:"small",onClick:N=>el(a)},{default:t(()=>[...e[64]||(e[64]=[s(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[Ae,ve.value]]),n("div",Yl,[n("span",null,"共 "+c(B.value.length)+" 条审核条目",1)])]),_:1})],64)):(d(),V(q,{key:0},[n("div",Tl,[e[47]||(e[47]=n("div",{class:"header-left"},[n("h1",null,"审核标准管理"),n("p",{class:"subtitle"},"管理审核标准，每套标准包含若干审核条目")],-1)),n("div",Fl,[l(ke,{trigger:"click",onCommand:fl},{dropdown:t(()=>[l(Ve,null,{default:t(()=>[l(D,{command:"upload"},{default:t(()=>[l(f,null,{default:t(()=>[l(x(Cl))]),_:1}),e[45]||(e[45]=s(" 上传新标准（批量） ",-1))]),_:1}),l(D,{command:"ai"},{default:t(()=>[l(f,null,{default:t(()=>[l(x(Re))]),_:1}),e[46]||(e[46]=s(" AI辅助制作（批量） ",-1))]),_:1})]),_:1})]),default:t(()=>[l(p,{type:"primary"},{default:t(()=>[l(f,null,{default:t(()=>[l(x(je))]),_:1}),e[44]||(e[44]=s(" 新建标准集 ",-1)),l(f,{class:"el-icon--right"},{default:t(()=>[l(x(wl))]),_:1})]),_:1})]),_:1})])]),l(ie,{class:"filter-card"},{default:t(()=>[n("div",ql,[l(_,{modelValue:ae.value,"onUpdate:modelValue":e[0]||(e[0]=a=>ae.value=a),placeholder:"搜索标准集...",clearable:"",style:{width:"300px"}},{prefix:t(()=>[l(f,null,{default:t(()=>[l(x(Ge))]),_:1})]),_:1},8,["modelValue"]),l(F,{modelValue:te.value,"onUpdate:modelValue":e[1]||(e[1]=a=>te.value=a),placeholder:"材料类型",clearable:"",style:{width:"150px"}},{default:t(()=>[l(g,{label:"合同",value:"contract"}),l(g,{label:"营销材料",value:"marketing"})]),_:1},8,["modelValue"]),l(F,{modelValue:oe.value,"onUpdate:modelValue":e[2]||(e[2]=a=>oe.value=a),placeholder:"标准语言",clearable:"",style:{width:"150px"},onChange:h},{default:t(()=>[l(g,{label:"中文",value:"zh-CN"}),l(g,{label:"English",value:"en"})]),_:1},8,["modelValue"])])]),_:1}),Oe((d(),V("div",Il,[Ne.value.length===0?(d(),$(vl,{key:0,description:"暂无标准集"})):L("",!0),(d(!0),V(q,null,le(Ne.value,a=>(d(),V("div",{key:a.id,class:"collection-card"},[n("div",{class:"collection-card-main",onClick:N=>Te(a)},[n("div",El,[l(f,{size:24},{default:t(()=>[l(x(xl))]),_:1})]),n("div",hl,[n("div",Bl,[s(c(a.name)+" ",1),a.is_preset?(d(),$(J,{key:0,size:"small",type:"info"},{default:t(()=>[...e[48]||(e[48]=[s("系统预设",-1)])]),_:1})):L("",!0),a.language==="en"?(d(),$(J,{key:1,size:"small",type:"success"},{default:t(()=>[...e[49]||(e[49]=[s("EN",-1)])]),_:1})):L("",!0)]),n("div",Ml,c(a.description||"暂无描述"),1),n("div",Al,[n("span",null,c(a.standard_count)+" 条审核条目",1),e[50]||(e[50]=n("span",{class:"meta-sep"},"|",-1)),n("span",null,c(Me(a.material_type)),1),e[51]||(e[51]=n("span",{class:"meta-sep"},"|",-1)),n("span",null,c(pl(a.language)),1)])])],8,Dl),n("div",Ol,[l(p,{text:"",type:"primary",onClick:$e(N=>Te(a),["stop"])},{default:t(()=>[l(f,null,{default:t(()=>[l(x(Ul))]),_:1}),e[52]||(e[52]=s(" 查看 ",-1))]),_:1},8,["onClick"]),l(p,{text:"",type:"primary",onClick:$e(N=>Fe(a),["stop"])},{default:t(()=>[l(f,null,{default:t(()=>[l(x(Ke))]),_:1}),e[53]||(e[53]=s(" 编辑 ",-1))]),_:1},8,["onClick"]),l(p,{text:"",type:"danger",onClick:$e(N=>He(a),["stop"]),disabled:a.is_preset},{default:t(()=>[l(f,null,{default:t(()=>[l(x(Sl))]),_:1}),e[54]||(e[54]=s(" 删除 ",-1))]),_:1},8,["onClick","disabled"])])]))),128))])),[[Ae,me.value]])],64)),l(de,{modelValue:A.value,"onUpdate:modelValue":e[15]||(e[15]=a=>A.value=a),title:j.value?"编辑审核条目":"添加审核条目",width:"600px",onClose:De},{footer:t(()=>[l(p,{onClick:e[14]||(e[14]=a=>A.value=!1)},{default:t(()=>[...e[67]||(e[67]=[s("取消",-1)])]),_:1}),l(p,{type:"primary",onClick:Ze,loading:O.value},{default:t(()=>[...e[68]||(e[68]=[s(" 保存 ",-1)])]),_:1},8,["loading"])]),default:t(()=>[l(ee,{model:b,"label-width":"100px"},{default:t(()=>[l(m,{label:"分类",required:""},{default:t(()=>[l(_,{modelValue:b.category,"onUpdate:modelValue":e[8]||(e[8]=a=>b.category=a),placeholder:"如：主体资格、权利义务"},null,8,["modelValue"])]),_:1}),l(m,{label:"审核要点",required:""},{default:t(()=>[l(_,{modelValue:b.item,"onUpdate:modelValue":e[9]||(e[9]=a=>b.item=a),placeholder:"简要描述审核要点"},null,8,["modelValue"])]),_:1}),l(m,{label:"详细说明",required:""},{default:t(()=>[l(_,{modelValue:b.description,"onUpdate:modelValue":e[10]||(e[10]=a=>b.description=a),type:"textarea",rows:3,placeholder:"详细的审核说明"},null,8,["modelValue"])]),_:1}),l(m,{label:"风险等级"},{default:t(()=>[l(F,{modelValue:b.risk_level,"onUpdate:modelValue":e[11]||(e[11]=a=>b.risk_level=a),style:{width:"100%"}},{default:t(()=>[l(g,{label:"高",value:"high"}),l(g,{label:"中",value:"medium"}),l(g,{label:"低",value:"low"})]),_:1},8,["modelValue"])]),_:1}),l(m,{label:"适用类型"},{default:t(()=>[l(Ce,{modelValue:b.applicable_to,"onUpdate:modelValue":e[12]||(e[12]=a=>b.applicable_to=a)},{default:t(()=>[l(Z,{label:"contract"},{default:t(()=>[...e[65]||(e[65]=[s("合同",-1)])]),_:1}),l(Z,{label:"marketing"},{default:t(()=>[...e[66]||(e[66]=[s("营销材料",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(m,{label:"适用说明"},{default:t(()=>[l(_,{modelValue:b.usage_instruction,"onUpdate:modelValue":e[13]||(e[13]=a=>b.usage_instruction=a),type:"textarea",rows:2,placeholder:"可选，说明何时使用该标准"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),l(de,{modelValue:P.value,"onUpdate:modelValue":e[20]||(e[20]=a=>P.value=a),title:"编辑标准信息",width:"500px"},{footer:t(()=>[l(p,{onClick:e[19]||(e[19]=a=>P.value=!1)},{default:t(()=>[...e[69]||(e[69]=[s("取消",-1)])]),_:1}),l(p,{type:"primary",onClick:We,loading:pe.value},{default:t(()=>[...e[70]||(e[70]=[s(" 保存 ",-1)])]),_:1},8,["loading"])]),default:t(()=>[l(ee,{model:k,"label-width":"100px"},{default:t(()=>[l(m,{label:"标准名称",required:""},{default:t(()=>[l(_,{modelValue:k.name,"onUpdate:modelValue":e[16]||(e[16]=a=>k.name=a),placeholder:"如：电商平台合作协议审核标准"},null,8,["modelValue"])]),_:1}),l(m,{label:"适用场景"},{default:t(()=>[l(_,{modelValue:k.description,"onUpdate:modelValue":e[17]||(e[17]=a=>k.description=a),type:"textarea",rows:3,placeholder:"描述该标准集的适用场景"},null,8,["modelValue"])]),_:1}),l(m,{label:"材料类型"},{default:t(()=>[l(F,{modelValue:k.material_type,"onUpdate:modelValue":e[18]||(e[18]=a=>k.material_type=a),style:{width:"100%"}},{default:t(()=>[l(g,{label:"合同",value:"contract"}),l(g,{label:"营销材料",value:"marketing"}),l(g,{label:"两者都适用",value:"both"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(de,{modelValue:X.value,"onUpdate:modelValue":e[27]||(e[27]=a=>X.value=a),title:"上传审核标准",width:"700px",onClose:Ee},{footer:t(()=>[l(p,{onClick:e[25]||(e[25]=a=>X.value=!1)},{default:t(()=>[...e[75]||(e[75]=[s("取消",-1)])]),_:1}),R.value===1?(d(),$(p,{key:0,type:"primary",onClick:tl,loading:_e.value,disabled:!Y.value||!w.name},{default:t(()=>[...e[76]||(e[76]=[s(" 预览 ",-1)])]),_:1},8,["loading","disabled"])):(d(),$(p,{key:1,onClick:e[26]||(e[26]=a=>R.value=1)},{default:t(()=>[...e[77]||(e[77]=[s(" 上一步 ",-1)])]),_:1})),R.value===2?(d(),$(p,{key:2,type:"primary",onClick:ol,loading:O.value},{default:t(()=>[...e[78]||(e[78]=[s(" 确认入库 ",-1)])]),_:1},8,["loading"])):L("",!0)]),default:t(()=>[R.value===1?(d(),V("div",Zl,[l(ee,{model:w,"label-width":"100px"},{default:t(()=>[l(m,{label:"标准名称",required:""},{default:t(()=>[l(_,{modelValue:w.name,"onUpdate:modelValue":e[21]||(e[21]=a=>w.name=a),placeholder:"如：电商平台合作协议审核标准"},null,8,["modelValue"])]),_:1}),l(m,{label:"适用场景"},{default:t(()=>[l(_,{modelValue:w.description,"onUpdate:modelValue":e[22]||(e[22]=a=>w.description=a),type:"textarea",rows:2,placeholder:"描述该标准集的适用场景"},null,8,["modelValue"])]),_:1}),l(m,{label:"材料类型"},{default:t(()=>[l(F,{modelValue:w.material_type,"onUpdate:modelValue":e[23]||(e[23]=a=>w.material_type=a),style:{width:"100%"}},{default:t(()=>[l(g,{label:"合同",value:"contract"}),l(g,{label:"营销材料",value:"marketing"}),l(g,{label:"两者都适用",value:"both"})]),_:1},8,["modelValue"])]),_:1}),l(m,{label:"标准语言"},{default:t(()=>[l(xe,{modelValue:w.language,"onUpdate:modelValue":e[24]||(e[24]=a=>w.language=a)},{default:t(()=>[l(E,{value:"zh-CN"},{default:t(()=>[...e[71]||(e[71]=[s("中文",-1)])]),_:1}),l(E,{value:"en"},{default:t(()=>[...e[72]||(e[72]=[s("English",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"]),l(cl),l(_l,{ref:"uploadRef",drag:"","auto-upload":!1,"on-change":al,accept:".xlsx,.xls,.csv,.docx,.md,.txt"},{tip:t(()=>[...e[73]||(e[73]=[n("div",{class:"el-upload__tip"}," 支持 Excel (.xlsx/.xls)、CSV、Word (.docx)、Markdown (.md)、文本 (.txt) 格式 ",-1)])]),default:t(()=>[l(f,{class:"el-icon--upload"},{default:t(()=>[l(x($l))]),_:1}),e[74]||(e[74]=n("div",{class:"el-upload__text"},[s(" 拖拽文件到此处，或 "),n("em",null,"点击上传")],-1))]),_:1},512)])):(d(),V("div",ea,[l(Ue,{type:"success",closable:!1,style:{"margin-bottom":"16px"}},{default:t(()=>[s(" 解析成功，将创建标准集「"+c(w.name)+"」，共 "+c(G.value.length)+" 条风险点 ",1)]),_:1}),l(we,{data:G.value,"max-height":"400",size:"small"},{default:t(()=>[l(C,{prop:"category",label:"分类",width:"100"}),l(C,{prop:"item",label:"审核要点",width:"150"}),l(C,{prop:"description",label:"说明","show-overflow-tooltip":""}),l(C,{label:"风险",width:"60"},{default:t(({row:a})=>[s(c(ue(a.risk_level)),1)]),_:1})]),_:1},8,["data"])]))]),_:1},8,["modelValue"]),l(de,{modelValue:K.value,"onUpdate:modelValue":e[43]||(e[43]=a=>K.value=a),title:ul.value,width:"900px","close-on-click-modal":!1,onClose:Be},{footer:t(()=>[n("div",ca,[l(p,{onClick:e[39]||(e[39]=a=>K.value=!1)},{default:t(()=>[...e[90]||(e[90]=[s("取消",-1)])]),_:1}),S.value===1?(d(),$(p,{key:0,type:"primary",onClick:il,loading:ge.value,disabled:!he.value},{default:t(()=>[l(f,null,{default:t(()=>[l(x(Re))]),_:1}),e[91]||(e[91]=s(" 生成标准 ",-1))]),_:1},8,["loading","disabled"])):L("",!0),S.value===2?(d(),V(q,{key:1},[l(p,{onClick:e[40]||(e[40]=a=>S.value=1)},{default:t(()=>[...e[92]||(e[92]=[s("上一步",-1)])]),_:1}),l(p,{type:"primary",onClick:e[41]||(e[41]=a=>S.value=3),disabled:!T.value.length||!I.value},{default:t(()=>[...e[93]||(e[93]=[s(" 下一步 ",-1)])]),_:1},8,["disabled"])],64)):L("",!0),S.value===3?(d(),V(q,{key:2},[l(p,{onClick:e[42]||(e[42]=a=>S.value=2)},{default:t(()=>[...e[94]||(e[94]=[s("上一步",-1)])]),_:1}),l(p,{type:"primary",onClick:rl,loading:ye.value},{default:t(()=>[...e[95]||(e[95]=[s(" 确认入库 ",-1)])]),_:1},8,["loading"])],64)):L("",!0)])]),default:t(()=>[l(gl,{active:S.value-1,"align-center":"",style:{"margin-bottom":"24px"}},{default:t(()=>[l(Se,{title:"填写问卷",description:"提供业务信息"}),l(Se,{title:"预览编辑",description:"确认生成的标准"}),l(Se,{title:"确认入库",description:"保存到标准库"})]),_:1},8,["active"]),S.value===1?(d(),V("div",la,[l(ee,{model:u,"label-width":"120px","label-position":"top"},{default:t(()=>[n("div",aa,[e[84]||(e[84]=n("div",{class:"form-section-title"},[n("span",{class:"required-badge"},"必答"),s(" 基本信息 ")],-1)),l(m,{label:"文档类型",required:""},{default:t(()=>[l(xe,{modelValue:u.document_type,"onUpdate:modelValue":e[28]||(e[28]=a=>u.document_type=a)},{default:t(()=>[l(E,{value:"contract"},{default:t(()=>[...e[79]||(e[79]=[s("合同",-1)])]),_:1}),l(E,{value:"marketing"},{default:t(()=>[...e[80]||(e[80]=[s("营销材料",-1)])]),_:1}),l(E,{value:"both"},{default:t(()=>[...e[81]||(e[81]=[s("两者都有",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(m,{label:"标准语言",required:""},{default:t(()=>[l(xe,{modelValue:u.language,"onUpdate:modelValue":e[29]||(e[29]=a=>u.language=a)},{default:t(()=>[l(E,{value:"zh-CN"},{default:t(()=>[...e[82]||(e[82]=[s("中文（中国法律体系）",-1)])]),_:1}),l(E,{value:"en"},{default:t(()=>[...e[83]||(e[83]=[s("English (Common Law)",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(m,{label:"业务场景描述",required:""},{default:t(()=>[l(_,{modelValue:u.business_scenario,"onUpdate:modelValue":e[30]||(e[30]=a=>u.business_scenario=a),type:"textarea",rows:3,placeholder:"请详细描述您的业务场景，例如：我们是一家软件公司，需要审核与客户签订的SaaS服务协议，主要涉及订阅费用、服务级别承诺、数据安全等条款...",maxlength:"500","show-word-limit":""},null,8,["modelValue"])]),_:1}),l(m,{label:"核心关注点",required:""},{default:t(()=>[n("div",ta,[l(Ce,{modelValue:u.focus_areas,"onUpdate:modelValue":e[31]||(e[31]=a=>u.focus_areas=a)},{default:t(()=>[(d(),V(q,null,le(nl,a=>l(Z,{key:a,value:a,label:a},null,8,["value","label"])),64))]),_:1},8,["modelValue"]),l(_,{modelValue:u.custom_focus,"onUpdate:modelValue":e[32]||(e[32]=a=>u.custom_focus=a),placeholder:"其他关注点（逗号分隔）",style:{"margin-top":"8px",width:"300px"}},null,8,["modelValue"])])]),_:1})]),n("div",oa,[e[85]||(e[85]=n("div",{class:"form-section-title"},[n("span",{class:"optional-badge"},"选答"),s(" 补充信息（帮助生成更精准的标准） ")],-1)),l(m,{label:"我方角色"},{default:t(()=>[l(_,{modelValue:u.our_role,"onUpdate:modelValue":e[33]||(e[33]=a=>u.our_role=a),placeholder:"例如：甲方/采购方/服务提供方/委托方"},null,8,["modelValue"])]),_:1}),l(m,{label:"所属行业"},{default:t(()=>[n("div",na,[l(F,{modelValue:u.industry,"onUpdate:modelValue":e[34]||(e[34]=a=>u.industry=a),placeholder:"选择行业",clearable:"",style:{width:"200px"}},{default:t(()=>[(d(),V(q,null,le(sl,a=>l(g,{key:a,label:a,value:a},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),l(_,{modelValue:u.custom_industry,"onUpdate:modelValue":e[35]||(e[35]=a=>u.custom_industry=a),placeholder:"或输入其他行业",style:{width:"200px","margin-left":"12px"}},null,8,["modelValue"])])]),_:1}),l(m,{label:"特殊风险关注"},{default:t(()=>[l(_,{modelValue:u.special_risks,"onUpdate:modelValue":e[36]||(e[36]=a=>u.special_risks=a),type:"textarea",rows:2,placeholder:"如有特殊的审核要求，请在此说明"},null,8,["modelValue"])]),_:1}),l(m,{label:"参考材料"},{default:t(()=>[l(_,{modelValue:u.reference_material,"onUpdate:modelValue":e[37]||(e[37]=a=>u.reference_material=a),type:"textarea",rows:4,placeholder:"粘贴相关的法规条文、行业规范、已有合同模板等作为参考"},null,8,["modelValue"])]),_:1})])]),_:1},8,["model"])])):L("",!0),S.value===2?(d(),V("div",sa,[se.value?(d(),$(Ue,{key:0,type:"success",closable:!1,style:{"margin-bottom":"16px"}},{default:t(()=>[s(c(se.value),1)]),_:1})):L("",!0),n("div",ua,[l(m,{label:"标准集名称","label-width":"100px"},{default:t(()=>[l(_,{modelValue:I.value,"onUpdate:modelValue":e[38]||(e[38]=a=>I.value=a),placeholder:"AI生成的名称，可修改"},null,8,["modelValue"])]),_:1})]),l(we,{data:T.value,border:"",size:"small","max-height":"350"},{default:t(()=>[l(C,{type:"expand"},{default:t(({row:a,$index:N})=>[n("div",ia,[l(ee,{"label-width":"80px",size:"small"},{default:t(()=>[l(m,{label:"分类"},{default:t(()=>[l(_,{modelValue:a.category,"onUpdate:modelValue":U=>a.category=U},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(m,{label:"审核要点"},{default:t(()=>[l(_,{modelValue:a.item,"onUpdate:modelValue":U=>a.item=U},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(m,{label:"详细说明"},{default:t(()=>[l(_,{modelValue:a.description,"onUpdate:modelValue":U=>a.description=U,type:"textarea",rows:2},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(m,{label:"风险等级"},{default:t(()=>[l(F,{modelValue:a.risk_level,"onUpdate:modelValue":U=>a.risk_level=U},{default:t(()=>[l(g,{label:"高",value:"high"}),l(g,{label:"中",value:"medium"}),l(g,{label:"低",value:"low"})]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(m,{label:"适用类型"},{default:t(()=>[l(Ce,{modelValue:a.applicable_to,"onUpdate:modelValue":U=>a.applicable_to=U},{default:t(()=>[l(Z,{label:"contract",value:"contract"},{default:t(()=>[...e[86]||(e[86]=[s("合同",-1)])]),_:1}),l(Z,{label:"marketing",value:"marketing"},{default:t(()=>[...e[87]||(e[87]=[s("营销材料",-1)])]),_:1})]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(m,{label:"适用说明"},{default:t(()=>[l(_,{modelValue:a.usage_instruction,"onUpdate:modelValue":U=>a.usage_instruction=U,type:"textarea",rows:2},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),n("div",da,[l(p,{type:"danger",size:"small",onClick:U=>dl(N)},{default:t(()=>[...e[88]||(e[88]=[s(" 删除此标准 ",-1)])]),_:1},8,["onClick"])])])]),_:1}),l(C,{prop:"category",label:"分类",width:"100"}),l(C,{prop:"item",label:"审核要点",width:"150"}),l(C,{prop:"description",label:"说明","show-overflow-tooltip":""}),l(C,{label:"风险",width:"60",align:"center"},{default:t(({row:a})=>[l(J,{type:be(a.risk_level),size:"small"},{default:t(()=>[s(c(ue(a.risk_level)),1)]),_:2},1032,["type"])]),_:1})]),_:1},8,["data"]),n("div",ra,[l(f,null,{default:t(()=>[l(x(Ll))]),_:1}),e[89]||(e[89]=s(" 点击行左侧展开按钮可编辑标准详情 ",-1))])])):L("",!0),S.value===3?(d(),V("div",ma,[l(Ue,{type:"info",closable:!1,style:{"margin-bottom":"16px"}},{default:t(()=>[s(" 将创建标准集「"+c(I.value)+"」，包含 "+c(T.value.length)+" 条风险点 ",1)]),_:1}),n("div",pa,[(d(!0),V(q,null,le(T.value,(a,N)=>(d(),V("div",{key:N,class:"usage-item"},[n("div",fa,[l(J,{type:be(a.risk_level),size:"small"},{default:t(()=>[s(c(ue(a.risk_level)),1)]),_:2},1032,["type"]),n("span",va,c(a.category)+" - "+c(a.item),1)]),l(_,{modelValue:a.usage_instruction,"onUpdate:modelValue":U=>a.usage_instruction=U,type:"textarea",rows:2,placeholder:"说明该标准适用的条件，例如：适用于涉及支付条款的合同"},null,8,["modelValue","onUpdate:modelValue"])]))),128))])])):L("",!0)]),_:1},8,["modelValue","title"])])}}},Va=yl(_a,[["__scopeId","data-v-c78f4303"]]);export{Va as default};
