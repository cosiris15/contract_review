import{r as d,C as Ie,c as Le,o as Ye,b as c,A as Ze,d as k,e as v,h as n,g as T,i as l,w as t,j as o,k as z,D as el,G as ll,t as i,z as al,F as K,m as ie,f as F,H as tl,I as de,x as sl,J as ol,K as nl,L as ul,v as H,E as p,p as il}from"./index-eg14bdFL.js";import{_ as dl,a as C}from"./_plugin-vue_export-helper-BLVKql58.js";const rl={class:"standards-view"},pl={class:"page-header"},ml={class:"header-actions"},vl={key:0,class:"stats-row"},cl={class:"stat-value"},fl={class:"stat-value high"},_l={class:"stat-value medium"},gl={class:"stat-value low"},yl={class:"filter-row"},bl={key:0},Vl={class:"table-footer"},kl={key:0},wl={key:1},xl={style:{"margin-top":"16px"}},Cl={key:0,class:"create-step-content"},Ul={class:"form-section"},Sl={class:"focus-area-selector"},zl={class:"form-section"},$l={class:"industry-selector"},Il={key:1,class:"create-step-content"},Ll={class:"expand-edit-form"},Al={class:"expand-actions"},Dl={class:"step2-tip"},Tl={key:2,class:"create-step-content"},hl={class:"usage-instruction-list"},El={class:"usage-item-header"},Fl={class:"usage-item-title"},Ml={class:"create-dialog-footer"},Bl={class:"ai-edit-container"},ql={class:"current-standard"},Rl={class:"ai-input-section"},jl={class:"section-title"},Gl={class:"ai-input-actions"},Nl={key:0,class:"ai-result-section"},Ol={class:"section-title"},Kl={__name:"StandardsView",setup(Hl){const re=d(!1),J=d([]),M=d(null),ke=d([]),ee=d(""),le=d(""),ae=d(""),te=d(""),W=d(!1),P=d(null),L=d([]),pe=d(!1),A=d(!1),se=d(!1),Q=d(!1),_=Ie({category:"",item:"",description:"",risk_level:"medium",applicable_to:["contract","marketing"],usage_instruction:""}),X=d(!1),f=d(null),E=d(""),me=d(!1),r=d(null),oe=d([]),Y=d(!1),U=d(1),ve=d(!1),ce=d(!1),u=Ie({document_type:"contract",business_scenario:"",focus_areas:[],our_role:"",industry:"",special_risks:"",reference_material:"",custom_focus:"",custom_industry:""}),h=d([]),ne=d(""),Ae=["合同主体资格","权利义务条款","费用与支付","违约责任","知识产权","保密条款","争议解决","合规性要求"],De=["信息技术/互联网","金融/保险","制造业","房地产/建筑","医疗/生物","零售/消费"],Te=Le(()=>["制作审核标准","预览编辑标准","确认入库"][U.value-1]),we=Le(()=>u.business_scenario.trim()&&(u.focus_areas.length>0||u.custom_focus.trim()));async function he(){var s,e;if(!we.value){p.warning("请填写业务场景和至少一个关注点");return}ve.value=!0;try{const g=[...u.focus_areas];if(u.custom_focus.trim()){const y=u.custom_focus.split(/[,，、]/).map(w=>w.trim()).filter(Boolean);g.push(...y)}const m=u.custom_industry.trim()||u.industry,I=await C.createStandardsFromBusiness({document_type:u.document_type,business_scenario:u.business_scenario,focus_areas:g,our_role:u.our_role||null,industry:m||null,special_risks:u.special_risks||null,reference_material:u.reference_material||null});h.value=I.data.standards,ne.value=I.data.generation_summary||`成功生成 ${I.data.standards.length} 条标准`,U.value=2,p.success("标准生成成功")}catch(g){p.error("生成标准失败: "+(((e=(s=g.response)==null?void 0:s.data)==null?void 0:e.detail)||g.message))}finally{ve.value=!1}}function Ee(s){h.value.splice(s,1)}async function Fe(){if(!h.value.length){p.warning("没有可保存的标准");return}ce.value=!0;try{const s=await C.saveToLibrary({standards:h.value,replace:!1});p.success(s.data.message||"标准保存成功"),Y.value=!1,xe(),$(),B(),q()}catch(s){p.error("保存失败: "+s.message)}finally{ce.value=!1}}function xe(){U.value=1,Object.assign(u,{document_type:"contract",business_scenario:"",focus_areas:[],our_role:"",industry:"",special_risks:"",reference_material:"",custom_focus:"",custom_industry:""}),h.value=[],ne.value=""}async function $(){re.value=!0;try{const s={};le.value&&(s.category=le.value),te.value&&(s.material_type=te.value),ee.value&&(s.keyword=ee.value);const e=await C.getLibraryStandards(s);J.value=e.data,ae.value&&(J.value=J.value.filter(g=>g.risk_level===ae.value))}catch(s){p.error("加载标准失败: "+s.message)}finally{re.value=!1}}async function B(){try{const s=await C.getLibraryStats();M.value=s.data}catch(s){console.error("加载统计失败:",s)}}async function q(){try{const s=await C.getLibraryCategories();ke.value=s.data.categories}catch(s){console.error("加载分类失败:",s)}}let Ce=null;function Me(){clearTimeout(Ce),Ce=setTimeout(()=>{$()},300)}function Z(s){return{high:"danger",medium:"warning",low:"success"}[s]||"info"}function R(s){return{high:"高",medium:"中",low:"低"}[s]||s}function j(s){return s?s.map(e=>e==="contract"?"合同":"营销").join("、"):""}function Be(s){P.value=s.raw,L.value=[]}async function qe(){if(P.value){pe.value=!0;try{const s=await C.previewStandards(P.value);L.value=s.data.standards,p.success(`解析成功，共 ${s.data.total_count} 条标准`)}catch(s){p.error("解析失败: "+s.message)}finally{pe.value=!1}}}async function Re(){if(L.value.length){A.value=!0;try{const s=await C.saveToLibrary({standards:L.value,replace:se.value});p.success(s.data.message),W.value=!1,Ue(),$(),B(),q()}catch(s){p.error("保存失败: "+s.message)}finally{A.value=!1}}}function Ue(){P.value=null,L.value=[],se.value=!1}function je(s){f.value=s,E.value="",r.value=null,X.value=!0}async function Ge(){if(!_.category||!_.item||!_.description){p.warning("请填写必填字段");return}A.value=!0;try{f.value?(await C.updateLibraryStandard(f.value.id,_),p.success("更新成功")):(await C.createLibraryStandard(_),p.success("添加成功")),Q.value=!1,Se(),$(),B(),q()}catch(s){p.error("保存失败: "+s.message)}finally{A.value=!1}}async function Ne(s){try{await il.confirm(`确定要删除标准「${s.item}」吗？`,"确认删除",{type:"warning"}),await C.deleteLibraryStandard(s.id),p.success("删除成功"),$(),B(),q()}catch(e){e!=="cancel"&&p.error("删除失败: "+e.message)}}function Se(){Object.assign(_,{category:"",item:"",description:"",risk_level:"medium",applicable_to:["contract","marketing"],usage_instruction:""})}function ze(){f.value=null,E.value="",r.value=null}async function Oe(){if(!(!E.value.trim()||!f.value)){me.value=!0;try{const s=await C.aiModifyStandard(f.value.id,E.value);r.value=s.data.modified_standard,p.success("AI 已生成修改建议，请确认")}catch(s){p.error("AI 修改失败: "+s.message)}finally{me.value=!1}}}async function Ke(){if(!(!r.value||!f.value)){A.value=!0;try{await C.updateLibraryStandard(f.value.id,{category:r.value.category,item:r.value.item,description:r.value.description,risk_level:r.value.risk_level,applicable_to:r.value.applicable_to,usage_instruction:r.value.usage_instruction}),p.success("标准已更新"),X.value=!1,ze(),$(),B(),q()}catch(s){p.error("保存失败: "+s.message)}finally{A.value=!1}}}async function He(s){oe.value.push(s.id);try{const e=await C.generateUsageInstruction({standard_ids:[s.id]});e.data.success_count>0?(s.usage_instruction=e.data.results[0].usage_instruction,p.success("生成成功")):p.error("生成失败: "+e.data.errors[0])}catch(e){p.error("生成失败: "+e.message)}finally{oe.value=oe.value.filter(e=>e!==s.id)}}async function Je(){try{window.open(C.exportLibrary("csv"),"_blank")}catch(s){p.error("导出失败: "+s.message)}}return Ye(()=>{$(),B(),q()}),(s,e)=>{const g=c("el-icon"),m=c("el-button"),I=c("el-card"),y=c("el-input"),w=c("el-option"),G=c("el-select"),V=c("el-table-column"),N=c("el-tag"),fe=c("el-table"),We=c("el-upload"),_e=c("el-alert"),O=c("el-checkbox"),ue=c("el-dialog"),b=c("el-form-item"),ge=c("el-checkbox-group"),ye=c("el-form"),be=c("el-step"),Pe=c("el-steps"),Ve=c("el-radio"),Qe=c("el-radio-group"),S=c("el-descriptions-item"),$e=c("el-descriptions"),Xe=Ze("loading");return v(),k("div",rl,[n("div",pl,[e[37]||(e[37]=n("div",{class:"header-left"},[n("h1",null,"审核标准管理"),n("p",{class:"subtitle"},"管理和维护审核标准库，支持导入、编辑、删除标准")],-1)),n("div",ml,[l(m,{type:"primary",onClick:e[0]||(e[0]=a=>W.value=!0)},{default:t(()=>[l(g,null,{default:t(()=>[l(z(el))]),_:1}),e[35]||(e[35]=o(" 上传标准 ",-1))]),_:1}),l(m,{onClick:Je},{default:t(()=>[l(g,null,{default:t(()=>[l(z(ll))]),_:1}),e[36]||(e[36]=o(" 导出 ",-1))]),_:1})])]),M.value?(v(),k("div",vl,[l(I,{class:"stat-card"},{default:t(()=>[n("div",cl,i(M.value.total),1),e[38]||(e[38]=n("div",{class:"stat-label"},"标准总数",-1))]),_:1}),l(I,{class:"stat-card"},{default:t(()=>{var a;return[n("div",fl,i(((a=M.value.by_risk_level)==null?void 0:a.high)||0),1),e[39]||(e[39]=n("div",{class:"stat-label"},"高风险",-1))]}),_:1}),l(I,{class:"stat-card"},{default:t(()=>{var a;return[n("div",_l,i(((a=M.value.by_risk_level)==null?void 0:a.medium)||0),1),e[40]||(e[40]=n("div",{class:"stat-label"},"中风险",-1))]}),_:1}),l(I,{class:"stat-card"},{default:t(()=>{var a;return[n("div",gl,i(((a=M.value.by_risk_level)==null?void 0:a.low)||0),1),e[41]||(e[41]=n("div",{class:"stat-label"},"低风险",-1))]}),_:1})])):T("",!0),l(I,{class:"filter-card"},{default:t(()=>[n("div",yl,[l(y,{modelValue:ee.value,"onUpdate:modelValue":e[1]||(e[1]=a=>ee.value=a),placeholder:"搜索标准...",clearable:"",style:{width:"300px"},onInput:Me},{prefix:t(()=>[l(g,null,{default:t(()=>[l(z(al))]),_:1})]),_:1},8,["modelValue"]),l(G,{modelValue:le.value,"onUpdate:modelValue":e[2]||(e[2]=a=>le.value=a),placeholder:"选择分类",clearable:"",style:{width:"200px"},onChange:$},{default:t(()=>[(v(!0),k(K,null,ie(ke.value,a=>(v(),F(w,{key:a,label:a,value:a},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),l(G,{modelValue:ae.value,"onUpdate:modelValue":e[3]||(e[3]=a=>ae.value=a),placeholder:"风险等级",clearable:"",style:{width:"150px"},onChange:$},{default:t(()=>[l(w,{label:"高",value:"high"}),l(w,{label:"中",value:"medium"}),l(w,{label:"低",value:"low"})]),_:1},8,["modelValue"]),l(G,{modelValue:te.value,"onUpdate:modelValue":e[4]||(e[4]=a=>te.value=a),placeholder:"适用类型",clearable:"",style:{width:"150px"},onChange:$},{default:t(()=>[l(w,{label:"合同",value:"contract"}),l(w,{label:"营销材料",value:"marketing"})]),_:1},8,["modelValue"]),l(m,{type:"primary",text:"",onClick:e[5]||(e[5]=a=>Q.value=!0)},{default:t(()=>[l(g,null,{default:t(()=>[l(z(tl))]),_:1}),e[42]||(e[42]=o(" 手动添加 ",-1))]),_:1}),l(m,{type:"success",onClick:e[6]||(e[6]=a=>Y.value=!0)},{default:t(()=>[l(g,null,{default:t(()=>[l(z(de))]),_:1}),e[43]||(e[43]=o(" 制作标准 ",-1))]),_:1})])]),_:1}),l(I,{class:"table-card"},{default:t(()=>[sl((v(),F(fe,{data:J.value,stripe:"",style:{width:"100%"}},{default:t(()=>[l(V,{prop:"category",label:"分类",width:"120"}),l(V,{prop:"item",label:"审核要点","min-width":"180"}),l(V,{prop:"description",label:"说明","min-width":"250","show-overflow-tooltip":""}),l(V,{label:"风险等级",width:"100",align:"center"},{default:t(({row:a})=>[l(N,{type:Z(a.risk_level),size:"small"},{default:t(()=>[o(i(R(a.risk_level)),1)]),_:2},1032,["type"])]),_:1}),l(V,{label:"适用类型",width:"120"},{default:t(({row:a})=>[n("span",null,i(j(a.applicable_to)),1)]),_:1}),l(V,{prop:"usage_instruction",label:"适用说明","min-width":"200","show-overflow-tooltip":""},{default:t(({row:a})=>[a.usage_instruction?(v(),k("span",bl,i(a.usage_instruction),1)):(v(),F(m,{key:1,type:"primary",text:"",size:"small",onClick:D=>He(a),loading:oe.value.includes(a.id)},{default:t(()=>[...e[44]||(e[44]=[o(" 生成 ",-1)])]),_:1},8,["onClick","loading"]))]),_:1}),l(V,{label:"操作",width:"150",fixed:"right"},{default:t(({row:a})=>[l(m,{type:"primary",text:"",size:"small",onClick:D=>je(a)},{default:t(()=>[...e[45]||(e[45]=[o(" 编辑 ",-1)])]),_:1},8,["onClick"]),l(m,{type:"danger",text:"",size:"small",onClick:D=>Ne(a)},{default:t(()=>[...e[46]||(e[46]=[o(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[Xe,re.value]]),n("div",Vl,[n("span",null,"共 "+i(J.value.length)+" 条标准",1)])]),_:1}),l(ue,{modelValue:W.value,"onUpdate:modelValue":e[9]||(e[9]=a=>W.value=a),title:"上传审核标准",width:"700px",onClose:Ue},{footer:t(()=>[l(m,{onClick:e[8]||(e[8]=a=>W.value=!1)},{default:t(()=>[...e[50]||(e[50]=[o("取消",-1)])]),_:1}),L.value.length?(v(),F(m,{key:1,type:"primary",onClick:Re,loading:A.value},{default:t(()=>[...e[52]||(e[52]=[o(" 确认入库 ",-1)])]),_:1},8,["loading"])):(v(),F(m,{key:0,type:"primary",onClick:qe,loading:pe.value,disabled:!P.value},{default:t(()=>[...e[51]||(e[51]=[o(" 预览 ",-1)])]),_:1},8,["loading","disabled"]))]),default:t(()=>[L.value.length?(v(),k("div",wl,[l(_e,{type:"success",closable:!1,style:{"margin-bottom":"16px"}},{default:t(()=>[o(" 解析成功，共 "+i(L.value.length)+" 条标准 ",1)]),_:1}),l(fe,{data:L.value,"max-height":"400",size:"small"},{default:t(()=>[l(V,{prop:"category",label:"分类",width:"100"}),l(V,{prop:"item",label:"审核要点",width:"150"}),l(V,{prop:"description",label:"说明","show-overflow-tooltip":""}),l(V,{label:"风险",width:"60"},{default:t(({row:a})=>[o(i(R(a.risk_level)),1)]),_:1})]),_:1},8,["data"]),n("div",xl,[l(O,{modelValue:se.value,"onUpdate:modelValue":e[7]||(e[7]=a=>se.value=a)},{default:t(()=>[...e[49]||(e[49]=[o(" 替换现有标准库（清空后导入） ",-1)])]),_:1},8,["modelValue"])])])):(v(),k("div",kl,[l(We,{ref:"uploadRef",drag:"","auto-upload":!1,"on-change":Be,accept:".xlsx,.xls,.csv,.docx,.md,.txt"},{tip:t(()=>[...e[47]||(e[47]=[n("div",{class:"el-upload__tip"}," 支持 Excel (.xlsx/.xls)、CSV、Word (.docx)、Markdown (.md)、文本 (.txt) 格式 ",-1)])]),default:t(()=>[l(g,{class:"el-icon--upload"},{default:t(()=>[l(z(ol))]),_:1}),e[48]||(e[48]=n("div",{class:"el-upload__text"},[o(" 拖拽文件到此处，或 "),n("em",null,"点击上传")],-1))]),_:1},512)]))]),_:1},8,["modelValue"]),l(ue,{modelValue:Q.value,"onUpdate:modelValue":e[17]||(e[17]=a=>Q.value=a),title:"添加标准",width:"600px",onClose:Se},{footer:t(()=>[l(m,{onClick:e[16]||(e[16]=a=>Q.value=!1)},{default:t(()=>[...e[55]||(e[55]=[o("取消",-1)])]),_:1}),l(m,{type:"primary",onClick:Ge,loading:A.value},{default:t(()=>[...e[56]||(e[56]=[o(" 保存 ",-1)])]),_:1},8,["loading"])]),default:t(()=>[l(ye,{model:_,"label-width":"100px"},{default:t(()=>[l(b,{label:"分类",required:""},{default:t(()=>[l(y,{modelValue:_.category,"onUpdate:modelValue":e[10]||(e[10]=a=>_.category=a),placeholder:"如：主体资格、权利义务"},null,8,["modelValue"])]),_:1}),l(b,{label:"审核要点",required:""},{default:t(()=>[l(y,{modelValue:_.item,"onUpdate:modelValue":e[11]||(e[11]=a=>_.item=a),placeholder:"简要描述审核要点"},null,8,["modelValue"])]),_:1}),l(b,{label:"详细说明",required:""},{default:t(()=>[l(y,{modelValue:_.description,"onUpdate:modelValue":e[12]||(e[12]=a=>_.description=a),type:"textarea",rows:3,placeholder:"详细的审核说明"},null,8,["modelValue"])]),_:1}),l(b,{label:"风险等级"},{default:t(()=>[l(G,{modelValue:_.risk_level,"onUpdate:modelValue":e[13]||(e[13]=a=>_.risk_level=a),style:{width:"100%"}},{default:t(()=>[l(w,{label:"高",value:"high"}),l(w,{label:"中",value:"medium"}),l(w,{label:"低",value:"low"})]),_:1},8,["modelValue"])]),_:1}),l(b,{label:"适用类型"},{default:t(()=>[l(ge,{modelValue:_.applicable_to,"onUpdate:modelValue":e[14]||(e[14]=a=>_.applicable_to=a)},{default:t(()=>[l(O,{label:"contract"},{default:t(()=>[...e[53]||(e[53]=[o("合同",-1)])]),_:1}),l(O,{label:"marketing"},{default:t(()=>[...e[54]||(e[54]=[o("营销材料",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(b,{label:"适用说明"},{default:t(()=>[l(y,{modelValue:_.usage_instruction,"onUpdate:modelValue":e[15]||(e[15]=a=>_.usage_instruction=a),type:"textarea",rows:2,placeholder:"可选，说明何时使用该标准"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(ue,{modelValue:Y.value,"onUpdate:modelValue":e[31]||(e[31]=a=>Y.value=a),title:Te.value,width:"900px","close-on-click-modal":!1,onClose:xe},{footer:t(()=>[n("div",Ml,[l(m,{onClick:e[27]||(e[27]=a=>Y.value=!1)},{default:t(()=>[...e[67]||(e[67]=[o("取消",-1)])]),_:1}),U.value===1?(v(),F(m,{key:0,type:"primary",onClick:he,loading:ve.value,disabled:!we.value},{default:t(()=>[l(g,null,{default:t(()=>[l(z(de))]),_:1}),e[68]||(e[68]=o(" 生成标准 ",-1))]),_:1},8,["loading","disabled"])):T("",!0),U.value===2?(v(),k(K,{key:1},[l(m,{onClick:e[28]||(e[28]=a=>U.value=1)},{default:t(()=>[...e[69]||(e[69]=[o("上一步",-1)])]),_:1}),l(m,{type:"primary",onClick:e[29]||(e[29]=a=>U.value=3),disabled:!h.value.length},{default:t(()=>[...e[70]||(e[70]=[o(" 下一步 ",-1)])]),_:1},8,["disabled"])],64)):T("",!0),U.value===3?(v(),k(K,{key:2},[l(m,{onClick:e[30]||(e[30]=a=>U.value=2)},{default:t(()=>[...e[71]||(e[71]=[o("上一步",-1)])]),_:1}),l(m,{type:"primary",onClick:Fe,loading:ce.value},{default:t(()=>[...e[72]||(e[72]=[o(" 确认入库 ",-1)])]),_:1},8,["loading"])],64)):T("",!0)])]),default:t(()=>[l(Pe,{active:U.value-1,"align-center":"",style:{"margin-bottom":"24px"}},{default:t(()=>[l(be,{title:"填写问卷",description:"提供业务信息"}),l(be,{title:"预览编辑",description:"确认生成的标准"}),l(be,{title:"确认入库",description:"保存到标准库"})]),_:1},8,["active"]),U.value===1?(v(),k("div",Cl,[l(ye,{model:u,"label-width":"120px","label-position":"top"},{default:t(()=>[n("div",Ul,[e[60]||(e[60]=n("div",{class:"form-section-title"},[n("span",{class:"required-badge"},"必答"),o(" 基本信息 ")],-1)),l(b,{label:"文档类型",required:""},{default:t(()=>[l(Qe,{modelValue:u.document_type,"onUpdate:modelValue":e[18]||(e[18]=a=>u.document_type=a)},{default:t(()=>[l(Ve,{value:"contract"},{default:t(()=>[...e[57]||(e[57]=[o("合同",-1)])]),_:1}),l(Ve,{value:"marketing"},{default:t(()=>[...e[58]||(e[58]=[o("营销材料",-1)])]),_:1}),l(Ve,{value:"both"},{default:t(()=>[...e[59]||(e[59]=[o("两者都有",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(b,{label:"业务场景描述",required:""},{default:t(()=>[l(y,{modelValue:u.business_scenario,"onUpdate:modelValue":e[19]||(e[19]=a=>u.business_scenario=a),type:"textarea",rows:3,placeholder:"请详细描述您的业务场景，例如：我们是一家软件公司，需要审核与客户签订的SaaS服务协议，主要涉及订阅费用、服务级别承诺、数据安全等条款...",maxlength:"500","show-word-limit":""},null,8,["modelValue"])]),_:1}),l(b,{label:"核心关注点",required:""},{default:t(()=>[n("div",Sl,[l(ge,{modelValue:u.focus_areas,"onUpdate:modelValue":e[20]||(e[20]=a=>u.focus_areas=a)},{default:t(()=>[(v(),k(K,null,ie(Ae,a=>l(O,{key:a,value:a,label:a},null,8,["value","label"])),64))]),_:1},8,["modelValue"]),l(y,{modelValue:u.custom_focus,"onUpdate:modelValue":e[21]||(e[21]=a=>u.custom_focus=a),placeholder:"其他关注点（逗号分隔）",style:{"margin-top":"8px",width:"300px"}},null,8,["modelValue"])])]),_:1})]),n("div",zl,[e[61]||(e[61]=n("div",{class:"form-section-title"},[n("span",{class:"optional-badge"},"选答"),o(" 补充信息（帮助生成更精准的标准） ")],-1)),l(b,{label:"我方角色"},{default:t(()=>[l(y,{modelValue:u.our_role,"onUpdate:modelValue":e[22]||(e[22]=a=>u.our_role=a),placeholder:"例如：甲方/采购方/服务提供方/委托方"},null,8,["modelValue"])]),_:1}),l(b,{label:"所属行业"},{default:t(()=>[n("div",$l,[l(G,{modelValue:u.industry,"onUpdate:modelValue":e[23]||(e[23]=a=>u.industry=a),placeholder:"选择行业",clearable:"",style:{width:"200px"}},{default:t(()=>[(v(),k(K,null,ie(De,a=>l(w,{key:a,label:a,value:a},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),l(y,{modelValue:u.custom_industry,"onUpdate:modelValue":e[24]||(e[24]=a=>u.custom_industry=a),placeholder:"或输入其他行业",style:{width:"200px","margin-left":"12px"}},null,8,["modelValue"])])]),_:1}),l(b,{label:"特殊风险关注"},{default:t(()=>[l(y,{modelValue:u.special_risks,"onUpdate:modelValue":e[25]||(e[25]=a=>u.special_risks=a),type:"textarea",rows:2,placeholder:"如有特殊的风险点需要关注，请在此说明"},null,8,["modelValue"])]),_:1}),l(b,{label:"参考材料"},{default:t(()=>[l(y,{modelValue:u.reference_material,"onUpdate:modelValue":e[26]||(e[26]=a=>u.reference_material=a),type:"textarea",rows:4,placeholder:"粘贴相关的法规条文、行业规范、已有合同模板等作为参考"},null,8,["modelValue"])]),_:1})])]),_:1},8,["model"])])):T("",!0),U.value===2?(v(),k("div",Il,[ne.value?(v(),F(_e,{key:0,type:"success",closable:!1,style:{"margin-bottom":"16px"}},{default:t(()=>[o(i(ne.value),1)]),_:1})):T("",!0),l(fe,{data:h.value,border:"",size:"small","max-height":"400"},{default:t(()=>[l(V,{type:"expand"},{default:t(({row:a,$index:D})=>[n("div",Ll,[l(ye,{"label-width":"80px",size:"small"},{default:t(()=>[l(b,{label:"分类"},{default:t(()=>[l(y,{modelValue:a.category,"onUpdate:modelValue":x=>a.category=x},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(b,{label:"审核要点"},{default:t(()=>[l(y,{modelValue:a.item,"onUpdate:modelValue":x=>a.item=x},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(b,{label:"详细说明"},{default:t(()=>[l(y,{modelValue:a.description,"onUpdate:modelValue":x=>a.description=x,type:"textarea",rows:2},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(b,{label:"风险等级"},{default:t(()=>[l(G,{modelValue:a.risk_level,"onUpdate:modelValue":x=>a.risk_level=x},{default:t(()=>[l(w,{label:"高",value:"high"}),l(w,{label:"中",value:"medium"}),l(w,{label:"低",value:"low"})]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(b,{label:"适用类型"},{default:t(()=>[l(ge,{modelValue:a.applicable_to,"onUpdate:modelValue":x=>a.applicable_to=x},{default:t(()=>[l(O,{label:"contract",value:"contract"},{default:t(()=>[...e[62]||(e[62]=[o("合同",-1)])]),_:1}),l(O,{label:"marketing",value:"marketing"},{default:t(()=>[...e[63]||(e[63]=[o("营销材料",-1)])]),_:1})]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(b,{label:"适用说明"},{default:t(()=>[l(y,{modelValue:a.usage_instruction,"onUpdate:modelValue":x=>a.usage_instruction=x,type:"textarea",rows:2},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),n("div",Al,[l(m,{type:"danger",size:"small",onClick:x=>Ee(D)},{default:t(()=>[...e[64]||(e[64]=[o(" 删除此标准 ",-1)])]),_:1},8,["onClick"])])])]),_:1}),l(V,{prop:"category",label:"分类",width:"100"}),l(V,{prop:"item",label:"审核要点",width:"150"}),l(V,{prop:"description",label:"说明","show-overflow-tooltip":""}),l(V,{label:"风险",width:"60",align:"center"},{default:t(({row:a})=>[l(N,{type:Z(a.risk_level),size:"small"},{default:t(()=>[o(i(R(a.risk_level)),1)]),_:2},1032,["type"])]),_:1}),l(V,{label:"适用",width:"80"},{default:t(({row:a})=>[o(i(j(a.applicable_to)),1)]),_:1})]),_:1},8,["data"]),n("div",Dl,[l(g,null,{default:t(()=>[l(z(nl))]),_:1}),e[65]||(e[65]=o(" 点击行左侧展开按钮可编辑标准详情 ",-1))])])):T("",!0),U.value===3?(v(),k("div",Tl,[l(_e,{type:"info",closable:!1,style:{"margin-bottom":"16px"}},{default:t(()=>[...e[66]||(e[66]=[o(" 请确认每条标准的适用说明，适用说明将帮助审阅时判断该标准是否适用于当前文档。 ",-1)])]),_:1}),n("div",hl,[(v(!0),k(K,null,ie(h.value,(a,D)=>(v(),k("div",{key:D,class:"usage-item"},[n("div",El,[l(N,{type:Z(a.risk_level),size:"small"},{default:t(()=>[o(i(R(a.risk_level)),1)]),_:2},1032,["type"]),n("span",Fl,i(a.category)+" - "+i(a.item),1)]),l(y,{modelValue:a.usage_instruction,"onUpdate:modelValue":x=>a.usage_instruction=x,type:"textarea",rows:2,placeholder:"说明该标准适用的条件，例如：适用于涉及支付条款的合同"},null,8,["modelValue","onUpdate:modelValue"])]))),128))])])):T("",!0)]),_:1},8,["modelValue","title"]),l(ue,{modelValue:X.value,"onUpdate:modelValue":e[34]||(e[34]=a=>X.value=a),title:"编辑标准",width:"800px",onClose:ze},{footer:t(()=>[l(m,{onClick:e[33]||(e[33]=a=>X.value=!1)},{default:t(()=>[...e[77]||(e[77]=[o("取消",-1)])]),_:1}),l(m,{type:"primary",onClick:Ke,loading:A.value,disabled:!r.value},{default:t(()=>[...e[78]||(e[78]=[o(" 确认修改 ",-1)])]),_:1},8,["loading","disabled"])]),default:t(()=>[n("div",Bl,[n("div",ql,[e[73]||(e[73]=n("div",{class:"section-title"},"当前标准",-1)),l($e,{column:2,border:"",size:"small"},{default:t(()=>[l(S,{label:"分类"},{default:t(()=>{var a;return[o(i((a=f.value)==null?void 0:a.category),1)]}),_:1}),l(S,{label:"风险等级"},{default:t(()=>{var a;return[l(N,{type:Z((a=f.value)==null?void 0:a.risk_level),size:"small"},{default:t(()=>{var D;return[o(i(R((D=f.value)==null?void 0:D.risk_level)),1)]}),_:1},8,["type"])]}),_:1}),l(S,{label:"审核要点",span:2},{default:t(()=>{var a;return[o(i((a=f.value)==null?void 0:a.item),1)]}),_:1}),l(S,{label:"详细说明",span:2},{default:t(()=>{var a;return[o(i((a=f.value)==null?void 0:a.description),1)]}),_:1}),l(S,{label:"适用类型"},{default:t(()=>{var a;return[o(i(j((a=f.value)==null?void 0:a.applicable_to)),1)]}),_:1}),l(S,{label:"适用说明"},{default:t(()=>{var a;return[o(i(((a=f.value)==null?void 0:a.usage_instruction)||"（无）"),1)]}),_:1})]),_:1})]),n("div",Rl,[n("div",jl,[l(g,null,{default:t(()=>[l(z(de))]),_:1}),e[74]||(e[74]=o(" 告诉 AI 如何修改 ",-1))]),l(y,{modelValue:E.value,"onUpdate:modelValue":e[32]||(e[32]=a=>E.value=a),type:"textarea",rows:3,placeholder:`用自然语言描述您想要的修改，例如：
• 把风险等级提高到高
• 在说明中增加关于违约金比例的要求
• 这个标准只适用于采购合同
• 让描述更加具体，包含具体的检查步骤`},null,8,["modelValue"]),n("div",Gl,[l(m,{type:"primary",onClick:Oe,loading:me.value,disabled:!E.value.trim()},{default:t(()=>[l(g,null,{default:t(()=>[l(z(de))]),_:1}),e[75]||(e[75]=o(" 生成修改建议 ",-1))]),_:1},8,["loading","disabled"])])]),r.value?(v(),k("div",Nl,[n("div",Ol,[l(g,null,{default:t(()=>[l(z(ul))]),_:1}),e[76]||(e[76]=o(" AI 修改建议 ",-1)),l(N,{type:"info",size:"small",style:{"margin-left":"8px"}},{default:t(()=>[o(i(r.value.modification_summary),1)]),_:1})]),l($e,{column:2,border:"",size:"small"},{default:t(()=>[l(S,{label:"分类"},{default:t(()=>{var a;return[n("span",{class:H({changed:r.value.category!==((a=f.value)==null?void 0:a.category)})},i(r.value.category),3)]}),_:1}),l(S,{label:"风险等级"},{default:t(()=>{var a;return[l(N,{type:Z(r.value.risk_level),size:"small",class:H({changed:r.value.risk_level!==((a=f.value)==null?void 0:a.risk_level)})},{default:t(()=>[o(i(R(r.value.risk_level)),1)]),_:1},8,["type","class"])]}),_:1}),l(S,{label:"审核要点",span:2},{default:t(()=>{var a;return[n("span",{class:H({changed:r.value.item!==((a=f.value)==null?void 0:a.item)})},i(r.value.item),3)]}),_:1}),l(S,{label:"详细说明",span:2},{default:t(()=>{var a;return[n("span",{class:H({changed:r.value.description!==((a=f.value)==null?void 0:a.description)})},i(r.value.description),3)]}),_:1}),l(S,{label:"适用类型"},{default:t(()=>{var a;return[n("span",{class:H({changed:j(r.value.applicable_to)!==j((a=f.value)==null?void 0:a.applicable_to)})},i(j(r.value.applicable_to)),3)]}),_:1}),l(S,{label:"适用说明"},{default:t(()=>{var a;return[n("span",{class:H({changed:r.value.usage_instruction!==((a=f.value)==null?void 0:a.usage_instruction)})},i(r.value.usage_instruction||"（无）"),3)]}),_:1})]),_:1})])):T("",!0)])]),_:1},8,["modelValue"])])}}},Pl=dl(Kl,[["__scopeId","data-v-78f5f9f1"]]);export{Pl as default};
