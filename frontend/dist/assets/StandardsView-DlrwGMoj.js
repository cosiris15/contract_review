import{r as d,C as Ae,c as De,o as tl,b as p,A as sl,d as k,e as c,h as n,g as A,i as l,w as t,j as o,k as S,D as Te,G as ol,H as nl,I as de,J as ul,t as i,z as il,F as H,m as re,f as M,x as dl,K as rl,L as pl,M as ml,v as J,E as m,p as vl}from"./index-3m3pyuBw.js";import{_ as cl,a as x}from"./_plugin-vue_export-helper-CVWIpMOU.js";const fl={class:"standards-view"},_l={class:"page-header"},gl={class:"header-actions"},yl={key:0,class:"stats-row"},bl={class:"stat-value"},Vl={class:"stat-value high"},kl={class:"stat-value medium"},wl={class:"stat-value low"},xl={class:"filter-row"},Cl={key:0},Ul={class:"table-footer"},Sl={key:0},zl={key:1},Il={style:{"margin-top":"16px"}},hl={key:0,class:"create-step-content"},Ll={class:"form-section"},$l={class:"focus-area-selector"},Al={class:"form-section"},Dl={class:"industry-selector"},Tl={key:1,class:"create-step-content"},Ml={class:"expand-edit-form"},El={class:"expand-actions"},Fl={class:"step2-tip"},Bl={key:2,class:"create-step-content"},ql={class:"usage-instruction-list"},Nl={class:"usage-item-header"},Rl={class:"usage-item-title"},jl={class:"create-dialog-footer"},Gl={class:"ai-edit-container"},Ol={class:"current-standard"},Kl={class:"ai-input-section"},Hl={class:"section-title"},Jl={class:"ai-input-actions"},Wl={key:0,class:"ai-result-section"},Pl={class:"section-title"},Ql={__name:"StandardsView",setup(Xl){const pe=d(!1),W=d([]),E=d(null),Ce=d([]),le=d(""),ae=d(""),te=d(""),se=d(""),P=d(!1),Q=d(null),h=d([]),me=d(!1),L=d(!1),oe=d(!1),X=d(!1),g=Ae({category:"",item:"",description:"",risk_level:"medium",applicable_to:["contract","marketing"],usage_instruction:""}),Y=d(!1),f=d(null),T=d(""),ve=d(!1),r=d(null),ne=d([]),Z=d(!1),C=d(1),ce=d(!1),fe=d(!1),u=Ae({document_type:"contract",business_scenario:"",focus_areas:[],our_role:"",industry:"",special_risks:"",reference_material:"",custom_focus:"",custom_industry:""}),D=d([]),ue=d(""),Me=["合同主体资格","权利义务条款","费用与支付","违约责任","知识产权","保密条款","争议解决","合规性要求"],Ee=["信息技术/互联网","金融/保险","制造业","房地产/建筑","医疗/生物","零售/消费"],Fe=De(()=>["制作审核标准","预览编辑标准","确认入库"][C.value-1]),Ue=De(()=>u.business_scenario.trim()&&(u.focus_areas.length>0||u.custom_focus.trim()));async function Be(){var s,e;if(!Ue.value){m.warning("请填写业务场景和至少一个关注点");return}ce.value=!0;try{const _=[...u.focus_areas];if(u.custom_focus.trim()){const _e=u.custom_focus.split(/[,，、]/).map(ge=>ge.trim()).filter(Boolean);_.push(..._e)}const v=u.custom_industry.trim()||u.industry,R=await x.createStandardsFromBusiness({document_type:u.document_type,business_scenario:u.business_scenario,focus_areas:_,our_role:u.our_role||null,industry:v||null,special_risks:u.special_risks||null,reference_material:u.reference_material||null});D.value=R.data.standards,ue.value=R.data.generation_summary||`成功生成 ${R.data.standards.length} 条标准`,C.value=2,m.success("标准生成成功")}catch(_){m.error("生成标准失败: "+(((e=(s=_.response)==null?void 0:s.data)==null?void 0:e.detail)||_.message))}finally{ce.value=!1}}function qe(s){D.value.splice(s,1)}async function Ne(){if(!D.value.length){m.warning("没有可保存的标准");return}fe.value=!0;try{const s=await x.saveToLibrary({standards:D.value,replace:!1});m.success(s.data.message||"标准保存成功"),Z.value=!1,Se(),I(),F(),B()}catch(s){m.error("保存失败: "+s.message)}finally{fe.value=!1}}function Se(){C.value=1,Object.assign(u,{document_type:"contract",business_scenario:"",focus_areas:[],our_role:"",industry:"",special_risks:"",reference_material:"",custom_focus:"",custom_industry:""}),D.value=[],ue.value=""}async function I(){pe.value=!0;try{const s={};ae.value&&(s.category=ae.value),se.value&&(s.material_type=se.value),le.value&&(s.keyword=le.value);const e=await x.getLibraryStandards(s);W.value=e.data,te.value&&(W.value=W.value.filter(_=>_.risk_level===te.value))}catch(s){m.error("加载标准失败: "+s.message)}finally{pe.value=!1}}async function F(){try{const s=await x.getLibraryStats();E.value=s.data}catch(s){console.error("加载统计失败:",s)}}async function B(){try{const s=await x.getLibraryCategories();Ce.value=s.data.categories}catch(s){console.error("加载分类失败:",s)}}let ze=null;function Re(){clearTimeout(ze),ze=setTimeout(()=>{I()},300)}function ee(s){return{high:"danger",medium:"warning",low:"success"}[s]||"info"}function q(s){return{high:"高",medium:"中",low:"低"}[s]||s}function N(s){return s?s.map(e=>e==="contract"?"合同":"营销").join("、"):""}function je(s){Q.value=s.raw,h.value=[]}async function Ge(){if(Q.value){me.value=!0;try{const s=await x.previewStandards(Q.value);h.value=s.data.standards,m.success(`解析成功，共 ${s.data.total_count} 条标准`)}catch(s){m.error("解析失败: "+s.message)}finally{me.value=!1}}}async function Oe(){if(h.value.length){L.value=!0;try{const s=await x.saveToLibrary({standards:h.value,replace:oe.value});m.success(s.data.message),P.value=!1,Ie(),I(),F(),B()}catch(s){m.error("保存失败: "+s.message)}finally{L.value=!1}}}function Ie(){Q.value=null,h.value=[],oe.value=!1}function Ke(s){f.value=s,T.value="",r.value=null,Y.value=!0}async function He(){if(!g.category||!g.item||!g.description){m.warning("请填写必填字段");return}L.value=!0;try{f.value?(await x.updateLibraryStandard(f.value.id,g),m.success("更新成功")):(await x.createLibraryStandard(g),m.success("添加成功")),X.value=!1,he(),I(),F(),B()}catch(s){m.error("保存失败: "+s.message)}finally{L.value=!1}}async function Je(s){try{await vl.confirm(`确定要删除标准「${s.item}」吗？`,"确认删除",{type:"warning"}),await x.deleteLibraryStandard(s.id),m.success("删除成功"),I(),F(),B()}catch(e){e!=="cancel"&&m.error("删除失败: "+e.message)}}function he(){Object.assign(g,{category:"",item:"",description:"",risk_level:"medium",applicable_to:["contract","marketing"],usage_instruction:""})}function Le(){f.value=null,T.value="",r.value=null}async function We(){if(!(!T.value.trim()||!f.value)){ve.value=!0;try{const s=await x.aiModifyStandard(f.value.id,T.value);r.value=s.data.modified_standard,m.success("AI 已生成修改建议，请确认")}catch(s){m.error("AI 修改失败: "+s.message)}finally{ve.value=!1}}}async function Pe(){if(!(!r.value||!f.value)){L.value=!0;try{await x.updateLibraryStandard(f.value.id,{category:r.value.category,item:r.value.item,description:r.value.description,risk_level:r.value.risk_level,applicable_to:r.value.applicable_to,usage_instruction:r.value.usage_instruction}),m.success("标准已更新"),Y.value=!1,Le(),I(),F(),B()}catch(s){m.error("保存失败: "+s.message)}finally{L.value=!1}}}async function Qe(s){ne.value.push(s.id);try{const e=await x.generateUsageInstruction({standard_ids:[s.id]});e.data.success_count>0?(s.usage_instruction=e.data.results[0].usage_instruction,m.success("生成成功")):m.error("生成失败: "+e.data.errors[0])}catch(e){m.error("生成失败: "+e.message)}finally{ne.value=ne.value.filter(e=>e!==s.id)}}function Xe(s){s==="upload"?P.value=!0:s==="ai"&&(Z.value=!0)}async function Ye(){try{window.open(x.exportLibrary("csv"),"_blank")}catch(s){m.error("导出失败: "+s.message)}}return tl(()=>{I(),F(),B()}),(s,e)=>{const _=p("el-icon"),v=p("el-button"),R=p("el-dropdown-item"),_e=p("el-dropdown-menu"),ge=p("el-dropdown"),j=p("el-card"),b=p("el-input"),U=p("el-option"),G=p("el-select"),V=p("el-table-column"),O=p("el-tag"),ye=p("el-table"),Ze=p("el-upload"),be=p("el-alert"),K=p("el-checkbox"),ie=p("el-dialog"),y=p("el-form-item"),Ve=p("el-checkbox-group"),ke=p("el-form"),we=p("el-step"),el=p("el-steps"),xe=p("el-radio"),ll=p("el-radio-group"),z=p("el-descriptions-item"),$e=p("el-descriptions"),al=sl("loading");return c(),k("div",fl,[n("div",_l,[e[37]||(e[37]=n("div",{class:"header-left"},[n("h1",null,"审核标准管理"),n("p",{class:"subtitle"},"管理和维护审核标准库，支持导入、编辑、删除标准")],-1)),n("div",gl,[l(ge,{trigger:"click",onCommand:Xe},{dropdown:t(()=>[l(_e,null,{default:t(()=>[l(R,{command:"upload"},{default:t(()=>[l(_,null,{default:t(()=>[l(S(nl))]),_:1}),e[34]||(e[34]=o(" 上传新标准（批量） ",-1))]),_:1}),l(R,{command:"ai"},{default:t(()=>[l(_,null,{default:t(()=>[l(S(de))]),_:1}),e[35]||(e[35]=o(" AI辅助制作（批量） ",-1))]),_:1})]),_:1})]),default:t(()=>[l(v,{type:"primary"},{default:t(()=>[l(_,null,{default:t(()=>[l(S(Te))]),_:1}),e[33]||(e[33]=o(" 新建标准 ",-1)),l(_,{class:"el-icon--right"},{default:t(()=>[l(S(ol))]),_:1})]),_:1})]),_:1}),l(v,{onClick:Ye},{default:t(()=>[l(_,null,{default:t(()=>[l(S(ul))]),_:1}),e[36]||(e[36]=o(" 导出 ",-1))]),_:1})])]),E.value?(c(),k("div",yl,[l(j,{class:"stat-card"},{default:t(()=>[n("div",bl,i(E.value.total),1),e[38]||(e[38]=n("div",{class:"stat-label"},"标准总数",-1))]),_:1}),l(j,{class:"stat-card"},{default:t(()=>{var a;return[n("div",Vl,i(((a=E.value.by_risk_level)==null?void 0:a.high)||0),1),e[39]||(e[39]=n("div",{class:"stat-label"},"高风险",-1))]}),_:1}),l(j,{class:"stat-card"},{default:t(()=>{var a;return[n("div",kl,i(((a=E.value.by_risk_level)==null?void 0:a.medium)||0),1),e[40]||(e[40]=n("div",{class:"stat-label"},"中风险",-1))]}),_:1}),l(j,{class:"stat-card"},{default:t(()=>{var a;return[n("div",wl,i(((a=E.value.by_risk_level)==null?void 0:a.low)||0),1),e[41]||(e[41]=n("div",{class:"stat-label"},"低风险",-1))]}),_:1})])):A("",!0),l(j,{class:"filter-card"},{default:t(()=>[n("div",xl,[l(b,{modelValue:le.value,"onUpdate:modelValue":e[0]||(e[0]=a=>le.value=a),placeholder:"搜索标准...",clearable:"",style:{width:"300px"},onInput:Re},{prefix:t(()=>[l(_,null,{default:t(()=>[l(S(il))]),_:1})]),_:1},8,["modelValue"]),l(G,{modelValue:ae.value,"onUpdate:modelValue":e[1]||(e[1]=a=>ae.value=a),placeholder:"选择分类",clearable:"",style:{width:"200px"},onChange:I},{default:t(()=>[(c(!0),k(H,null,re(Ce.value,a=>(c(),M(U,{key:a,label:a,value:a},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),l(G,{modelValue:te.value,"onUpdate:modelValue":e[2]||(e[2]=a=>te.value=a),placeholder:"风险等级",clearable:"",style:{width:"150px"},onChange:I},{default:t(()=>[l(U,{label:"高",value:"high"}),l(U,{label:"中",value:"medium"}),l(U,{label:"低",value:"low"})]),_:1},8,["modelValue"]),l(G,{modelValue:se.value,"onUpdate:modelValue":e[3]||(e[3]=a=>se.value=a),placeholder:"适用类型",clearable:"",style:{width:"150px"},onChange:I},{default:t(()=>[l(U,{label:"合同",value:"contract"}),l(U,{label:"营销材料",value:"marketing"})]),_:1},8,["modelValue"]),l(v,{type:"primary",text:"",onClick:e[4]||(e[4]=a=>X.value=!0)},{default:t(()=>[l(_,null,{default:t(()=>[l(S(Te))]),_:1}),e[42]||(e[42]=o(" 添加单条 ",-1))]),_:1})])]),_:1}),l(j,{class:"table-card"},{default:t(()=>[dl((c(),M(ye,{data:W.value,stripe:"",style:{width:"100%"}},{default:t(()=>[l(V,{prop:"category",label:"分类",width:"120"}),l(V,{prop:"item",label:"审核要点","min-width":"180"}),l(V,{prop:"description",label:"说明","min-width":"250","show-overflow-tooltip":""}),l(V,{label:"风险等级",width:"100",align:"center"},{default:t(({row:a})=>[l(O,{type:ee(a.risk_level),size:"small"},{default:t(()=>[o(i(q(a.risk_level)),1)]),_:2},1032,["type"])]),_:1}),l(V,{label:"适用类型",width:"120"},{default:t(({row:a})=>[n("span",null,i(N(a.applicable_to)),1)]),_:1}),l(V,{prop:"usage_instruction",label:"适用说明","min-width":"200","show-overflow-tooltip":""},{default:t(({row:a})=>[a.usage_instruction?(c(),k("span",Cl,i(a.usage_instruction),1)):(c(),M(v,{key:1,type:"primary",text:"",size:"small",onClick:$=>Qe(a),loading:ne.value.includes(a.id)},{default:t(()=>[...e[43]||(e[43]=[o(" 生成 ",-1)])]),_:1},8,["onClick","loading"]))]),_:1}),l(V,{label:"操作",width:"150",fixed:"right"},{default:t(({row:a})=>[l(v,{type:"primary",text:"",size:"small",onClick:$=>Ke(a)},{default:t(()=>[...e[44]||(e[44]=[o(" 编辑 ",-1)])]),_:1},8,["onClick"]),l(v,{type:"danger",text:"",size:"small",onClick:$=>Je(a)},{default:t(()=>[...e[45]||(e[45]=[o(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[al,pe.value]]),n("div",Ul,[n("span",null,"共 "+i(W.value.length)+" 条标准",1)])]),_:1}),l(ie,{modelValue:P.value,"onUpdate:modelValue":e[7]||(e[7]=a=>P.value=a),title:"上传审核标准",width:"700px",onClose:Ie},{footer:t(()=>[l(v,{onClick:e[6]||(e[6]=a=>P.value=!1)},{default:t(()=>[...e[49]||(e[49]=[o("取消",-1)])]),_:1}),h.value.length?(c(),M(v,{key:1,type:"primary",onClick:Oe,loading:L.value},{default:t(()=>[...e[51]||(e[51]=[o(" 确认入库 ",-1)])]),_:1},8,["loading"])):(c(),M(v,{key:0,type:"primary",onClick:Ge,loading:me.value,disabled:!Q.value},{default:t(()=>[...e[50]||(e[50]=[o(" 预览 ",-1)])]),_:1},8,["loading","disabled"]))]),default:t(()=>[h.value.length?(c(),k("div",zl,[l(be,{type:"success",closable:!1,style:{"margin-bottom":"16px"}},{default:t(()=>[o(" 解析成功，共 "+i(h.value.length)+" 条标准 ",1)]),_:1}),l(ye,{data:h.value,"max-height":"400",size:"small"},{default:t(()=>[l(V,{prop:"category",label:"分类",width:"100"}),l(V,{prop:"item",label:"审核要点",width:"150"}),l(V,{prop:"description",label:"说明","show-overflow-tooltip":""}),l(V,{label:"风险",width:"60"},{default:t(({row:a})=>[o(i(q(a.risk_level)),1)]),_:1})]),_:1},8,["data"]),n("div",Il,[l(K,{modelValue:oe.value,"onUpdate:modelValue":e[5]||(e[5]=a=>oe.value=a)},{default:t(()=>[...e[48]||(e[48]=[o(" 替换现有标准库（清空后导入） ",-1)])]),_:1},8,["modelValue"])])])):(c(),k("div",Sl,[l(Ze,{ref:"uploadRef",drag:"","auto-upload":!1,"on-change":je,accept:".xlsx,.xls,.csv,.docx,.md,.txt"},{tip:t(()=>[...e[46]||(e[46]=[n("div",{class:"el-upload__tip"}," 支持 Excel (.xlsx/.xls)、CSV、Word (.docx)、Markdown (.md)、文本 (.txt) 格式 ",-1)])]),default:t(()=>[l(_,{class:"el-icon--upload"},{default:t(()=>[l(S(rl))]),_:1}),e[47]||(e[47]=n("div",{class:"el-upload__text"},[o(" 拖拽文件到此处，或 "),n("em",null,"点击上传")],-1))]),_:1},512)]))]),_:1},8,["modelValue"]),l(ie,{modelValue:X.value,"onUpdate:modelValue":e[15]||(e[15]=a=>X.value=a),title:"添加标准",width:"600px",onClose:he},{footer:t(()=>[l(v,{onClick:e[14]||(e[14]=a=>X.value=!1)},{default:t(()=>[...e[54]||(e[54]=[o("取消",-1)])]),_:1}),l(v,{type:"primary",onClick:He,loading:L.value},{default:t(()=>[...e[55]||(e[55]=[o(" 保存 ",-1)])]),_:1},8,["loading"])]),default:t(()=>[l(ke,{model:g,"label-width":"100px"},{default:t(()=>[l(y,{label:"分类",required:""},{default:t(()=>[l(b,{modelValue:g.category,"onUpdate:modelValue":e[8]||(e[8]=a=>g.category=a),placeholder:"如：主体资格、权利义务"},null,8,["modelValue"])]),_:1}),l(y,{label:"审核要点",required:""},{default:t(()=>[l(b,{modelValue:g.item,"onUpdate:modelValue":e[9]||(e[9]=a=>g.item=a),placeholder:"简要描述审核要点"},null,8,["modelValue"])]),_:1}),l(y,{label:"详细说明",required:""},{default:t(()=>[l(b,{modelValue:g.description,"onUpdate:modelValue":e[10]||(e[10]=a=>g.description=a),type:"textarea",rows:3,placeholder:"详细的审核说明"},null,8,["modelValue"])]),_:1}),l(y,{label:"风险等级"},{default:t(()=>[l(G,{modelValue:g.risk_level,"onUpdate:modelValue":e[11]||(e[11]=a=>g.risk_level=a),style:{width:"100%"}},{default:t(()=>[l(U,{label:"高",value:"high"}),l(U,{label:"中",value:"medium"}),l(U,{label:"低",value:"low"})]),_:1},8,["modelValue"])]),_:1}),l(y,{label:"适用类型"},{default:t(()=>[l(Ve,{modelValue:g.applicable_to,"onUpdate:modelValue":e[12]||(e[12]=a=>g.applicable_to=a)},{default:t(()=>[l(K,{label:"contract"},{default:t(()=>[...e[52]||(e[52]=[o("合同",-1)])]),_:1}),l(K,{label:"marketing"},{default:t(()=>[...e[53]||(e[53]=[o("营销材料",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(y,{label:"适用说明"},{default:t(()=>[l(b,{modelValue:g.usage_instruction,"onUpdate:modelValue":e[13]||(e[13]=a=>g.usage_instruction=a),type:"textarea",rows:2,placeholder:"可选，说明何时使用该标准"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(ie,{modelValue:Z.value,"onUpdate:modelValue":e[29]||(e[29]=a=>Z.value=a),title:Fe.value,width:"900px","close-on-click-modal":!1,onClose:Se},{footer:t(()=>[n("div",jl,[l(v,{onClick:e[25]||(e[25]=a=>Z.value=!1)},{default:t(()=>[...e[66]||(e[66]=[o("取消",-1)])]),_:1}),C.value===1?(c(),M(v,{key:0,type:"primary",onClick:Be,loading:ce.value,disabled:!Ue.value},{default:t(()=>[l(_,null,{default:t(()=>[l(S(de))]),_:1}),e[67]||(e[67]=o(" 生成标准 ",-1))]),_:1},8,["loading","disabled"])):A("",!0),C.value===2?(c(),k(H,{key:1},[l(v,{onClick:e[26]||(e[26]=a=>C.value=1)},{default:t(()=>[...e[68]||(e[68]=[o("上一步",-1)])]),_:1}),l(v,{type:"primary",onClick:e[27]||(e[27]=a=>C.value=3),disabled:!D.value.length},{default:t(()=>[...e[69]||(e[69]=[o(" 下一步 ",-1)])]),_:1},8,["disabled"])],64)):A("",!0),C.value===3?(c(),k(H,{key:2},[l(v,{onClick:e[28]||(e[28]=a=>C.value=2)},{default:t(()=>[...e[70]||(e[70]=[o("上一步",-1)])]),_:1}),l(v,{type:"primary",onClick:Ne,loading:fe.value},{default:t(()=>[...e[71]||(e[71]=[o(" 确认入库 ",-1)])]),_:1},8,["loading"])],64)):A("",!0)])]),default:t(()=>[l(el,{active:C.value-1,"align-center":"",style:{"margin-bottom":"24px"}},{default:t(()=>[l(we,{title:"填写问卷",description:"提供业务信息"}),l(we,{title:"预览编辑",description:"确认生成的标准"}),l(we,{title:"确认入库",description:"保存到标准库"})]),_:1},8,["active"]),C.value===1?(c(),k("div",hl,[l(ke,{model:u,"label-width":"120px","label-position":"top"},{default:t(()=>[n("div",Ll,[e[59]||(e[59]=n("div",{class:"form-section-title"},[n("span",{class:"required-badge"},"必答"),o(" 基本信息 ")],-1)),l(y,{label:"文档类型",required:""},{default:t(()=>[l(ll,{modelValue:u.document_type,"onUpdate:modelValue":e[16]||(e[16]=a=>u.document_type=a)},{default:t(()=>[l(xe,{value:"contract"},{default:t(()=>[...e[56]||(e[56]=[o("合同",-1)])]),_:1}),l(xe,{value:"marketing"},{default:t(()=>[...e[57]||(e[57]=[o("营销材料",-1)])]),_:1}),l(xe,{value:"both"},{default:t(()=>[...e[58]||(e[58]=[o("两者都有",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(y,{label:"业务场景描述",required:""},{default:t(()=>[l(b,{modelValue:u.business_scenario,"onUpdate:modelValue":e[17]||(e[17]=a=>u.business_scenario=a),type:"textarea",rows:3,placeholder:"请详细描述您的业务场景，例如：我们是一家软件公司，需要审核与客户签订的SaaS服务协议，主要涉及订阅费用、服务级别承诺、数据安全等条款...",maxlength:"500","show-word-limit":""},null,8,["modelValue"])]),_:1}),l(y,{label:"核心关注点",required:""},{default:t(()=>[n("div",$l,[l(Ve,{modelValue:u.focus_areas,"onUpdate:modelValue":e[18]||(e[18]=a=>u.focus_areas=a)},{default:t(()=>[(c(),k(H,null,re(Me,a=>l(K,{key:a,value:a,label:a},null,8,["value","label"])),64))]),_:1},8,["modelValue"]),l(b,{modelValue:u.custom_focus,"onUpdate:modelValue":e[19]||(e[19]=a=>u.custom_focus=a),placeholder:"其他关注点（逗号分隔）",style:{"margin-top":"8px",width:"300px"}},null,8,["modelValue"])])]),_:1})]),n("div",Al,[e[60]||(e[60]=n("div",{class:"form-section-title"},[n("span",{class:"optional-badge"},"选答"),o(" 补充信息（帮助生成更精准的标准） ")],-1)),l(y,{label:"我方角色"},{default:t(()=>[l(b,{modelValue:u.our_role,"onUpdate:modelValue":e[20]||(e[20]=a=>u.our_role=a),placeholder:"例如：甲方/采购方/服务提供方/委托方"},null,8,["modelValue"])]),_:1}),l(y,{label:"所属行业"},{default:t(()=>[n("div",Dl,[l(G,{modelValue:u.industry,"onUpdate:modelValue":e[21]||(e[21]=a=>u.industry=a),placeholder:"选择行业",clearable:"",style:{width:"200px"}},{default:t(()=>[(c(),k(H,null,re(Ee,a=>l(U,{key:a,label:a,value:a},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),l(b,{modelValue:u.custom_industry,"onUpdate:modelValue":e[22]||(e[22]=a=>u.custom_industry=a),placeholder:"或输入其他行业",style:{width:"200px","margin-left":"12px"}},null,8,["modelValue"])])]),_:1}),l(y,{label:"特殊风险关注"},{default:t(()=>[l(b,{modelValue:u.special_risks,"onUpdate:modelValue":e[23]||(e[23]=a=>u.special_risks=a),type:"textarea",rows:2,placeholder:"如有特殊的风险点需要关注，请在此说明"},null,8,["modelValue"])]),_:1}),l(y,{label:"参考材料"},{default:t(()=>[l(b,{modelValue:u.reference_material,"onUpdate:modelValue":e[24]||(e[24]=a=>u.reference_material=a),type:"textarea",rows:4,placeholder:"粘贴相关的法规条文、行业规范、已有合同模板等作为参考"},null,8,["modelValue"])]),_:1})])]),_:1},8,["model"])])):A("",!0),C.value===2?(c(),k("div",Tl,[ue.value?(c(),M(be,{key:0,type:"success",closable:!1,style:{"margin-bottom":"16px"}},{default:t(()=>[o(i(ue.value),1)]),_:1})):A("",!0),l(ye,{data:D.value,border:"",size:"small","max-height":"400"},{default:t(()=>[l(V,{type:"expand"},{default:t(({row:a,$index:$})=>[n("div",Ml,[l(ke,{"label-width":"80px",size:"small"},{default:t(()=>[l(y,{label:"分类"},{default:t(()=>[l(b,{modelValue:a.category,"onUpdate:modelValue":w=>a.category=w},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(y,{label:"审核要点"},{default:t(()=>[l(b,{modelValue:a.item,"onUpdate:modelValue":w=>a.item=w},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(y,{label:"详细说明"},{default:t(()=>[l(b,{modelValue:a.description,"onUpdate:modelValue":w=>a.description=w,type:"textarea",rows:2},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(y,{label:"风险等级"},{default:t(()=>[l(G,{modelValue:a.risk_level,"onUpdate:modelValue":w=>a.risk_level=w},{default:t(()=>[l(U,{label:"高",value:"high"}),l(U,{label:"中",value:"medium"}),l(U,{label:"低",value:"low"})]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(y,{label:"适用类型"},{default:t(()=>[l(Ve,{modelValue:a.applicable_to,"onUpdate:modelValue":w=>a.applicable_to=w},{default:t(()=>[l(K,{label:"contract",value:"contract"},{default:t(()=>[...e[61]||(e[61]=[o("合同",-1)])]),_:1}),l(K,{label:"marketing",value:"marketing"},{default:t(()=>[...e[62]||(e[62]=[o("营销材料",-1)])]),_:1})]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(y,{label:"适用说明"},{default:t(()=>[l(b,{modelValue:a.usage_instruction,"onUpdate:modelValue":w=>a.usage_instruction=w,type:"textarea",rows:2},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),n("div",El,[l(v,{type:"danger",size:"small",onClick:w=>qe($)},{default:t(()=>[...e[63]||(e[63]=[o(" 删除此标准 ",-1)])]),_:1},8,["onClick"])])])]),_:1}),l(V,{prop:"category",label:"分类",width:"100"}),l(V,{prop:"item",label:"审核要点",width:"150"}),l(V,{prop:"description",label:"说明","show-overflow-tooltip":""}),l(V,{label:"风险",width:"60",align:"center"},{default:t(({row:a})=>[l(O,{type:ee(a.risk_level),size:"small"},{default:t(()=>[o(i(q(a.risk_level)),1)]),_:2},1032,["type"])]),_:1}),l(V,{label:"适用",width:"80"},{default:t(({row:a})=>[o(i(N(a.applicable_to)),1)]),_:1})]),_:1},8,["data"]),n("div",Fl,[l(_,null,{default:t(()=>[l(S(pl))]),_:1}),e[64]||(e[64]=o(" 点击行左侧展开按钮可编辑标准详情 ",-1))])])):A("",!0),C.value===3?(c(),k("div",Bl,[l(be,{type:"info",closable:!1,style:{"margin-bottom":"16px"}},{default:t(()=>[...e[65]||(e[65]=[o(" 请确认每条标准的适用说明，适用说明将帮助审阅时判断该标准是否适用于当前文档。 ",-1)])]),_:1}),n("div",ql,[(c(!0),k(H,null,re(D.value,(a,$)=>(c(),k("div",{key:$,class:"usage-item"},[n("div",Nl,[l(O,{type:ee(a.risk_level),size:"small"},{default:t(()=>[o(i(q(a.risk_level)),1)]),_:2},1032,["type"]),n("span",Rl,i(a.category)+" - "+i(a.item),1)]),l(b,{modelValue:a.usage_instruction,"onUpdate:modelValue":w=>a.usage_instruction=w,type:"textarea",rows:2,placeholder:"说明该标准适用的条件，例如：适用于涉及支付条款的合同"},null,8,["modelValue","onUpdate:modelValue"])]))),128))])])):A("",!0)]),_:1},8,["modelValue","title"]),l(ie,{modelValue:Y.value,"onUpdate:modelValue":e[32]||(e[32]=a=>Y.value=a),title:"编辑标准",width:"800px",onClose:Le},{footer:t(()=>[l(v,{onClick:e[31]||(e[31]=a=>Y.value=!1)},{default:t(()=>[...e[76]||(e[76]=[o("取消",-1)])]),_:1}),l(v,{type:"primary",onClick:Pe,loading:L.value,disabled:!r.value},{default:t(()=>[...e[77]||(e[77]=[o(" 确认修改 ",-1)])]),_:1},8,["loading","disabled"])]),default:t(()=>[n("div",Gl,[n("div",Ol,[e[72]||(e[72]=n("div",{class:"section-title"},"当前标准",-1)),l($e,{column:2,border:"",size:"small"},{default:t(()=>[l(z,{label:"分类"},{default:t(()=>{var a;return[o(i((a=f.value)==null?void 0:a.category),1)]}),_:1}),l(z,{label:"风险等级"},{default:t(()=>{var a;return[l(O,{type:ee((a=f.value)==null?void 0:a.risk_level),size:"small"},{default:t(()=>{var $;return[o(i(q(($=f.value)==null?void 0:$.risk_level)),1)]}),_:1},8,["type"])]}),_:1}),l(z,{label:"审核要点",span:2},{default:t(()=>{var a;return[o(i((a=f.value)==null?void 0:a.item),1)]}),_:1}),l(z,{label:"详细说明",span:2},{default:t(()=>{var a;return[o(i((a=f.value)==null?void 0:a.description),1)]}),_:1}),l(z,{label:"适用类型"},{default:t(()=>{var a;return[o(i(N((a=f.value)==null?void 0:a.applicable_to)),1)]}),_:1}),l(z,{label:"适用说明"},{default:t(()=>{var a;return[o(i(((a=f.value)==null?void 0:a.usage_instruction)||"（无）"),1)]}),_:1})]),_:1})]),n("div",Kl,[n("div",Hl,[l(_,null,{default:t(()=>[l(S(de))]),_:1}),e[73]||(e[73]=o(" 告诉 AI 如何修改 ",-1))]),l(b,{modelValue:T.value,"onUpdate:modelValue":e[30]||(e[30]=a=>T.value=a),type:"textarea",rows:3,placeholder:`用自然语言描述您想要的修改，例如：
• 把风险等级提高到高
• 在说明中增加关于违约金比例的要求
• 这个标准只适用于采购合同
• 让描述更加具体，包含具体的检查步骤`},null,8,["modelValue"]),n("div",Jl,[l(v,{type:"primary",onClick:We,loading:ve.value,disabled:!T.value.trim()},{default:t(()=>[l(_,null,{default:t(()=>[l(S(de))]),_:1}),e[74]||(e[74]=o(" 生成修改建议 ",-1))]),_:1},8,["loading","disabled"])])]),r.value?(c(),k("div",Wl,[n("div",Pl,[l(_,null,{default:t(()=>[l(S(ml))]),_:1}),e[75]||(e[75]=o(" AI 修改建议 ",-1)),l(O,{type:"info",size:"small",style:{"margin-left":"8px"}},{default:t(()=>[o(i(r.value.modification_summary),1)]),_:1})]),l($e,{column:2,border:"",size:"small"},{default:t(()=>[l(z,{label:"分类"},{default:t(()=>{var a;return[n("span",{class:J({changed:r.value.category!==((a=f.value)==null?void 0:a.category)})},i(r.value.category),3)]}),_:1}),l(z,{label:"风险等级"},{default:t(()=>{var a;return[l(O,{type:ee(r.value.risk_level),size:"small",class:J({changed:r.value.risk_level!==((a=f.value)==null?void 0:a.risk_level)})},{default:t(()=>[o(i(q(r.value.risk_level)),1)]),_:1},8,["type","class"])]}),_:1}),l(z,{label:"审核要点",span:2},{default:t(()=>{var a;return[n("span",{class:J({changed:r.value.item!==((a=f.value)==null?void 0:a.item)})},i(r.value.item),3)]}),_:1}),l(z,{label:"详细说明",span:2},{default:t(()=>{var a;return[n("span",{class:J({changed:r.value.description!==((a=f.value)==null?void 0:a.description)})},i(r.value.description),3)]}),_:1}),l(z,{label:"适用类型"},{default:t(()=>{var a;return[n("span",{class:J({changed:N(r.value.applicable_to)!==N((a=f.value)==null?void 0:a.applicable_to)})},i(N(r.value.applicable_to)),3)]}),_:1}),l(z,{label:"适用说明"},{default:t(()=>{var a;return[n("span",{class:J({changed:r.value.usage_instruction!==((a=f.value)==null?void 0:a.usage_instruction)})},i(r.value.usage_instruction||"（无）"),3)]}),_:1})]),_:1})])):A("",!0)])]),_:1},8,["modelValue"])])}}},ea=cl(Ql,[["__scopeId","data-v-677b8426"]]);export{ea as default};
