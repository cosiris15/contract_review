import{_ as Xe,q as Ye,u as et,r as L,c as U,o as tt,E as O,b as c,D as lt,y as at,d as I,e as y,h as s,i as l,w as a,j as p,t as o,f as P,g as W,F as we,m as ot,x as it}from"./index-BNaM8M1n.js";import{u as st}from"./index-YsGGYywd.js";import{a as G}from"./index-BOy5KFeg.js";const nt={class:"result-view"},ut={class:"result-header"},dt={class:"header-info"},rt={class:"header-meta"},ct={class:"header-actions"},pt={class:"redline-dialog-content"},ft={class:"export-option"},mt={class:"option-header"},_t={class:"option-count"},vt={class:"export-option"},gt={class:"option-header"},yt={key:0,class:"option-count"},bt={class:"stat-value"},ht={class:"stat-label"},xt={class:"stat-detail"},kt={class:"stat-value"},wt={class:"stat-label"},Tt={class:"stat-detail"},Vt={class:"stat-value"},Ct={class:"stat-label"},Rt={class:"stat-detail"},Dt={class:"stat-value"},Et={class:"stat-label"},Mt={class:"stat-detail"},At={class:"text-ellipsis"},Lt={key:1},Ut={class:"modification-list"},St={class:"mod-header"},Ht={class:"mod-reason"},Nt={class:"mod-actions"},It={class:"text-label"},Pt=["innerHTML"],$t={key:1,class:"text-box original"},zt={class:"text-label"},Ot=["innerHTML"],jt={key:1,class:"text-box suggested"},Bt=["innerHTML"],Ft={__name:"ResultView",setup(qt){const Te=Ye(),Ve=et(),J=st(),se=L(!1),_e=L("risks"),R=U(()=>Te.params.taskId),ne=L(!1),w=L(null),K=L(!1),ae=L(!1),Q=L({}),X=L(!1),ue=L(!1),de=L(null),T=L({description:"",action_type:"",urgency:"normal",responsible_party:"",deadline_suggestion:""}),g=U(()=>J.reviewResult),S=U(()=>{var t;return((t=g.value)==null?void 0:t.summary)||{total_risks:0,high_risks:0,medium_risks:0,low_risks:0,total_modifications:0,must_modify:0,should_modify:0,total_actions:0,immediate_actions:0}}),Ce=U(()=>{var t;return((t=g.value)==null?void 0:t.language)||"zh-CN"}),q=U(()=>Ce.value==="en"),i=U(()=>q.value?{materialType:{contract:"Contract",marketing:"Marketing Material"},riskLevel:{high:"High",medium:"Medium",low:"Low"},priority:{must:"Must",should:"Should",may:"May"},urgency:{immediate:"Immediate",soon:"Soon",normal:"Normal"},labels:{back:"Back",reviewResult:"Review Result",ourParty:"Our Party:",reviewTime:"Review Time:",exportRedline:"Export Redline Word",export:"Export",totalRisks:"Total Risks",highRisks:"High Risks",priorityNeeded:"Priority needed",modifications:"Modifications",actions:"Actions",risks:"Risks",highDetail:"H",mediumDetail:"M",lowDetail:"L",mustModify:"must",shouldModify:"should",immediateActions:"immediate",riskLevelCol:"Risk Level",riskType:"Risk Type",riskDescription:"Description",reason:"Reason",originalText:"Original Text",urgencyCol:"Urgency",actionType:"Action Type",specificAction:"Specific Action",responsibleParty:"Responsible Party",deadline:"Deadline",operation:"Operation",confirm:"Confirm",edit:"Edit",currentText:"Current Text",suggestedText:"Suggested Modification",save:"Save",confirmAdopt:"Confirm",diff:"Diff",fullText:"Full",noModifications:"No modification suggestions",noActions:"No action recommendations"}}:{materialType:{contract:"合同",marketing:"营销材料"},riskLevel:{high:"高",medium:"中",low:"低"},priority:{must:"必须",should:"应该",may:"可以"},urgency:{immediate:"立即",soon:"尽快",normal:"一般"},labels:{back:"返回",reviewResult:"审阅结果",ourParty:"我方:",reviewTime:"审阅时间:",exportRedline:"导出修订版 Word",export:"导出",totalRisks:"风险总数",highRisks:"高风险",priorityNeeded:"需优先处理",modifications:"修改建议",actions:"行动建议",risks:"风险点",highDetail:"高",mediumDetail:"中",lowDetail:"低",mustModify:"必须",shouldModify:"应该",immediateActions:"立即处理",riskLevelCol:"风险等级",riskType:"风险类型",riskDescription:"风险描述",reason:"判定理由",originalText:"原文摘录",urgencyCol:"紧急程度",actionType:"行动类型",specificAction:"具体行动",responsibleParty:"负责方",deadline:"建议时限",operation:"操作",confirm:"确认",edit:"编辑",currentText:"当前文本",suggestedText:"建议修改为",save:"保存",confirmAdopt:"确认采纳",diff:"差异",fullText:"全文",noModifications:"无修改建议",noActions:"无行动建议"}}),Re=U(()=>{var e;const t=(e=g.value)==null?void 0:e.material_type;return i.value.materialType[t]||t}),re=U(()=>{var t;return(t=g.value)!=null&&t.modifications?g.value.modifications.filter(e=>e.user_confirmed).length:0}),De=U(()=>{var t;return(t=g.value)!=null&&t.actions?g.value.actions.filter(e=>e.user_confirmed).length:0}),ce=U(()=>{var t;return((t=w.value)==null?void 0:t.commentable_actions)>0}),Ee=U(()=>!(w.value&&!w.value.can_export||re.value===0&&!ce.value));function V(t){var e,m;if(!Q.value[t]){const f=(m=(e=g.value)==null?void 0:e.modifications)==null?void 0:m.find(d=>d.id===t);Q.value[t]={showDiff:!0,isEditing:!1,editText:(f==null?void 0:f.user_modified_text)||(f==null?void 0:f.suggested_text)||""}}return Q.value[t]}function Me(){var t;(t=g.value)!=null&&t.modifications&&g.value.modifications.forEach(e=>{Q.value[e.id]||(Q.value[e.id]={showDiff:!0,isEditing:!1,editText:e.user_modified_text||e.suggested_text||""})})}tt(async()=>{if(R.value){se.value=!0;try{await J.loadResult(R.value),Me(),await oe()}catch{O.error("加载结果失败")}finally{se.value=!1}}});async function oe(){try{const t=await G.getRedlinePreview(R.value);w.value=t.data}catch(t){console.error("获取 Redline 预览失败:",t)}}function Ae(){Ve.push("/")}function Le(t){if(!t)return"-";const e=new Date(t),m=q.value?"en-US":"zh-CN";return e.toLocaleString(m)}function Ue(t){return{high:"danger",medium:"warning",low:"info"}[t]||"info"}function Se(t){return i.value.riskLevel[t]||t}function He(t){return{must:"danger",should:"warning",may:"info"}[t]||"info"}function Ne(t){return i.value.priority[t]||t}function Ie(t){return{immediate:"danger",soon:"warning",normal:"info"}[t]||"info"}function Pe(t){return i.value.urgency[t]||t}function $e(t,e){if(!t||!e)return{originalHtml:t||"",modifiedHtml:e||""};if(t===e)return{originalHtml:t,modifiedHtml:e};const m=r=>{const _=[];let k="",N=null;for(const z of r){const te=/[\u4e00-\u9fa5]/.test(z),C=/[a-zA-Z0-9]/.test(z),fe=/\s/.test(z);let M;te?M="cn":C?M="en":fe?M="space":M="punct",M==="cn"?(k&&_.push(k),_.push(z),k="",N=null):M===N&&M==="en"?k+=z:(k&&_.push(k),k=z,N=M)}return k&&_.push(k),_},f=m(t),d=m(e),b=f.length,H=d.length,D=Array(b+1).fill(null).map(()=>Array(H+1).fill(0));for(let r=1;r<=b;r++)for(let _=1;_<=H;_++)f[r-1]===d[_-1]?D[r][_]=D[r-1][_-1]+1:D[r][_]=Math.max(D[r-1][_],D[r][_-1]);const $=[];let x=b,E=H;for(;x>0&&E>0;)f[x-1]===d[E-1]?($.unshift({origIdx:x-1,modIdx:E-1,token:f[x-1]}),x--,E--):D[x-1][E]>D[x][E-1]?x--:E--;const j=r=>r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");let B="",Y=-1;for(const r of $){for(let _=Y+1;_<r.origIdx;_++)B+=`<del class="diff-del">${j(f[_])}</del>`;B+=j(r.token),Y=r.origIdx}for(let r=Y+1;r<b;r++)B+=`<del class="diff-del">${j(f[r])}</del>`;let Z="",ee=-1;for(const r of $){for(let _=ee+1;_<r.modIdx;_++)Z+=`<ins class="diff-ins">${j(d[_])}</ins>`;Z+=j(r.token),ee=r.modIdx}for(let r=ee+1;r<H;r++)Z+=`<ins class="diff-ins">${j(d[r])}</ins>`;return{originalHtml:B,modifiedHtml:Z}}function pe(t){const e=t.original_text||"",f=V(t.id).editText||t.user_modified_text||t.suggested_text||"";return $e(e,f)}async function ze(t){var m,f;const e=V(t.id);try{await J.updateModification(R.value,t.id,{user_modified_text:e.editText,user_confirmed:!0}),e.isEditing=!1,t.user_confirmed=!0,t.user_modified_text=e.editText,O.success("保存成功"),oe()}catch(d){console.error("保存失败详情:",d),O.error("保存失败: "+(((f=(m=d==null?void 0:d.response)==null?void 0:m.data)==null?void 0:f.detail)||d.message||"请检查网络连接"))}}async function Oe(t,e){try{await J.updateModification(R.value,t.id,e)}catch{O.error("更新失败")}}async function je(t,e){t.user_confirmed=e;try{await J.updateAction(R.value,t.id,e),oe()}catch{t.user_confirmed=!e,O.error("更新失败")}}function Be(t){de.value=t.id,T.value={description:t.description||"",action_type:t.action_type||"",urgency:t.urgency||"normal",responsible_party:t.responsible_party||"",deadline_suggestion:t.deadline_suggestion||""},X.value=!0}async function Fe(){var t,e,m,f;ue.value=!0;try{await J.updateAction(R.value,de.value,{...T.value,user_confirmed:!0});const d=(e=(t=g.value)==null?void 0:t.actions)==null?void 0:e.find(b=>b.id===de.value);d&&(Object.assign(d,T.value),d.user_confirmed=!0),X.value=!1,O.success("保存成功"),oe()}catch(d){console.error("保存失败详情:",d),O.error("保存失败: "+(((f=(m=d==null?void 0:d.response)==null?void 0:m.data)==null?void 0:f.detail)||d.message||"请检查网络连接"))}finally{ue.value=!1}}function qe(t){const m={excel:G.exportExcel(R.value),csv:G.exportCsv(R.value),json:G.exportJson(R.value),report:G.exportReport(R.value)}[t];m&&window.open(m,"_blank")}async function We(){ne.value=!0;try{const t=await G.exportRedline(R.value,null,ae.value),e=t.headers["content-disposition"];let m="document_redline.docx";if(e){const x=e.match(/filename\*=UTF-8''([^;\s]+)/);if(x)m=decodeURIComponent(x[1]);else{const E=e.match(/filename="?([^"]+)"?/);E&&(m=E[1])}}const f=new Blob([t.data],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}),d=window.URL.createObjectURL(f),b=document.createElement("a");b.href=d,b.download=m,document.body.appendChild(b),b.click(),document.body.removeChild(b),window.URL.revokeObjectURL(d);const H=t.headers["x-redline-applied"]||0,D=t.headers["x-comments-added"]||0;let $="导出成功！";H>0&&($+=`已应用 ${H} 条修改`),D>0&&($+=`${H>0?"，":""}添加 ${D} 条批注`),O.success($),K.value=!1}catch(t){console.error("导出 Redline 失败:",t),O.error(t.message||"导出失败，请重试")}finally{ne.value=!1}}return(t,e)=>{var ye,be,he;const m=c("ArrowLeft"),f=c("el-icon"),d=c("el-button"),b=c("el-tag"),H=c("EditPen"),D=c("Download"),$=c("ArrowDown"),x=c("el-dropdown-item"),E=c("el-dropdown-menu"),j=c("el-dropdown"),B=c("el-alert"),Y=c("Document"),Z=c("el-divider"),ee=c("ChatLineSquare"),r=c("el-checkbox"),_=c("el-dialog"),k=c("el-card"),N=c("el-col"),z=c("el-row"),te=c("el-badge"),C=c("el-table-column"),fe=c("el-popover"),M=c("el-table"),me=c("el-tab-pane"),Je=c("el-switch"),ie=c("el-input"),ve=c("el-empty"),Ze=c("el-tabs"),le=c("el-form-item"),F=c("el-option"),ge=c("el-select"),Ge=c("el-form"),Ke=lt("loading");return at((y(),I("div",nt,[s("div",ut,[s("div",dt,[l(d,{text:"",onClick:Ae},{default:a(()=>[l(f,null,{default:a(()=>[l(m)]),_:1}),p(" "+o(i.value.labels.back),1)]),_:1}),s("h2",null,o(((ye=g.value)==null?void 0:ye.document_name)||i.value.labels.reviewResult),1),s("div",rt,[l(b,null,{default:a(()=>[p(o(Re.value),1)]),_:1}),q.value?(y(),P(b,{key:0,type:"success",size:"small"},{default:a(()=>[...e[12]||(e[12]=[p("EN",-1)])]),_:1})):W("",!0),s("span",null,o(i.value.labels.ourParty)+" "+o((be=g.value)==null?void 0:be.our_party),1),s("span",null,o(i.value.labels.reviewTime)+" "+o(Le((he=g.value)==null?void 0:he.reviewed_at)),1)])]),s("div",ct,[l(d,{type:"success",onClick:e[0]||(e[0]=n=>K.value=!0),disabled:!Ee.value},{default:a(()=>[l(f,null,{default:a(()=>[l(H)]),_:1}),p(" "+o(i.value.labels.exportRedline),1)]),_:1},8,["disabled"]),l(j,{onCommand:qe},{dropdown:a(()=>[l(E,null,{default:a(()=>[l(x,{command:"excel"},{default:a(()=>[p(o(q.value?"Export Excel":"导出 Excel"),1)]),_:1}),l(x,{command:"csv"},{default:a(()=>[p(o(q.value?"Export CSV":"导出 CSV"),1)]),_:1}),l(x,{command:"json"},{default:a(()=>[p(o(q.value?"Export JSON":"导出 JSON"),1)]),_:1}),l(x,{command:"report"},{default:a(()=>[p(o(q.value?"Export Report":"导出报告"),1)]),_:1})]),_:1})]),default:a(()=>[l(d,{type:"primary"},{default:a(()=>[l(f,null,{default:a(()=>[l(D)]),_:1}),p(" "+o(i.value.labels.export)+" ",1),l(f,{class:"el-icon--right"},{default:a(()=>[l($)]),_:1})]),_:1})]),_:1})])]),l(_,{modelValue:K.value,"onUpdate:modelValue":e[3]||(e[3]=n=>K.value=n),title:"导出修订版 Word",width:"500px"},{footer:a(()=>[l(d,{onClick:e[2]||(e[2]=n=>K.value=!1)},{default:a(()=>[...e[20]||(e[20]=[p("取消",-1)])]),_:1}),l(d,{type:"primary",onClick:We,loading:ne.value,disabled:re.value===0&&(!ae.value||!ce.value)},{default:a(()=>[...e[21]||(e[21]=[p(" 导出 ",-1)])]),_:1},8,["loading","disabled"])]),default:a(()=>{var n,v,A,u,h,xe,ke;return[s("div",pt,[!((n=w.value)!=null&&n.can_export)&&((v=w.value)!=null&&v.reason)?(y(),P(B,{key:0,title:w.value.reason,type:"warning","show-icon":"",closable:!1,style:{"margin-bottom":"16px"}},null,8,["title"])):W("",!0),s("div",ft,[s("div",mt,[l(f,null,{default:a(()=>[l(Y)]),_:1}),e[13]||(e[13]=s("span",null,"修改建议（修订标记）",-1))]),e[15]||(e[15]=s("div",{class:"option-desc"}," 将已确认的修改建议以删除线和插入标记形式显示 ",-1)),s("div",_t,[e[14]||(e[14]=p(" 已确认 ",-1)),s("strong",null,o(re.value),1),p(" 条 / 共 "+o(((A=w.value)==null?void 0:A.total_modifications)||0)+" 条 ",1)])]),l(Z),s("div",vt,[s("div",gt,[l(r,{modelValue:ae.value,"onUpdate:modelValue":e[1]||(e[1]=Qe=>ae.value=Qe),disabled:!ce.value},{default:a(()=>[l(f,null,{default:a(()=>[l(ee)]),_:1}),e[16]||(e[16]=s("span",null,"行动建议（批注）",-1))]),_:1},8,["modelValue","disabled"])]),e[19]||(e[19]=s("div",{class:"option-desc"}," 将已确认的行动建议作为批注添加到对应风险点的文本位置 ",-1)),w.value?(y(),I("div",yt,[e[17]||(e[17]=p(" 已确认 ",-1)),s("strong",null,o(De.value),1),e[18]||(e[18]=p(" 条，可添加 ",-1)),s("strong",null,o(w.value.commentable_actions||0),1),p(" 条批注 / 共 "+o(w.value.total_actions||0)+" 条行动建议 ",1)])):W("",!0),((u=w.value)==null?void 0:u.confirmed_actions)>0&&((h=w.value)==null?void 0:h.commentable_actions)===0?(y(),P(B,{key:1,title:"已确认的行动建议未关联风险点原文，无法生成批注",type:"info","show-icon":"",closable:!1,style:{"margin-top":"8px"}})):((xe=w.value)==null?void 0:xe.total_actions)>0&&(((ke=w.value)==null?void 0:ke.confirmed_actions)||0)===0?(y(),P(B,{key:2,title:"请先在行动建议列表中勾选确认要导出的建议",type:"info","show-icon":"",closable:!1,style:{"margin-top":"8px"}})):W("",!0)])])]}),_:1},8,["modelValue"]),l(z,{gutter:16,class:"stat-cards"},{default:a(()=>[l(N,{span:6},{default:a(()=>[l(k,{class:"stat-card danger"},{default:a(()=>[s("div",bt,o(S.value.total_risks),1),s("div",ht,o(i.value.labels.totalRisks),1),s("div",xt,o(i.value.labels.highDetail)+" "+o(S.value.high_risks)+" / "+o(i.value.labels.mediumDetail)+" "+o(S.value.medium_risks)+" / "+o(i.value.labels.lowDetail)+" "+o(S.value.low_risks),1)]),_:1})]),_:1}),l(N,{span:6},{default:a(()=>[l(k,{class:"stat-card warning"},{default:a(()=>[s("div",kt,o(S.value.high_risks),1),s("div",wt,o(i.value.labels.highRisks),1),s("div",Tt,o(i.value.labels.priorityNeeded),1)]),_:1})]),_:1}),l(N,{span:6},{default:a(()=>[l(k,{class:"stat-card primary"},{default:a(()=>[s("div",Vt,o(S.value.total_modifications),1),s("div",Ct,o(i.value.labels.modifications),1),s("div",Rt,o(i.value.labels.mustModify)+" "+o(S.value.must_modify)+" / "+o(i.value.labels.shouldModify)+" "+o(S.value.should_modify),1)]),_:1})]),_:1}),l(N,{span:6},{default:a(()=>[l(k,{class:"stat-card success"},{default:a(()=>[s("div",Dt,o(S.value.total_actions),1),s("div",Et,o(i.value.labels.actions),1),s("div",Mt,o(i.value.labels.immediateActions)+" "+o(S.value.immediate_actions),1)]),_:1})]),_:1})]),_:1}),l(k,{class:"content-card"},{default:a(()=>[l(Ze,{modelValue:_e.value,"onUpdate:modelValue":e[4]||(e[4]=n=>_e.value=n)},{default:a(()=>[l(me,{label:i.value.labels.risks,name:"risks"},{label:a(()=>{var n,v;return[s("span",null,[p(o(i.value.labels.risks)+" ",1),l(te,{value:((v=(n=g.value)==null?void 0:n.risks)==null?void 0:v.length)||0,type:"danger"},null,8,["value"])])]}),default:a(()=>{var n;return[l(M,{data:((n=g.value)==null?void 0:n.risks)||[],stripe:"",border:""},{default:a(()=>[l(C,{label:i.value.labels.riskLevelCol,width:"100",align:"center"},{default:a(({row:v})=>[l(b,{type:Ue(v.risk_level)},{default:a(()=>[p(o(Se(v.risk_level)),1)]),_:2},1032,["type"])]),_:1},8,["label"]),l(C,{prop:"risk_type",label:i.value.labels.riskType,width:"120"},null,8,["label"]),l(C,{prop:"description",label:i.value.labels.riskDescription,"min-width":"200"},null,8,["label"]),l(C,{prop:"reason",label:i.value.labels.reason,"min-width":"200"},null,8,["label"]),l(C,{label:i.value.labels.originalText,width:"200"},{default:a(({row:v})=>{var A;return[(A=v.location)!=null&&A.original_text?(y(),P(fe,{key:0,trigger:"hover",width:"400",placement:"top"},{reference:a(()=>[s("span",At,o(v.location.original_text.slice(0,50))+"... ",1)]),default:a(()=>[s("div",null,o(v.location.original_text),1)]),_:2},1024)):(y(),I("span",Lt,"-"))]}),_:1},8,["label"])]),_:1},8,["data"])]}),_:1},8,["label"]),l(me,{label:i.value.labels.modifications,name:"modifications"},{label:a(()=>{var n,v;return[s("span",null,[p(o(i.value.labels.modifications)+" ",1),l(te,{value:((v=(n=g.value)==null?void 0:n.modifications)==null?void 0:v.length)||0,type:"primary"},null,8,["value"])])]}),default:a(()=>{var n,v,A;return[s("div",Ut,[(y(!0),I(we,null,ot(((n=g.value)==null?void 0:n.modifications)||[],u=>(y(),P(k,{key:u.id,class:it(["modification-card",{confirmed:u.user_confirmed}])},{default:a(()=>[s("div",St,[l(b,{type:He(u.priority)},{default:a(()=>[p(o(Ne(u.priority)),1)]),_:2},1032,["type"]),s("span",Ht,o(u.modification_reason),1),s("div",Nt,[l(Je,{modelValue:V(u.id).showDiff,"onUpdate:modelValue":h=>V(u.id).showDiff=h,"active-text":i.value.labels.diff,"inactive-text":i.value.labels.fullText,size:"small",style:{"margin-right":"12px"}},null,8,["modelValue","onUpdate:modelValue","active-text","inactive-text"]),l(r,{modelValue:u.user_confirmed,"onUpdate:modelValue":h=>u.user_confirmed=h,onChange:h=>Oe(u,{user_confirmed:h})},{default:a(()=>[p(o(i.value.labels.confirmAdopt),1)]),_:1},8,["modelValue","onUpdate:modelValue","onChange"])])]),l(z,{gutter:20,class:"mod-content"},{default:a(()=>[l(N,{span:12},{default:a(()=>[s("div",It,o(i.value.labels.currentText),1),V(u.id).showDiff?(y(),I("div",{key:0,class:"text-box diff-view",innerHTML:pe(u).originalHtml},null,8,Pt)):(y(),I("div",$t,o(u.original_text),1))]),_:2},1024),l(N,{span:12},{default:a(()=>[s("div",zt,[p(o(i.value.labels.suggestedText)+" ",1),V(u.id).isEditing?(y(),P(d,{key:1,type:"success",link:"",size:"small",onClick:h=>ze(u)},{default:a(()=>[p(o(i.value.labels.save),1)]),_:1},8,["onClick"])):(y(),P(d,{key:0,type:"primary",link:"",size:"small",onClick:h=>V(u.id).isEditing=!0},{default:a(()=>[p(o(i.value.labels.edit),1)]),_:1},8,["onClick"]))]),V(u.id).showDiff&&!V(u.id).isEditing?(y(),I("div",{key:0,class:"text-box diff-view suggested",innerHTML:pe(u).modifiedHtml},null,8,Ot)):V(u.id).isEditing?(y(),I(we,{key:2},[l(ie,{type:"textarea",rows:4,modelValue:V(u.id).editText,"onUpdate:modelValue":h=>V(u.id).editText=h},null,8,["modelValue","onUpdate:modelValue"]),V(u.id).showDiff?(y(),I("div",{key:0,class:"text-box diff-view suggested preview-box",innerHTML:pe(u).modifiedHtml,style:{"margin-top":"8px",opacity:"0.9","font-size":"12px"}},null,8,Bt)):W("",!0)],64)):(y(),I("div",jt,o(V(u.id).editText||u.suggested_text),1))]),_:2},1024)]),_:2},1024)]),_:2},1032,["class"]))),128)),(A=(v=g.value)==null?void 0:v.modifications)!=null&&A.length?W("",!0):(y(),P(ve,{key:0,description:i.value.labels.noModifications},null,8,["description"]))])]}),_:1},8,["label"]),l(me,{label:i.value.labels.actions,name:"actions"},{label:a(()=>{var n,v;return[s("span",null,[p(o(i.value.labels.actions)+" ",1),l(te,{value:((v=(n=g.value)==null?void 0:n.actions)==null?void 0:v.length)||0,type:"success"},null,8,["value"])])]}),default:a(()=>{var n,v,A;return[l(M,{data:((n=g.value)==null?void 0:n.actions)||[],stripe:"",border:""},{default:a(()=>[l(C,{label:i.value.labels.urgencyCol,width:"100",align:"center"},{default:a(({row:u})=>[l(b,{type:Ie(u.urgency)},{default:a(()=>[p(o(Pe(u.urgency)),1)]),_:2},1032,["type"])]),_:1},8,["label"]),l(C,{prop:"action_type",label:i.value.labels.actionType,width:"120"},null,8,["label"]),l(C,{prop:"description",label:i.value.labels.specificAction,"min-width":"250"},null,8,["label"]),l(C,{prop:"responsible_party",label:i.value.labels.responsibleParty,width:"100"},null,8,["label"]),l(C,{prop:"deadline_suggestion",label:i.value.labels.deadline,width:"120"},{default:a(({row:u})=>[p(o(u.deadline_suggestion||"-"),1)]),_:1},8,["label"]),l(C,{label:i.value.labels.operation,width:"130",align:"center"},{default:a(({row:u})=>[l(r,{modelValue:u.user_confirmed,"onUpdate:modelValue":h=>u.user_confirmed=h,onChange:h=>je(u,h),style:{"margin-right":"8px"}},{default:a(()=>[p(o(i.value.labels.confirm),1)]),_:1},8,["modelValue","onUpdate:modelValue","onChange"]),l(d,{type:"primary",link:"",size:"small",onClick:h=>Be(u)},{default:a(()=>[p(o(i.value.labels.edit),1)]),_:1},8,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"]),(A=(v=g.value)==null?void 0:v.actions)!=null&&A.length?W("",!0):(y(),P(ve,{key:0,description:i.value.labels.noActions},null,8,["description"]))]}),_:1},8,["label"])]),_:1},8,["modelValue"])]),_:1}),l(_,{modelValue:X.value,"onUpdate:modelValue":e[11]||(e[11]=n=>X.value=n),title:"编辑行动建议",width:"500px","close-on-click-modal":!1},{footer:a(()=>[l(d,{onClick:e[10]||(e[10]=n=>X.value=!1)},{default:a(()=>[...e[22]||(e[22]=[p("取消",-1)])]),_:1}),l(d,{type:"primary",onClick:Fe,loading:ue.value},{default:a(()=>[...e[23]||(e[23]=[p(" 保存 ",-1)])]),_:1},8,["loading"])]),default:a(()=>[l(Ge,{model:T.value,"label-width":"80px"},{default:a(()=>[l(le,{label:"具体行动"},{default:a(()=>[l(ie,{modelValue:T.value.description,"onUpdate:modelValue":e[5]||(e[5]=n=>T.value.description=n),type:"textarea",rows:3,placeholder:"请输入具体行动描述"},null,8,["modelValue"])]),_:1}),l(le,{label:"行动类型"},{default:a(()=>[l(ge,{modelValue:T.value.action_type,"onUpdate:modelValue":e[6]||(e[6]=n=>T.value.action_type=n),style:{width:"100%"}},{default:a(()=>[l(F,{label:"沟通协商",value:"沟通协商"}),l(F,{label:"补充材料",value:"补充材料"}),l(F,{label:"法务确认",value:"法务确认"}),l(F,{label:"内部审批",value:"内部审批"}),l(F,{label:"核实信息",value:"核实信息"})]),_:1},8,["modelValue"])]),_:1}),l(le,{label:"紧急程度"},{default:a(()=>[l(ge,{modelValue:T.value.urgency,"onUpdate:modelValue":e[7]||(e[7]=n=>T.value.urgency=n),style:{width:"100%"}},{default:a(()=>[l(F,{label:"立即处理",value:"immediate"}),l(F,{label:"尽快处理",value:"soon"}),l(F,{label:"一般",value:"normal"})]),_:1},8,["modelValue"])]),_:1}),l(le,{label:"负责方"},{default:a(()=>[l(ie,{modelValue:T.value.responsible_party,"onUpdate:modelValue":e[8]||(e[8]=n=>T.value.responsible_party=n),placeholder:"请输入负责方"},null,8,["modelValue"])]),_:1}),l(le,{label:"建议时限"},{default:a(()=>[l(ie,{modelValue:T.value.deadline_suggestion,"onUpdate:modelValue":e[9]||(e[9]=n=>T.value.deadline_suggestion=n),placeholder:"如：签署前、3个工作日内"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])),[[Ke,se.value]])}}},Gt=Xe(Ft,[["__scopeId","data-v-cdef5142"]]);export{Gt as default};
