import{_ as xl,a4 as Ul,u as El,r as d,q as Fe,aC as pe,v as Sl,o as zl,c as g,a as u,f as l,N as F,e as s,y as We,w as a,E as $l,g as n,k as Fl,i as V,p as Ie,aD as Il,ah as Tl,ai as Ll,aE as Nl,aF as Te,ag as ql,F as Dl,s as Qe,G as Al,H as Bl,J as Ml,K as Rl,b as S,d as U,M as Ol,O as Q,aj as Gl,t as c,R as jl,U as Kl,Q as Le,l as he,z as Hl,aG as Jl,ak as ve,al as Wl,am as Ql,aA as hl,aB as Pl,aH as Xl,L as Yl,a3 as Zl,aI as ea,aJ as la,ad as aa,aa as ta,aK as oa,h as sa,ao as na,ap as ua,aL as ia,a5 as z,x as v,W as Pe}from"./index-BJeSEZfb.js";/* empty css                 *//* empty css                  *//* empty css                 *//* empty css                   *//* empty css                  *//* empty css                     *//* empty css                *//* empty css                  *//* empty css                         */const da={class:"standards-view"},ra={class:"page-header"},ma={class:"header-actions"},pa={class:"filter-row"},va={class:"collections-list"},fa=["onClick"],ca={class:"collection-icon"},_a={class:"collection-info"},ga={class:"collection-name"},ya={class:"collection-desc"},ba={class:"collection-meta"},Va={class:"collection-actions"},ka={class:"detail-header"},wa={class:"detail-title"},Ca={class:"detail-tags"},xa={class:"info-grid"},Ua={class:"info-block"},Ea={class:"info-block-value"},Sa={class:"info-block stats"},za={class:"stat-box"},$a={class:"stat-number"},Fa={class:"stat-box"},Ia={class:"stat-number"},Ta={key:0,class:"usage-instruction-block"},La={class:"info-block-label"},Na={class:"usage-instruction-text"},qa={key:1,class:"usage-instruction-empty"},Da={class:"filter-row"},Aa={class:"table-footer"},Ba={class:"usage-instruction-wrapper"},Ma={class:"usage-instruction-actions"},Ra={class:"form-tip"},Oa={key:0},Ga={key:1},ja={key:0,class:"create-step-content"},Ka={class:"form-section"},Ha={class:"focus-area-selector"},Ja={key:0,class:"custom-focus-input"},Wa={key:1,class:"custom-focus-tags"},Qa={class:"form-section"},ha={class:"industry-selector"},Pa={key:1,class:"create-step-content"},Xa={class:"collection-name-edit"},Ya={class:"expand-edit-form"},Za={class:"expand-actions"},et={class:"step2-tip"},lt={key:2,class:"create-step-content"},at={class:"usage-instruction-list"},tt={class:"usage-item-header"},ot={class:"usage-item-title"},st={class:"create-dialog-footer"},nt={__name:"StandardsView",setup(ut){const Ne=Ul(),qe=El(),fe=d(!1),De=d([]),se=d(""),ne=d(""),ue=d(""),f=d(null),Ae=Fe(()=>{let o=De.value;if(se.value){const e=se.value.toLowerCase();o=o.filter(m=>m.name.toLowerCase().includes(e)||m.description&&m.description.toLowerCase().includes(e))}return ne.value&&(o=o.filter(e=>e.material_type===ne.value||e.material_type==="both")),o});async function M(){fe.value=!0;try{const o={};ue.value&&(o.language=ue.value);const e=await z.getCollections(o);De.value=e.data}catch(o){v.error("加载标准失败: "+o.message)}finally{fe.value=!1}}async function Be(o){f.value=o,await O(),await Ve()}function Xe(){f.value=null,R.value=[],Y.value="",Z.value="",X.value=""}const h=d(!1),ce=d(!1),_e=d(!1),P=d(null),_=pe({name:"",description:"",usage_instruction:"",material_type:"both"});function ge(o){P.value=o,_.name=o.name,_.description=o.description,_.usage_instruction=o.usage_instruction||"",_.material_type=o.material_type,h.value=!0}async function Ye(){if(P.value){_e.value=!0;try{const o=await z.generateCollectionUsageInstruction(P.value.id);_.usage_instruction=o.data.usage_instruction,v.success("生成成功")}catch(o){v.error("生成失败: "+o.message)}finally{_e.value=!1}}}async function Ze(){if(!_.name.trim()){v.warning("集合名称不能为空");return}ce.value=!0;try{await z.updateCollection(P.value.id,{name:_.name,description:_.description,usage_instruction:_.usage_instruction||null,material_type:_.material_type}),v.success("更新成功"),h.value=!1,f.value&&f.value.id===P.value.id&&(f.value.name=_.name,f.value.description=_.description,f.value.usage_instruction=_.usage_instruction,f.value.material_type=_.material_type),M()}catch(o){v.error("更新失败: "+o.message)}finally{ce.value=!1}}async function el(o){if(o.is_preset){v.warning("系统预设集合不可删除");return}try{await Pe.confirm(`确定要删除标准「${o.name}」吗？该标准内的所有审核条目将一并删除。`,"确认删除",{type:"warning"}),await z.deleteCollection(o.id),v.success("删除成功"),M()}catch(e){e!=="cancel"&&v.error("删除失败: "+e.message)}}const ye=d(!1),R=d([]),be=d([]),X=d(""),Y=d(""),Z=d("");async function O(){if(f.value){ye.value=!0;try{const o={};Y.value&&(o.category=Y.value),Z.value&&(o.risk_level=Z.value),X.value&&(o.keyword=X.value);const e=await z.getCollectionStandards(f.value.id,o);R.value=e.data}catch(o){v.error("加载风险点失败: "+o.message)}finally{ye.value=!1}}}async function Ve(){if(f.value)try{const o=await z.getCollectionCategories(f.value.id);be.value=o.data}catch(o){console.error("加载分类失败:",o)}}let Me=null;function ll(){clearTimeout(Me),Me=setTimeout(()=>{O()},300)}const G=d(!1),j=d(!1),K=d(null),k=pe({category:"",item:"",description:"",risk_level:"medium",applicable_to:["contract","marketing"]});function al(o){K.value=o,Object.assign(k,{category:o.category,item:o.item,description:o.description,risk_level:o.risk_level,applicable_to:o.applicable_to||["contract","marketing"]}),G.value=!0}async function tl(){if(!k.category||!k.item||!k.description){v.warning("请填写必填字段");return}j.value=!0;try{K.value?(await z.updateLibraryStandard(K.value.id,k),v.success("更新成功")):(await z.addStandardToCollection(f.value.id,k),v.success("添加成功")),G.value=!1,Re(),O(),Ve(),f.value.standard_count=R.value.length+(K.value?0:1)}catch(o){v.error("保存失败: "+o.message)}finally{j.value=!1}}async function ol(o){try{await Pe.confirm(`确定要删除风险点「${o.item}」吗？`,"确认删除",{type:"warning"}),await z.deleteLibraryStandard(o.id),v.success("删除成功"),O(),Ve(),f.value.standard_count--}catch(e){e!=="cancel"&&v.error("删除失败: "+e.message)}}function Re(){K.value=null,Object.assign(k,{category:"",item:"",description:"",risk_level:"medium",applicable_to:["contract","marketing"]})}const ee=d(!1),H=d(1),le=d(null),J=d([]),ke=d(!1),w=pe({name:"",description:"",material_type:"both",language:"zh-CN"});function sl(o){le.value=o.raw}async function nl(){if(le.value){if(!w.name.trim()){v.warning("请先输入集合名称");return}ke.value=!0;try{const o=await z.previewStandards(le.value);J.value=o.data.standards,H.value=2,v.success(`解析成功，共 ${o.data.total_count} 条标准`)}catch(o){v.error("解析失败: "+o.message)}finally{ke.value=!1}}}async function ul(){if(J.value.length){j.value=!0;try{const o=await z.saveToLibrary({collection_name:w.name,collection_description:w.description,material_type:w.material_type,language:w.language,standards:J.value});v.success(o.data.message),ee.value=!1,Oe(),M()}catch(o){v.error("保存失败: "+o.message)}finally{j.value=!1}}}function Oe(){H.value=1,le.value=null,J.value=[],Object.assign(w,{name:"",description:"",material_type:"both",language:"zh-CN"})}const D=d(!1),E=d(1),we=d(!1),Ce=d(!1),I=d([]),N=d(""),ie=d(""),i=pe({document_type:"contract",business_scenario:"",focus_areas:[],our_role:"",industry:"",special_risks:"",reference_material:"",custom_industry:"",language:"zh-CN"}),ae=d(!1),W=d(""),q=d([]);function Ge(){const o=W.value.trim();o&&!q.value.includes(o)&&(q.value.push(o),W.value="",ae.value=!1)}function il(o){q.value.splice(o,1)}const dl=["合同主体资格","权利义务条款","费用与支付","违约责任","知识产权","保密条款","争议解决","合规性要求"],rl=["信息技术/互联网","金融/保险","制造业","房地产/建筑","医疗/生物","零售/消费"],ml=Fe(()=>["制作审核标准","预览编辑标准","确认入库"][E.value-1]),je=Fe(()=>i.business_scenario.trim()&&(i.focus_areas.length>0||q.value.length>0));async function pl(){var o,e;if(!je.value){v.warning("请填写业务场景和至少一个关注点");return}we.value=!0;try{const m=[...i.focus_areas,...q.value],r=i.custom_industry.trim()||i.industry,A=await z.createStandardsFromBusiness({document_type:i.document_type,business_scenario:i.business_scenario,focus_areas:m,our_role:i.our_role||null,industry:r||null,special_risks:i.special_risks||null,reference_material:i.reference_material||null,language:i.language});I.value=A.data.standards,N.value=A.data.collection_name||"",ie.value=A.data.generation_summary||`成功生成 ${A.data.standards.length} 条标准`,E.value=2,v.success("标准生成成功")}catch(m){v.error("生成标准失败: "+(((e=(o=m.response)==null?void 0:o.data)==null?void 0:e.detail)||m.message))}finally{we.value=!1}}function vl(o){I.value.splice(o,1)}async function fl(){if(!I.value.length){v.warning("没有可保存的标准");return}if(!N.value.trim()){v.warning("请输入标准名称");return}Ce.value=!0;try{const o=await z.saveToLibrary({collection_name:N.value,collection_description:i.business_scenario,material_type:i.document_type==="both"?"both":i.document_type,language:i.language,standards:I.value});v.success(o.data.message||"标准保存成功"),D.value=!1,Ke(),M()}catch(o){v.error("保存失败: "+o.message)}finally{Ce.value=!1}}function Ke(){E.value=1,Object.assign(i,{document_type:"contract",business_scenario:"",focus_areas:[],our_role:"",industry:"",special_risks:"",reference_material:"",custom_industry:"",language:"zh-CN"}),q.value=[],W.value="",ae.value=!1,I.value=[],N.value="",ie.value=""}function xe(o){return{high:"danger",medium:"warning",low:"success"}[o]||"info"}function de(o){return{high:"高",medium:"中",low:"低"}[o]||o}function cl(o){return o?o.map(e=>e==="contract"?"合同":"营销").join("、"):""}function He(o){return{contract:"合同",marketing:"营销材料",both:"合同/营销"}[o]||o}function _l(o){return{"zh-CN":"中文",en:"English"}[o]||o||"中文"}function gl(o){o==="upload"?ee.value=!0:o==="ai"&&(D.value=!0)}return Sl(()=>Ne.query.action,o=>{o==="ai-create"&&(D.value=!0,qe.replace({query:{}}))}),zl(async()=>{await M(),Ne.query.action==="ai-create"&&(D.value=!0,qe.replace({query:{}}))}),(o,e)=>{const m=Fl,r=$l,A=Ll,yl=Tl,bl=ql,y=Dl,b=Bl,T=Al,re=Ml,Vl=Ol,L=jl,C=Ql,Ue=Wl,p=Pl,te=Yl,Ee=Xl,oe=hl,me=Zl,B=la,Se=ea,kl=aa,wl=ta,ze=sa,$e=ua,Cl=na,Je=Rl;return u(),g("div",da,[f.value?(u(),g(F,{key:1},[s("div",ka,[l(r,{text:"",onClick:Xe},{default:a(()=>[l(m,null,{default:a(()=>[l(V(Jl))]),_:1}),e[58]||(e[58]=n(" 返回列表 ",-1))]),_:1}),s("div",wa,[s("h2",null,c(f.value.name),1),s("div",Ca,[f.value.is_preset?(u(),S(L,{key:0,size:"small",type:"info"},{default:a(()=>[...e[59]||(e[59]=[n("系统预设",-1)])]),_:1})):U("",!0),f.value.language==="en"?(u(),S(L,{key:1,size:"small",type:"success"},{default:a(()=>[...e[60]||(e[60]=[n("EN",-1)])]),_:1})):U("",!0),l(L,{size:"small"},{default:a(()=>[n(c(He(f.value.material_type)),1)]),_:1})])]),l(r,{type:"primary",text:"",onClick:e[3]||(e[3]=t=>ge(f.value))},{default:a(()=>[l(m,null,{default:a(()=>[l(V(he))]),_:1}),e[61]||(e[61]=n(" 编辑信息 ",-1))]),_:1})]),l(re,{class:"collection-info-card"},{default:a(()=>[s("div",xa,[s("div",Ua,[e[62]||(e[62]=s("div",{class:"info-block-label"},"适用场景",-1)),s("div",Ea,c(f.value.description||"暂无描述"),1)]),s("div",Sa,[s("div",za,[s("div",$a,c(R.value.length),1),e[63]||(e[63]=s("div",{class:"stat-text"},"审核条目",-1))]),s("div",Fa,[s("div",Ia,c(be.value.length),1),e[64]||(e[64]=s("div",{class:"stat-text"},"分类",-1))])])]),f.value.usage_instruction?(u(),g("div",Ta,[s("div",La,[l(m,null,{default:a(()=>[l(V(ve))]),_:1}),e[65]||(e[65]=n(" 适用说明（用于智能推荐） ",-1))]),s("div",Na,c(f.value.usage_instruction),1)])):(u(),g("div",qa,[l(m,null,{default:a(()=>[l(V(ve))]),_:1}),e[67]||(e[67]=s("span",null,"尚未设置适用说明，",-1)),l(r,{type:"primary",text:"",size:"small",onClick:e[4]||(e[4]=t=>ge(f.value))},{default:a(()=>[...e[66]||(e[66]=[n(" 点击编辑 ",-1)])]),_:1}),e[68]||(e[68]=s("span",null,"或使用 AI 自动生成",-1))]))]),_:1}),l(re,{class:"filter-card"},{default:a(()=>[s("div",Da,[l(y,{modelValue:X.value,"onUpdate:modelValue":e[5]||(e[5]=t=>X.value=t),placeholder:"搜索审核条目...",clearable:"",style:{width:"300px"},onInput:ll},{prefix:a(()=>[l(m,null,{default:a(()=>[l(V(Qe))]),_:1})]),_:1},8,["modelValue"]),l(T,{modelValue:Y.value,"onUpdate:modelValue":e[6]||(e[6]=t=>Y.value=t),placeholder:"选择分类",clearable:"",style:{width:"200px"},onChange:O},{default:a(()=>[(u(!0),g(F,null,Q(be.value,t=>(u(),S(b,{key:t,label:t,value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),l(T,{modelValue:Z.value,"onUpdate:modelValue":e[7]||(e[7]=t=>Z.value=t),placeholder:"风险等级",clearable:"",style:{width:"150px"},onChange:O},{default:a(()=>[l(b,{label:"高",value:"high"}),l(b,{label:"中",value:"medium"}),l(b,{label:"低",value:"low"})]),_:1},8,["modelValue"]),l(r,{type:"primary",onClick:e[8]||(e[8]=t=>G.value=!0)},{default:a(()=>[l(m,null,{default:a(()=>[l(V(Ie))]),_:1}),e[69]||(e[69]=n(" 添加审核条目 ",-1))]),_:1})])]),_:1}),l(re,{class:"table-card"},{default:a(()=>[We((u(),S(Ue,{data:R.value,stripe:"",style:{width:"100%"}},{default:a(()=>[l(C,{prop:"category",label:"分类",width:"120"}),l(C,{prop:"item",label:"审核要点","min-width":"180"}),l(C,{prop:"description",label:"说明","min-width":"250","show-overflow-tooltip":""}),l(C,{label:"风险等级",width:"100",align:"center"},{default:a(({row:t})=>[l(L,{type:xe(t.risk_level),size:"small"},{default:a(()=>[n(c(de(t.risk_level)),1)]),_:2},1032,["type"])]),_:1}),l(C,{label:"适用类型",width:"120"},{default:a(({row:t})=>[s("span",null,c(cl(t.applicable_to)),1)]),_:1}),l(C,{label:"操作",width:"150",fixed:"right"},{default:a(({row:t})=>[l(r,{type:"primary",text:"",size:"small",onClick:$=>al(t)},{default:a(()=>[...e[70]||(e[70]=[n(" 编辑 ",-1)])]),_:1},8,["onClick"]),l(r,{type:"danger",text:"",size:"small",onClick:$=>ol(t)},{default:a(()=>[...e[71]||(e[71]=[n(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[Je,ye.value]]),s("div",Aa,[s("span",null,"共 "+c(R.value.length)+" 条审核条目",1)])]),_:1})],64)):(u(),g(F,{key:0},[s("div",ra,[e[50]||(e[50]=s("div",{class:"header-left"},[s("h1",null,"审核标准管理"),s("p",{class:"subtitle"},"管理审核标准，每套标准包含若干审核条目")],-1)),s("div",ma,[l(bl,{trigger:"click",onCommand:gl},{dropdown:a(()=>[l(yl,null,{default:a(()=>[l(A,{command:"upload"},{default:a(()=>[l(m,null,{default:a(()=>[l(V(Nl))]),_:1}),e[48]||(e[48]=n(" 上传新标准 ",-1))]),_:1}),l(A,{command:"ai"},{default:a(()=>[l(m,null,{default:a(()=>[l(V(Te))]),_:1}),e[49]||(e[49]=n(" AI辅助制作 ",-1))]),_:1})]),_:1})]),default:a(()=>[l(r,{type:"primary"},{default:a(()=>[l(m,null,{default:a(()=>[l(V(Ie))]),_:1}),e[47]||(e[47]=n(" 新建标准 ",-1)),l(m,{class:"el-icon--right"},{default:a(()=>[l(V(Il))]),_:1})]),_:1})]),_:1})])]),l(re,{class:"filter-card"},{default:a(()=>[s("div",pa,[l(y,{modelValue:se.value,"onUpdate:modelValue":e[0]||(e[0]=t=>se.value=t),placeholder:"搜索标准...",clearable:"",style:{width:"300px"}},{prefix:a(()=>[l(m,null,{default:a(()=>[l(V(Qe))]),_:1})]),_:1},8,["modelValue"]),l(T,{modelValue:ne.value,"onUpdate:modelValue":e[1]||(e[1]=t=>ne.value=t),placeholder:"材料类型",clearable:"",style:{width:"150px"}},{default:a(()=>[l(b,{label:"合同",value:"contract"}),l(b,{label:"营销材料",value:"marketing"})]),_:1},8,["modelValue"]),l(T,{modelValue:ue.value,"onUpdate:modelValue":e[2]||(e[2]=t=>ue.value=t),placeholder:"标准语言",clearable:"",style:{width:"150px"},onChange:M},{default:a(()=>[l(b,{label:"中文",value:"zh-CN"}),l(b,{label:"English",value:"en"})]),_:1},8,["modelValue"])])]),_:1}),We((u(),g("div",va,[Ae.value.length===0?(u(),S(Vl,{key:0,description:"暂无标准"})):U("",!0),(u(!0),g(F,null,Q(Ae.value,t=>(u(),g("div",{key:t.id,class:"collection-card"},[s("div",{class:"collection-card-main",onClick:$=>Be(t)},[s("div",ca,[l(m,{size:24},{default:a(()=>[l(V(Gl))]),_:1})]),s("div",_a,[s("div",ga,[n(c(t.name)+" ",1),t.is_preset?(u(),S(L,{key:0,size:"small",type:"info"},{default:a(()=>[...e[51]||(e[51]=[n("系统预设",-1)])]),_:1})):U("",!0),t.language==="en"?(u(),S(L,{key:1,size:"small",type:"success"},{default:a(()=>[...e[52]||(e[52]=[n("EN",-1)])]),_:1})):U("",!0)]),s("div",ya,c(t.description||"暂无描述"),1),s("div",ba,[s("span",null,c(t.standard_count)+" 条审核条目",1),e[53]||(e[53]=s("span",{class:"meta-sep"},"|",-1)),s("span",null,c(He(t.material_type)),1),e[54]||(e[54]=s("span",{class:"meta-sep"},"|",-1)),s("span",null,c(_l(t.language)),1)])])],8,fa),s("div",Va,[l(r,{text:"",type:"primary",onClick:Le($=>Be(t),["stop"])},{default:a(()=>[l(m,null,{default:a(()=>[l(V(Kl))]),_:1}),e[55]||(e[55]=n(" 查看 ",-1))]),_:1},8,["onClick"]),l(r,{text:"",type:"primary",onClick:Le($=>ge(t),["stop"])},{default:a(()=>[l(m,null,{default:a(()=>[l(V(he))]),_:1}),e[56]||(e[56]=n(" 编辑 ",-1))]),_:1},8,["onClick"]),l(r,{text:"",type:"danger",onClick:Le($=>el(t),["stop"]),disabled:t.is_preset},{default:a(()=>[l(m,null,{default:a(()=>[l(V(Hl))]),_:1}),e[57]||(e[57]=n(" 删除 ",-1))]),_:1},8,["onClick","disabled"])])]))),128))])),[[Je,fe.value]])],64)),l(me,{modelValue:G.value,"onUpdate:modelValue":e[15]||(e[15]=t=>G.value=t),title:K.value?"编辑审核条目":"添加审核条目",width:"600px",onClose:Re},{footer:a(()=>[l(r,{onClick:e[14]||(e[14]=t=>G.value=!1)},{default:a(()=>[...e[74]||(e[74]=[n("取消",-1)])]),_:1}),l(r,{type:"primary",onClick:tl,loading:j.value},{default:a(()=>[...e[75]||(e[75]=[n(" 保存 ",-1)])]),_:1},8,["loading"])]),default:a(()=>[l(oe,{model:k,"label-width":"100px"},{default:a(()=>[l(p,{label:"分类",required:""},{default:a(()=>[l(y,{modelValue:k.category,"onUpdate:modelValue":e[9]||(e[9]=t=>k.category=t),placeholder:"如：主体资格、权利义务"},null,8,["modelValue"])]),_:1}),l(p,{label:"审核要点",required:""},{default:a(()=>[l(y,{modelValue:k.item,"onUpdate:modelValue":e[10]||(e[10]=t=>k.item=t),placeholder:"简要描述审核要点"},null,8,["modelValue"])]),_:1}),l(p,{label:"详细说明",required:""},{default:a(()=>[l(y,{modelValue:k.description,"onUpdate:modelValue":e[11]||(e[11]=t=>k.description=t),type:"textarea",rows:3,placeholder:"详细的审核说明"},null,8,["modelValue"])]),_:1}),l(p,{label:"风险等级"},{default:a(()=>[l(T,{modelValue:k.risk_level,"onUpdate:modelValue":e[12]||(e[12]=t=>k.risk_level=t),style:{width:"100%"}},{default:a(()=>[l(b,{label:"高",value:"high"}),l(b,{label:"中",value:"medium"}),l(b,{label:"低",value:"low"})]),_:1},8,["modelValue"])]),_:1}),l(p,{label:"适用类型"},{default:a(()=>[l(Ee,{modelValue:k.applicable_to,"onUpdate:modelValue":e[13]||(e[13]=t=>k.applicable_to=t)},{default:a(()=>[l(te,{label:"contract"},{default:a(()=>[...e[72]||(e[72]=[n("合同",-1)])]),_:1}),l(te,{label:"marketing"},{default:a(()=>[...e[73]||(e[73]=[n("营销材料",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),l(me,{modelValue:h.value,"onUpdate:modelValue":e[21]||(e[21]=t=>h.value=t),title:"编辑标准信息",width:"600px"},{footer:a(()=>[l(r,{onClick:e[20]||(e[20]=t=>h.value=!1)},{default:a(()=>[...e[78]||(e[78]=[n("取消",-1)])]),_:1}),l(r,{type:"primary",onClick:Ze,loading:ce.value},{default:a(()=>[...e[79]||(e[79]=[n(" 保存 ",-1)])]),_:1},8,["loading"])]),default:a(()=>[l(oe,{model:_,"label-width":"100px"},{default:a(()=>[l(p,{label:"标准名称",required:""},{default:a(()=>[l(y,{modelValue:_.name,"onUpdate:modelValue":e[16]||(e[16]=t=>_.name=t),placeholder:"如：电商平台合作协议审核标准"},null,8,["modelValue"])]),_:1}),l(p,{label:"适用场景"},{default:a(()=>[l(y,{modelValue:_.description,"onUpdate:modelValue":e[17]||(e[17]=t=>_.description=t),type:"textarea",rows:2,placeholder:"描述该标准的适用场景"},null,8,["modelValue"])]),_:1}),l(p,{label:"适用说明"},{default:a(()=>[s("div",Ba,[l(y,{modelValue:_.usage_instruction,"onUpdate:modelValue":e[18]||(e[18]=t=>_.usage_instruction=t),type:"textarea",rows:4,placeholder:"用于智能推荐的详细说明，例如：适用于各类商务合同的法务审阅，包括采购合同、销售合同、服务合同等。重点关注合同主体资格、权利义务平衡、付款条款、违约责任等核心条款。",class:"usage-instruction-textarea"},null,8,["modelValue"]),s("div",Ma,[l(r,{type:"primary",size:"small",onClick:Ye,loading:_e.value},{default:a(()=>[l(m,null,{default:a(()=>[l(V(Te))]),_:1}),e[76]||(e[76]=n(" AI 生成 ",-1))]),_:1},8,["loading"])])]),s("div",Ra,[l(m,null,{default:a(()=>[l(V(ve))]),_:1}),e[77]||(e[77]=n(" 适用说明用于智能推荐功能，帮助 AI 判断该标准是否适合审阅文档 ",-1))])]),_:1}),l(p,{label:"材料类型"},{default:a(()=>[l(T,{modelValue:_.material_type,"onUpdate:modelValue":e[19]||(e[19]=t=>_.material_type=t),style:{width:"100%"}},{default:a(()=>[l(b,{label:"合同",value:"contract"}),l(b,{label:"营销材料",value:"marketing"}),l(b,{label:"两者都适用",value:"both"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(me,{modelValue:ee.value,"onUpdate:modelValue":e[28]||(e[28]=t=>ee.value=t),title:"上传审核标准",width:"700px",onClose:Oe},{footer:a(()=>[l(r,{onClick:e[26]||(e[26]=t=>ee.value=!1)},{default:a(()=>[...e[84]||(e[84]=[n("取消",-1)])]),_:1}),H.value===1?(u(),S(r,{key:0,type:"primary",onClick:nl,loading:ke.value,disabled:!le.value||!w.name},{default:a(()=>[...e[85]||(e[85]=[n(" 预览 ",-1)])]),_:1},8,["loading","disabled"])):(u(),S(r,{key:1,onClick:e[27]||(e[27]=t=>H.value=1)},{default:a(()=>[...e[86]||(e[86]=[n(" 上一步 ",-1)])]),_:1})),H.value===2?(u(),S(r,{key:2,type:"primary",onClick:ul,loading:j.value},{default:a(()=>[...e[87]||(e[87]=[n(" 确认入库 ",-1)])]),_:1},8,["loading"])):U("",!0)]),default:a(()=>[H.value===1?(u(),g("div",Oa,[l(oe,{model:w,"label-width":"100px"},{default:a(()=>[l(p,{label:"标准名称",required:""},{default:a(()=>[l(y,{modelValue:w.name,"onUpdate:modelValue":e[22]||(e[22]=t=>w.name=t),placeholder:"如：电商平台合作协议审核标准"},null,8,["modelValue"])]),_:1}),l(p,{label:"适用场景"},{default:a(()=>[l(y,{modelValue:w.description,"onUpdate:modelValue":e[23]||(e[23]=t=>w.description=t),type:"textarea",rows:2,placeholder:"描述该标准的适用场景"},null,8,["modelValue"])]),_:1}),l(p,{label:"材料类型"},{default:a(()=>[l(T,{modelValue:w.material_type,"onUpdate:modelValue":e[24]||(e[24]=t=>w.material_type=t),style:{width:"100%"}},{default:a(()=>[l(b,{label:"合同",value:"contract"}),l(b,{label:"营销材料",value:"marketing"}),l(b,{label:"两者都适用",value:"both"})]),_:1},8,["modelValue"])]),_:1}),l(p,{label:"标准语言"},{default:a(()=>[l(Se,{modelValue:w.language,"onUpdate:modelValue":e[25]||(e[25]=t=>w.language=t)},{default:a(()=>[l(B,{value:"zh-CN"},{default:a(()=>[...e[80]||(e[80]=[n("中文",-1)])]),_:1}),l(B,{value:"en"},{default:a(()=>[...e[81]||(e[81]=[n("English",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"]),l(kl),l(wl,{ref:"uploadRef",drag:"","auto-upload":!1,"on-change":sl,accept:".xlsx,.xls,.csv,.docx,.md,.txt"},{tip:a(()=>[...e[82]||(e[82]=[s("div",{class:"el-upload__tip"}," 支持 Excel (.xlsx/.xls)、CSV、Word (.docx)、Markdown (.md)、文本 (.txt) 格式 ",-1)])]),default:a(()=>[l(m,{class:"el-icon--upload"},{default:a(()=>[l(V(oa))]),_:1}),e[83]||(e[83]=s("div",{class:"el-upload__text"},[n(" 拖拽文件到此处，或 "),s("em",null,"点击上传")],-1))]),_:1},512)])):(u(),g("div",Ga,[l(ze,{type:"success",closable:!1,style:{"margin-bottom":"16px"}},{default:a(()=>[n(" 解析成功，将创建标准「"+c(w.name)+"」，共 "+c(J.value.length)+" 条审核条目 ",1)]),_:1}),l(Ue,{data:J.value,"max-height":"400",size:"small"},{default:a(()=>[l(C,{prop:"category",label:"分类",width:"100"}),l(C,{prop:"item",label:"审核要点",width:"150"}),l(C,{prop:"description",label:"说明","show-overflow-tooltip":""}),l(C,{label:"风险",width:"60"},{default:a(({row:t})=>[n(c(de(t.risk_level)),1)]),_:1})]),_:1},8,["data"])]))]),_:1},8,["modelValue"]),l(me,{modelValue:D.value,"onUpdate:modelValue":e[46]||(e[46]=t=>D.value=t),title:ml.value,width:"900px","close-on-click-modal":!1,onClose:Ke},{footer:a(()=>[s("div",st,[l(r,{onClick:e[42]||(e[42]=t=>D.value=!1)},{default:a(()=>[...e[102]||(e[102]=[n("取消",-1)])]),_:1}),E.value===1?(u(),S(r,{key:0,type:"primary",onClick:pl,loading:we.value,disabled:!je.value},{default:a(()=>[l(m,null,{default:a(()=>[l(V(Te))]),_:1}),e[103]||(e[103]=n(" 生成标准 ",-1))]),_:1},8,["loading","disabled"])):U("",!0),E.value===2?(u(),g(F,{key:1},[l(r,{onClick:e[43]||(e[43]=t=>E.value=1)},{default:a(()=>[...e[104]||(e[104]=[n("上一步",-1)])]),_:1}),l(r,{type:"primary",onClick:e[44]||(e[44]=t=>E.value=3),disabled:!I.value.length||!N.value},{default:a(()=>[...e[105]||(e[105]=[n(" 下一步 ",-1)])]),_:1},8,["disabled"])],64)):U("",!0),E.value===3?(u(),g(F,{key:2},[l(r,{onClick:e[45]||(e[45]=t=>E.value=2)},{default:a(()=>[...e[106]||(e[106]=[n("上一步",-1)])]),_:1}),l(r,{type:"primary",onClick:fl,loading:Ce.value},{default:a(()=>[...e[107]||(e[107]=[n(" 确认入库 ",-1)])]),_:1},8,["loading"])],64)):U("",!0)])]),default:a(()=>[l(Cl,{active:E.value-1,"align-center":"",style:{"margin-bottom":"24px"}},{default:a(()=>[l($e,{title:"填写问卷",description:"提供业务信息"}),l($e,{title:"预览编辑",description:"确认生成的标准"}),l($e,{title:"确认入库",description:"保存到标准库"})]),_:1},8,["active"]),E.value===1?(u(),g("div",ja,[l(oe,{model:i,"label-width":"120px","label-position":"top"},{default:a(()=>[s("div",Ka,[e[96]||(e[96]=s("div",{class:"form-section-title"},[s("span",{class:"required-badge"},"必答"),n(" 基本信息 ")],-1)),l(p,{label:"文档类型",required:""},{default:a(()=>[l(Se,{modelValue:i.document_type,"onUpdate:modelValue":e[29]||(e[29]=t=>i.document_type=t)},{default:a(()=>[l(B,{value:"contract"},{default:a(()=>[...e[88]||(e[88]=[n("合同",-1)])]),_:1}),l(B,{value:"marketing"},{default:a(()=>[...e[89]||(e[89]=[n("营销材料",-1)])]),_:1}),l(B,{value:"both"},{default:a(()=>[...e[90]||(e[90]=[n("两者都有",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(p,{label:"标准语言",required:""},{default:a(()=>[l(Se,{modelValue:i.language,"onUpdate:modelValue":e[30]||(e[30]=t=>i.language=t)},{default:a(()=>[l(B,{value:"zh-CN"},{default:a(()=>[...e[91]||(e[91]=[n("中文",-1)])]),_:1}),l(B,{value:"en"},{default:a(()=>[...e[92]||(e[92]=[n("English",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(p,{label:"适用场景",required:""},{default:a(()=>[l(y,{modelValue:i.business_scenario,"onUpdate:modelValue":e[31]||(e[31]=t=>i.business_scenario=t),type:"textarea",rows:3,placeholder:"请描述该审阅标准的适用场景，例如：审核SaaS服务协议，涉及订阅费用、服务级别承诺、数据安全等条款...",maxlength:"500","show-word-limit":""},null,8,["modelValue"])]),_:1}),l(p,{label:"核心关注点",required:""},{default:a(()=>[s("div",Ha,[l(Ee,{modelValue:i.focus_areas,"onUpdate:modelValue":e[32]||(e[32]=t=>i.focus_areas=t)},{default:a(()=>[(u(),g(F,null,Q(dl,t=>l(te,{key:t,value:t,label:t},null,8,["value","label"])),64))]),_:1},8,["modelValue"]),l(r,{type:"primary",text:"",size:"small",class:"add-focus-btn",onClick:e[33]||(e[33]=t=>ae.value=!0)},{default:a(()=>[l(m,null,{default:a(()=>[l(V(Ie))]),_:1}),e[93]||(e[93]=n(" 添加其他 ",-1))]),_:1})]),ae.value?(u(),g("div",Ja,[l(y,{modelValue:W.value,"onUpdate:modelValue":e[34]||(e[34]=t=>W.value=t),placeholder:"输入关注点名称",size:"small",style:{width:"200px"},onKeyup:ia(Ge,["enter"])},null,8,["modelValue"]),l(r,{type:"primary",size:"small",onClick:Ge},{default:a(()=>[...e[94]||(e[94]=[n("添加",-1)])]),_:1}),l(r,{size:"small",onClick:e[35]||(e[35]=t=>{ae.value=!1,W.value=""})},{default:a(()=>[...e[95]||(e[95]=[n("取消",-1)])]),_:1})])):U("",!0),q.value.length>0?(u(),g("div",Wa,[(u(!0),g(F,null,Q(q.value,(t,$)=>(u(),S(L,{key:$,closable:"",size:"small",onClose:x=>il($)},{default:a(()=>[n(c(t),1)]),_:2},1032,["onClose"]))),128))])):U("",!0)]),_:1})]),s("div",Qa,[e[97]||(e[97]=s("div",{class:"form-section-title"},[s("span",{class:"optional-badge"},"选答"),n(" 补充信息（帮助生成更精准的标准） ")],-1)),l(p,{label:"我方角色"},{default:a(()=>[l(y,{modelValue:i.our_role,"onUpdate:modelValue":e[36]||(e[36]=t=>i.our_role=t),placeholder:"例如：甲方/采购方/服务提供方/委托方"},null,8,["modelValue"])]),_:1}),l(p,{label:"所属行业"},{default:a(()=>[s("div",ha,[l(T,{modelValue:i.industry,"onUpdate:modelValue":e[37]||(e[37]=t=>i.industry=t),placeholder:"选择行业",clearable:"",style:{width:"200px"}},{default:a(()=>[(u(),g(F,null,Q(rl,t=>l(b,{key:t,label:t,value:t},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),l(y,{modelValue:i.custom_industry,"onUpdate:modelValue":e[38]||(e[38]=t=>i.custom_industry=t),placeholder:"或输入其他行业",style:{width:"200px","margin-left":"12px"}},null,8,["modelValue"])])]),_:1}),l(p,{label:"特殊风险关注"},{default:a(()=>[l(y,{modelValue:i.special_risks,"onUpdate:modelValue":e[39]||(e[39]=t=>i.special_risks=t),type:"textarea",rows:2,placeholder:"如有特殊的审核要求，请在此说明"},null,8,["modelValue"])]),_:1}),l(p,{label:"参考材料"},{default:a(()=>[l(y,{modelValue:i.reference_material,"onUpdate:modelValue":e[40]||(e[40]=t=>i.reference_material=t),type:"textarea",rows:4,placeholder:"粘贴相关的法规条文、行业规范、已有合同模板等作为参考"},null,8,["modelValue"])]),_:1})])]),_:1},8,["model"])])):U("",!0),E.value===2?(u(),g("div",Pa,[ie.value?(u(),S(ze,{key:0,type:"success",closable:!1,style:{"margin-bottom":"16px"}},{default:a(()=>[n(c(ie.value),1)]),_:1})):U("",!0),s("div",Xa,[l(p,{label:"标准名称","label-width":"100px"},{default:a(()=>[l(y,{modelValue:N.value,"onUpdate:modelValue":e[41]||(e[41]=t=>N.value=t),placeholder:"AI生成的名称，可修改"},null,8,["modelValue"])]),_:1})]),l(Ue,{data:I.value,border:"",size:"small","max-height":"350"},{default:a(()=>[l(C,{type:"expand"},{default:a(({row:t,$index:$})=>[s("div",Ya,[l(oe,{"label-width":"80px",size:"small"},{default:a(()=>[l(p,{label:"分类"},{default:a(()=>[l(y,{modelValue:t.category,"onUpdate:modelValue":x=>t.category=x},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(p,{label:"审核要点"},{default:a(()=>[l(y,{modelValue:t.item,"onUpdate:modelValue":x=>t.item=x},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(p,{label:"详细说明"},{default:a(()=>[l(y,{modelValue:t.description,"onUpdate:modelValue":x=>t.description=x,type:"textarea",rows:2},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(p,{label:"风险等级"},{default:a(()=>[l(T,{modelValue:t.risk_level,"onUpdate:modelValue":x=>t.risk_level=x},{default:a(()=>[l(b,{label:"高",value:"high"}),l(b,{label:"中",value:"medium"}),l(b,{label:"低",value:"low"})]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(p,{label:"适用类型"},{default:a(()=>[l(Ee,{modelValue:t.applicable_to,"onUpdate:modelValue":x=>t.applicable_to=x},{default:a(()=>[l(te,{label:"contract",value:"contract"},{default:a(()=>[...e[98]||(e[98]=[n("合同",-1)])]),_:1}),l(te,{label:"marketing",value:"marketing"},{default:a(()=>[...e[99]||(e[99]=[n("营销材料",-1)])]),_:1})]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(p,{label:"适用说明"},{default:a(()=>[l(y,{modelValue:t.usage_instruction,"onUpdate:modelValue":x=>t.usage_instruction=x,type:"textarea",rows:2},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),s("div",Za,[l(r,{type:"danger",size:"small",onClick:x=>vl($)},{default:a(()=>[...e[100]||(e[100]=[n(" 删除此标准 ",-1)])]),_:1},8,["onClick"])])])]),_:1}),l(C,{prop:"category",label:"分类",width:"100"}),l(C,{prop:"item",label:"审核要点",width:"150"}),l(C,{prop:"description",label:"说明","show-overflow-tooltip":""}),l(C,{label:"风险",width:"60",align:"center"},{default:a(({row:t})=>[l(L,{type:xe(t.risk_level),size:"small"},{default:a(()=>[n(c(de(t.risk_level)),1)]),_:2},1032,["type"])]),_:1})]),_:1},8,["data"]),s("div",et,[l(m,null,{default:a(()=>[l(V(ve))]),_:1}),e[101]||(e[101]=n(" 点击行左侧展开按钮可编辑标准详情 ",-1))])])):U("",!0),E.value===3?(u(),g("div",lt,[l(ze,{type:"info",closable:!1,style:{"margin-bottom":"16px"}},{default:a(()=>[n(" 将创建标准「"+c(N.value)+"」，包含 "+c(I.value.length)+" 条审核条目 ",1)]),_:1}),s("div",at,[(u(!0),g(F,null,Q(I.value,(t,$)=>(u(),g("div",{key:$,class:"usage-item"},[s("div",tt,[l(L,{type:xe(t.risk_level),size:"small"},{default:a(()=>[n(c(de(t.risk_level)),1)]),_:2},1032,["type"]),s("span",ot,c(t.category)+" - "+c(t.item),1)]),l(y,{modelValue:t.usage_instruction,"onUpdate:modelValue":x=>t.usage_instruction=x,type:"textarea",rows:2,placeholder:"说明该标准适用的条件，例如：适用于涉及支付条款的合同"},null,8,["modelValue","onUpdate:modelValue"])]))),128))])])):U("",!0)]),_:1},8,["modelValue","title"])])}}},yt=xl(nt,[["__scopeId","data-v-27bdd614"]]);export{yt as default};
